Öã
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\AuthController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly 
IAuthRepositorio )
authRepositorio* 9
;9 :
public 
AuthController 
( 

DbEntities (

dbEntities) 3
,3 4
IAuthRepositorio5 E
authRepositorioF U
)U V
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
authRepositorio  
=! "
authRepositorio# 2
;2 3
} 	
public 
static 
string 
Convertirsha256 ,
(, -
string- 3
texto4 9
)9 :
{ 	
StringBuilder 
Sb 
= 
new "
StringBuilder# 0
(0 1
)1 2
;2 3
using 
( 
SHA256 
hash 
=  
SHA256Managed! .
.. /
Create/ 5
(5 6
)6 7
)7 8
{ 
Encoding   
enc   
=   
Encoding   '
.  ' (
UTF8  ( ,
;  , -
byte!! 
[!! 
]!! 
result!! 
=!! 
hash!!  $
.!!$ %
ComputeHash!!% 0
(!!0 1
enc!!1 4
.!!4 5
GetBytes!!5 =
(!!= >
texto!!> C
)!!C D
)!!D E
;!!E F
foreach"" 
("" 
byte"" 
b"" 
in""  "
result""# )
)"") *
Sb## 
.## 
Append## 
(## 
b## 
.##  
ToString##  (
(##( )
$str##) -
)##- .
)##. /
;##/ 0
}%% 
return'' 
Sb'' 
.'' 
ToString'' 
('' 
)''  
;''  !
}(( 	
[** 	
HttpGet**	 
]** 
public++ 
IActionResult++ 
Login++ "
(++" #
)++# $
{,, 	
return-- 
View-- 
(-- 
)-- 
;-- 
}.. 	
[00 	
HttpPost00	 
]00 
public11 
IActionResult11 
Login11 "
(11" #
string11# )
correo11* 0
,110 1
string112 8
contrase√±a119 C
)11C D
{22 	
if33 
(33 
correo33 
==33 
null33 
||33  
correo33! '
==33( *
$str33+ -
||33. 0
contrase√±a331 ;
==33< >
null33? C
||33D F
contrase√±a33G Q
==33R T
$str33U W
)33W X
{44 
return55 
View55 
(55 
$str55 #
)55# $
;55$ %
}66 
contrase√±a77 
=77 
Convertirsha25677 (
(77( )
contrase√±a77) 3
)773 4
;774 5
if88 
(88 
authRepositorio88 
.88  
	verificar88  )
(88) *
correo88* 0
,880 1
contrase√±a882 <
)88< =
)88= >
{99 
var:: 
claims:: 
=:: 
new::  
List::! %
<::% &
Claim::& +
>::+ ,
(::, -
)::- .
{;; 
new<< 
Claim<< 
(<< 

ClaimTypes<< (
.<<( )
Name<<) -
,<<- .
correo<</ 5
)<<5 6
,<<6 7
}== 
;== 
var>> 
claimsIdentity>> "
=>># $
new>>% (
ClaimsIdentity>>) 7
(>>7 8
claims>>8 >
,>>> ?(
CookieAuthenticationDefaults>>@ \
.>>\ ] 
AuthenticationScheme>>] q
)>>q r
;>>r s
var?? 
claimsPrincipal?? #
=??$ %
new??& )
ClaimsPrincipal??* 9
(??9 :
claimsIdentity??: H
)??H I
;??I J
HttpContextAA 
.AA 
SignInAsyncAA '
(AA' (
claimsPrincipalAA( 7
)AA7 8
;AA8 9
varCC 
usuarioCC 
=CC 
authRepositorioCC -
.CC- .
obtenerUsuarioCC. <
(CC< =
correoCC= C
,CCC D
contrase√±aCCE O
)CCO P
;CCP Q
ifEE 
(EE 
usuarioEE 
.EE 
IdRolEE !
==EE" $
$numEE% &
)EE& '
{FF 
returnGG 
RedirectToActionGG +
(GG+ ,
$strGG, 3
,GG3 4
$strGG5 @
)GG@ A
;GGA B
}HH 
elseII 
{JJ 
returnKK 
RedirectToActionKK +
(KK+ ,
$strKK, 3
,KK3 4
$strKK5 ;
)KK; <
;KK< =
}LL 
}MM 
elseNN 

ModelStateNN 
.NN 
AddModelErrorNN )
(NN) *
$strNN* 5
,NN5 6
$strNN7 W
)NNW X
;NNX Y
returnOO 
ViewOO 
(OO 
)OO 
;OO 
}PP 	
[RR 	
HttpGetRR	 
]RR 
publicSS 
IActionResultSS 
RegisterSS %
(SS% &
)SS& '
{TT 	
ViewBagUU 
.UU 
PreguntasSeguridadUU &
=UU' (
authRepositorioUU) 8
.UU8 9
obtenerPreguntasUU9 I
(UUI J
)UUJ K
;UUK L
returnVV 
ViewVV 
(VV 
newVV #
RegistroClaseIntermediaVV 3
(VV3 4
)VV4 5
)VV5 6
;VV6 7
}WW 	
[YY 	
HttpPostYY	 
]YY 
publicZZ 
IActionResultZZ 
RegisterZZ %
(ZZ% &#
RegistroClaseIntermediaZZ& =
accountZZ> E
)ZZE F
{[[ 	
int\\ 
aux\\ 
=\\ 
authRepositorio\\ %
.\\% &
contarUsuarios\\& 4
(\\4 5
)\\5 6
;\\6 7
Usuario]] 
user]] 
=]] 
new]] 
Usuario]] &
(]]& '
)]]' (
;]]( )
Direcciones^^ 
direcciones^^ #
=^^$ %
new^^& )
Direcciones^^* 5
(^^5 6
)^^6 7
;^^7 8
if`` 
(`` 

ModelState`` 
.`` 
IsValid`` "
)``" #
{aa 
userbb 
.bb 
IdRolbb 
=bb 
$numbb 
;bb 
usercc 
.cc 
Nombrecc 
=cc 
accountcc %
.cc% &
Nombrecc& ,
;cc, -
userdd 
.dd 
Apellidodd 
=dd 
accountdd  '
.dd' (
	Apellidosdd( 1
;dd1 2
useree 
.ee 

NroCelularee 
=ee  !
accountee" )
.ee) *

NroCelularee* 4
;ee4 5
userff 
.ff 
Correoff 
=ff 
accountff %
.ff% &
correoff& ,
;ff, -
usergg 
.gg 
Contrase√±agg 
=gg  !
Convertirsha256gg" 1
(gg1 2
accountgg2 9
.gg9 :
contrase√±agg: D
)ggD E
;ggE F
userhh 
.hh 
IdPreguntaSeguridadhh (
=hh) *
accounthh+ 2
.hh2 3
IdPreguntaSeguridadhh3 F
;hhF G
userii 
.ii 
RespuestaPSii  
=ii! "
accountii# *
.ii* +
RespuestaPSii+ 6
;ii6 7
direccionesjj 
.jj 
	IdUsuariojj %
=jj& '
authRepositoriojj( 7
.jj7 8
obtenerUltimoUsuarojj8 K
(jjK L
)jjL M
;jjM N
direccioneskk 
.kk 
	Direccionkk %
=kk& '
accountkk( /
.kk/ 0
	Direccionkk0 9
;kk9 :
direccionesll 
.ll 

Referenciall &
=ll' (
accountll) 0
.ll0 1

Referenciall1 ;
;ll; <
authRepositoriomm 
.mm  
	registrarmm  )
(mm) *
usermm* .
,mm. /
direccionesmm0 ;
)mm; <
;mm< =
returnnn 
RedirectToActionnn '
(nn' (
$strnn( /
)nn/ 0
;nn0 1
}oo 
ViewBagpp 
.pp 
PreguntasSeguridadpp &
=pp' (
_dbEntitiespp) 4
.pp4 5
preguntaSeguridadspp5 G
.ppG H
ToListppH N
(ppN O
)ppO P
;ppP Q
returnqq 
Viewqq 
(qq 
$strqq "
,qq" #
accountqq$ +
)qq+ ,
;qq, -
}rr 	
[ss 	
HttpGetss	 
]ss 
publictt 
IActionResulttt 
Correott #
(tt# $
)tt$ %
{uu 	
returnvv 
Viewvv 
(vv 
)vv 
;vv 
}ww 	
[xx 	
HttpPostxx	 
]xx 
publicyy 
IActionResultyy 
Correoyy #
(yy# $
stringyy$ *
correoyy+ 1
)yy1 2
{zz 	
if{{ 
({{ 
!{{ 

ModelState{{ 
.{{ 
IsValid{{ #
){{# $
{|| 
return}} 
View}} 
(}} 
$str}} $
)}}$ %
;}}% &
}~~ 
Usuario 
? 
user 
= 
authRepositorio +
.+ ,
obtenerUsuario, :
(: ;
correo; A
)A B
;B C
if
ÄÄ 
(
ÄÄ 
user
ÄÄ 
!=
ÄÄ 
null
ÄÄ 
)
ÄÄ 
{
ÅÅ 
return
ÇÇ 
RedirectToAction
ÇÇ '
(
ÇÇ' (
$str
ÇÇ( ;
,
ÇÇ; <
new
ÇÇ= @
{
ÇÇA B
Id
ÇÇC E
=
ÇÇF G
user
ÇÇH L
.
ÇÇL M
Id
ÇÇM O
}
ÇÇP Q
)
ÇÇQ R
;
ÇÇR S
}
ÉÉ 
else
ÑÑ 

ModelState
ÑÑ 
.
ÑÑ 
AddModelError
ÑÑ )
(
ÑÑ) *
$str
ÑÑ* 2
,
ÑÑ2 3
$str
ÑÑ4 J
)
ÑÑJ K
;
ÑÑK L
return
ÖÖ 
View
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
[
áá 	
HttpGet
áá	 
]
áá 
public
àà 
IActionResult
àà 
PreguntaSeguridad
àà .
(
àà. /
int
àà/ 2
Id
àà3 5
)
àà5 6
{
ââ 	
ViewBag
ää 
.
ää  
PreguntasSeguridad
ää &
=
ää' (
_dbEntities
ää) 4
.
ää4 5 
preguntaSeguridads
ää5 G
.
ääG H
ToList
ääH N
(
ääN O
)
ääO P
;
ääP Q
ViewBag
ãã 
.
ãã 
Id
ãã 
=
ãã 
Id
ãã 
;
ãã 
return
åå 
View
åå 
(
åå 
)
åå 
;
åå 
}
çç 	
[
éé 	
HttpPost
éé	 
]
éé 
public
èè 
IActionResult
èè 
PreguntaSeguridad
èè .
(
èè. /
int
èè/ 2
Id
èè3 5
,
èè5 6
int
èè7 :!
IdPreguntaSeguridad
èè; N
,
èèN O
string
èèP V
RespuestaPS
èèW b
)
èèb c
{
êê 	
if
ëë 
(
ëë 
Id
ëë 
==
ëë 
null
ëë 
||
ëë !
IdPreguntaSeguridad
ëë 1
==
ëë2 4
null
ëë5 9
||
ëë: <
RespuestaPS
ëë= H
==
ëëI K
null
ëëL P
||
ëëQ S
RespuestaPS
ëëT _
==
ëë` b
$str
ëëc e
)
ëëe f
{
íí 
ViewBag
ìì 
.
ìì  
PreguntasSeguridad
ìì *
=
ìì+ ,
_dbEntities
ìì- 8
.
ìì8 9 
preguntaSeguridads
ìì9 K
.
ììK L
ToList
ììL R
(
ììR S
)
ììS T
;
ììT U
ViewBag
îî 
.
îî 
Id
îî 
=
îî 
Id
îî 
;
îî  

ModelState
ïï 
.
ïï 
AddModelError
ïï (
(
ïï( )
$str
ïï) 0
,
ïï0 1
$str
ïï2 S
)
ïïS T
;
ïïT U
return
ññ 
View
ññ 
(
ññ 
$str
ññ /
,
ññ/ 0
Id
ññ1 3
)
ññ3 4
;
ññ4 5
}
óó 
if
òò 
(
òò 
authRepositorio
òò 
.
òò  (
verificarPreguntaSeguridad
òò  :
(
òò: ;
Id
òò; =
,
òò= >!
IdPreguntaSeguridad
òò? R
,
òòR S
RespuestaPS
òòT _
)
òò_ `
)
òò` a
{
ôô 
return
öö 
RedirectToAction
öö '
(
öö' (
$str
öö( >
,
öö> ?
new
öö@ C
{
ööD E
Id
ööF H
=
ööI J
Id
ööK M
}
ööN O
)
ööO P
;
ööP Q
}
õõ 

ModelState
úú 
.
úú 
AddModelError
úú $
(
úú$ %
$str
úú% 4
,
úú4 5
$str
úú6 I
)
úúI J
;
úúJ K
return
ùù 
RedirectToAction
ùù #
(
ùù# $
$str
ùù$ 7
,
ùù7 8
new
ùù9 <
{
ùù= >
Id
ùù? A
=
ùùB C
Id
ùùD F
}
ùùG H
)
ùùH I
;
ùùI J
}
ûû 	
[
üü 	
HttpGet
üü	 
]
üü 
public
†† 
IActionResult
†† #
ActualizarContrase√±a
†† 1
(
††1 2
int
††2 5
Id
††6 8
)
††8 9
{
°° 	
ViewBag
¢¢ 
.
¢¢ 
Id
¢¢ 
=
¢¢ 
Id
¢¢ 
;
¢¢ 
return
££ 
View
££ 
(
££ 
)
££ 
;
££ 
}
§§ 	
[
•• 	
HttpPost
••	 
]
•• 
public
¶¶ 
IActionResult
¶¶ #
ActualizarContrase√±a
¶¶ 1
(
¶¶1 2
int
¶¶2 5
Id
¶¶6 8
,
¶¶8 9
string
¶¶: @
contrase√±a
¶¶A K
,
¶¶K L
string
¶¶M S
contrase√±aV
¶¶T _
)
¶¶_ `
{
ßß 	
if
®® 
(
®® 
Id
®® 
==
®® 
null
®® 
||
®® 
contrase√±a
®® '
==
®®( *
null
®®+ /
||
®®0 2
contrase√±a
®®3 =
==
®®> @
$str
®®A C
||
®®D F
contrase√±aV
®®G R
==
®®S U
null
®®V Z
||
®®[ ]
contrase√±aV
®®^ i
==
®®j l
$str
®®m o
)
®®o p
{
©© 

ModelState
™™ 
.
™™ 
AddModelError
™™ (
(
™™( )
$str
™™) 0
,
™™0 1
$str
™™2 S
)
™™S T
;
™™T U
ViewBag
´´ 
.
´´ 
Id
´´ 
=
´´ 
Id
´´ 
;
´´  
return
¨¨ 
View
¨¨ 
(
¨¨ 
$str
¨¨ 2
,
¨¨2 3
Id
¨¨4 6
)
¨¨6 7
;
¨¨7 8
}
≠≠ 
if
ÆÆ 
(
ÆÆ 
contrase√±a
ÆÆ 
==
ÆÆ 
contrase√±aV
ÆÆ (
)
ÆÆ( )
{
ØØ 
contrase√±a
∞∞ 
=
∞∞ 
Convertirsha256
∞∞ ,
(
∞∞, -
contrase√±a
∞∞- 7
)
∞∞7 8
;
∞∞8 9
authRepositorio
±± 
.
±±  
actualizarUsuario
±±  1
(
±±1 2
Id
±±2 4
,
±±4 5
contrase√±a
±±6 @
)
±±@ A
;
±±A B

ModelState
≤≤ 
.
≤≤ 
AddModelError
≤≤ (
(
≤≤( )
$str
≤≤) 5
,
≤≤5 6
$str
≤≤7 O
)
≤≤O P
;
≤≤P Q
return
≥≥ 
RedirectToAction
≥≥ '
(
≥≥' (
$str
≥≥( /
,
≥≥/ 0
$str
≥≥1 7
)
≥≥7 8
;
≥≥8 9
}
¥¥ 
else
µµ 

ModelState
µµ 
.
µµ 
AddModelError
µµ )
(
µµ) *
$str
µµ* 6
,
µµ6 7
$str
µµ8 V
)
µµV W
;
µµW X
return
∂∂ 
RedirectToAction
∂∂ #
(
∂∂# $
$str
∂∂$ :
,
∂∂: ;
new
∂∂< ?
{
∂∂@ A
Id
∂∂B D
=
∂∂E F
Id
∂∂G I
}
∂∂J K
)
∂∂K L
;
∂∂L M
}
∑∑ 	
[
ππ 	
HttpGet
ππ	 
]
ππ 
public
∫∫ 
IActionResult
∫∫ 
Logout
∫∫ #
(
∫∫# $
)
∫∫$ %
{
ªª 	
HttpContext
ºº 
.
ºº 
SignOutAsync
ºº $
(
ºº$ %
)
ºº% &
;
ºº& '
return
ΩΩ 
RedirectToAction
ΩΩ #
(
ΩΩ# $
$str
ΩΩ$ +
)
ΩΩ+ ,
;
ΩΩ, -
}
ææ 	
}
øø 
}¿¿ ç
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\ExcepcionController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
ExcepcionController $
:% &

Controller' 1
{ 
public 
ExcepcionController "
(" #
)# $
{ 	
}

 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
} 
} ≥
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\HomeAdminController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
[		 
	Authorize		 
]		 
public

 

class

 
HomeAdminController

 $
:

% &

Controller

' 1
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly !
IHomeAdminRepositorio . 
homeAdminRepositorio/ C
;C D
public 
HomeAdminController "
(# $

DbEntities$ .

dbEntities/ 9
,9 :!
IHomeAdminRepositorio; P 
homeAdminRepositorioQ e
)e f
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
.  
homeAdminRepositorio %
=& ' 
homeAdminRepositorio( <
;< =
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
IdRol 
= 
GetLoggedUser %
(% &
)& '
.' (
IdRol( -
;- .
if 
( 
IdRol 
!= 
$num 
) 
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 <
)< =
;= >
} 
return 
View 
( 
) 
; 
} 	
private 
Usuario 
GetLoggedUser %
(% &
)& '
{   	
var!! 
claim!! 
=!! 
HttpContext!! #
.!!# $
User!!$ (
.!!( )
Claims!!) /
.!!/ 0
First!!0 5
(!!5 6
)!!6 7
;!!7 8
string"" 
username"" 
="" 
claim"" #
.""# $
Value""$ )
;"") *
return##  
homeAdminRepositorio## '
.##' (
obtenerUsuario##( 6
(##6 7
username##7 ?
)##? @
;##@ A
}$$ 	
}%% 
}&& ≠
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\HomeController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
public		 
IActionResult		 
Index		 "
(		" #
)		# $
{

 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
About "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public 
IActionResult 
Error "
(" #
)# $
{ 	
return 
View 
( 
new 
ErrorViewModel *
{+ ,
	RequestId- 6
=7 8
Activity9 A
.A B
CurrentB I
?I J
.J K
IdK M
??N P
HttpContextQ \
.\ ]
TraceIdentifier] l
}m n
)n o
;o p
} 	
} 
} ﬂ
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\MenuController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
MenuController 
:  !

Controller" ,
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly 
IMenuRepositorio )
menuRepositorio* 9
;9 :
public 
MenuController 
( 

DbEntities (

dbEntities) 3
,3 4
IMenuRepositorio5 E
menuRepositorioF U
)U V
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
menuRepositorio  
=! "
menuRepositorio# 2
;2 3
} 	
public 
IActionResult 
Index "
(" #
string# )
buscar* 0
)0 1
{ 	
var 
ListaProductos 
=  
menuRepositorio! 0
.0 1
listarProductos1 @
(@ A
)A B
;B C
if 
( 
buscar 
!= 
null 
&& !
buscar" (
!=) +
$str, .
). /
{ 
ListaProductos 
=  
ListaProductos! /
./ 0
Where0 5
(5 6
o6 7
=>8 :
o; <
.< =
Nombre= C
.C D
ContainsD L
(L M
buscarM S
,S T
StringComparisonU e
.e f
OrdinalIgnoreCasef w
)w x
||y {
o| }
.} ~
Descripcion	~ â
.
â ä
Contains
ä í
(
í ì
buscar
ì ô
,
ô ö
StringComparison
õ ´
.
´ ¨
OrdinalIgnoreCase
¨ Ω
)
Ω æ
)
æ ø
.
ø ¿
OrderBy
¿ «
(
« »
o
» …
=>
  Ã
o
Õ Œ
.
Œ œ
Nombre
œ ’
)
’ ÷
.
÷ ◊
ToList
◊ ›
(
› ﬁ
)
ﬁ ﬂ
;
ﬂ ‡
} 
ViewBag   
.   
Buscar   
=   
buscar   #
;  # $
return!! 
View!! 
(!! 
ListaProductos!! &
)!!& '
;!!' (
}"" 	
}## 
}$$ ‘E
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\PedidosController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
[

 
	Authorize

 
]

 
public 

class 
PedidosController "
:# $

Controller% /
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly 
IPedidosRepositorio ,
pedidosRepositorio- ?
;? @
public 
PedidosController  
(  !

DbEntities! +

dbEntities, 6
,6 7
IPedidosRepositorio8 K
pedidosRepositorioL ^
)^ _
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
pedidosRepositorio #
=$ %
pedidosRepositorio& 8
;8 9
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
IdRol 
= 
GetLoggedUser %
(% &
)& '
.' (
IdRol( -
;- .
if 
( 
IdRol 
!= 
$num 
) 
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 <
)< =
;= >
} 
return 
View 
( 
) 
; 
} 	
public   
IActionResult   
Espera   #
(  # $
)  $ %
{!! 	
int"" 
IdRol"" 
="" 
GetLoggedUser"" %
(""% &
)""& '
.""' (
IdRol""( -
;""- .
if## 
(## 
IdRol## 
!=## 
$num## 
)## 
{$$ 
return%% 
RedirectToAction%% '
(%%' (
$str%%( /
,%%/ 0
$str%%1 <
)%%< =
;%%= >
}&& 
ViewBag'' 
.'' 
Boletas'' 
='' 
pedidosRepositorio'' 0
.''0 1
listarEspera''1 =
(''= >
)''> ?
;''? @
ViewBag)) 
.)) 
Estados)) 
=)) 
_dbEntities)) )
.))) *
estado))* 0
.))0 1
ToList))1 7
())7 8
)))8 9
;))9 :
ViewBag++ 
.++ 
Apartado++ 
=++ 
$str++ ,
;++, -
ViewBag-- 
.-- 
Retorno-- 
=-- 
$num-- 
;--  
return// 
View// 
(// 
$str// 
)//  
;//  !
}00 	
public22 
IActionResult22 
	Entregado22 &
(22& '
)22' (
{33 	
int44 
IdRol44 
=44 
GetLoggedUser44 %
(44% &
)44& '
.44' (
IdRol44( -
;44- .
if55 
(55 
IdRol55 
!=55 
$num55 
)55 
{66 
return77 
RedirectToAction77 '
(77' (
$str77( /
,77/ 0
$str771 <
)77< =
;77= >
}88 
ViewBag99 
.99 
Boletas99 
=99 
pedidosRepositorio99 0
.990 1
listarEntregado991 @
(99@ A
)99A B
;99B C
ViewBag;; 
.;; 
Estados;; 
=;; 
_dbEntities;; )
.;;) *
estado;;* 0
.;;0 1
ToList;;1 7
(;;7 8
);;8 9
;;;9 :
ViewBag== 
.== 
Apartado== 
=== 
$str== -
;==- .
ViewBag?? 
.?? 
Retorno?? 
=?? 
$num?? 
;??  
returnAA 
ViewAA 
(AA 
$strAA 
)AA  
;AA  !
}BB 	
publicDD 
IActionResultDD 
AnuladoDD $
(DD$ %
)DD% &
{EE 	
intFF 
IdRolFF 
=FF 
GetLoggedUserFF %
(FF% &
)FF& '
.FF' (
IdRolFF( -
;FF- .
ifGG 
(GG 
IdRolGG 
!=GG 
$numGG 
)GG 
{HH 
returnII 
RedirectToActionII '
(II' (
$strII( /
,II/ 0
$strII1 <
)II< =
;II= >
}JJ 
ViewBagKK 
.KK 
BoletasKK 
=KK 
pedidosRepositorioKK 0
.KK0 1
listarAnuladoKK1 >
(KK> ?
)KK? @
;KK@ A
ViewBagMM 
.MM 
EstadosMM 
=MM 
_dbEntitiesMM )
.MM) *
estadoMM* 0
.MM0 1
ToListMM1 7
(MM7 8
)MM8 9
;MM9 :
ViewBagOO 
.OO 
ApartadoOO 
=OO 
$strOO +
;OO+ ,
ViewBagQQ 
.QQ 
RetornoQQ 
=QQ 
$numQQ 
;QQ  
returnSS 
ViewSS 
(SS 
$strSS 
)SS  
;SS  !
}TT 	
publicVV 
IActionResultVV 
ActualizarEstadoVV -
(VV- .
intVV. 1
idVV2 4
,VV4 5
intVV6 9
estadoVV: @
,VV@ A
intVVB E
retornoVVF M
)VVM N
{WW 	
ifXX 
(XX 
estadoXX 
>XX 
$numXX 
||XX 
estadoXX $
<XX% &
$numXX' (
)XX( )
{YY 

ModelStateZZ 
.ZZ 
AddModelErrorZZ (
(ZZ( )
$strZZ) 1
,ZZ1 2
$strZZ3 C
)ZZC D
;ZZD E
if[[ 
([[ 
retorno[[ 
==[[ 
$num[[  
)[[  !
{\\ 
return]] 
RedirectToAction]] +
(]]+ ,
$str]], 4
)]]4 5
;]]5 6
}^^ 
else__ 
if__ 
(__ 
retorno__  
==__! #
$num__$ %
)__% &
{`` 
returnaa 
RedirectToActionaa +
(aa+ ,
$straa, 7
)aa7 8
;aa8 9
}bb 
elsecc 
{dd 
returnee 
RedirectToActionee +
(ee+ ,
$stree, 5
)ee5 6
;ee6 7
}ff 
}gg 
varhh 
pedidoshh 
=hh 
pedidosRepositoriohh ,
.hh, -
listarPedidoshh- :
(hh: ;
idhh; =
)hh= >
;hh> ?
forjj 
(jj 
intjj 
ijj 
=jj 
$numjj 
;jj 
ijj 
<jj 
pedidosjj  '
.jj' (
Countjj( -
;jj- .
ijj/ 0
++jj0 2
)jj2 3
{kk 
pedidosll 
[ll 
ill 
]ll 
.ll 
Estadoll !
=ll" #
estadoll$ *
;ll* +
}mm 
pedidosRepositorionn 
.nn 
actualizarEstadonn /
(nn/ 0
)nn0 1
;nn1 2
ifoo 
(oo 
retornooo 
==oo 
$numoo 
)oo 
{pp 
returnqq 
RedirectToActionqq '
(qq' (
$strqq( 0
)qq0 1
;qq1 2
}rr 
elsess 
ifss 
(ss 
retornoss 
==ss 
$numss  !
)ss! "
{tt 
returnuu 
RedirectToActionuu '
(uu' (
$struu( 3
)uu3 4
;uu4 5
}vv 
elseww 
{xx 
returnyy 
RedirectToActionyy '
(yy' (
$stryy( 1
)yy1 2
;yy2 3
}zz 
}{{ 	
private}} 
Usuario}} 
GetLoggedUser}} %
(}}% &
)}}& '
{~~ 	
var 
claim 
= 
HttpContext #
.# $
User$ (
.( )
Claims) /
./ 0
First0 5
(5 6
)6 7
;7 8
string
ÄÄ 
username
ÄÄ 
=
ÄÄ 
claim
ÄÄ #
.
ÄÄ# $
Value
ÄÄ$ )
;
ÄÄ) *
return
ÅÅ  
pedidosRepositorio
ÅÅ %
.
ÅÅ% &
obtenerUsuario
ÅÅ& 4
(
ÅÅ4 5
username
ÅÅ5 =
)
ÅÅ= >
;
ÅÅ> ?
}
ÇÇ 	
}
ÉÉ 
}ÑÑ Ñg
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\PersonaController.cs
	namespace

 	
Maxdel


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
public 

class 
PersonaController "
:# $

Controller% /
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly 
IPersonaRepositorio ,
personaRepositorio- ?
;? @
public 
PersonaController  
(  !

DbEntities! +

dbEntities, 6
,6 7
IPersonaRepositorio8 K
personaRepositorioL ^
)^ _
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
personaRepositorio #
=$ %
personaRepositorio& 8
;8 9
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
Id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
var 
persona 
= 
personaRepositorio ,
., -
obtenerUsuarioId- =
(= >
Id> @
)@ A
;A B
ViewBag 
. 
Direcciones 
=  !
personaRepositorio" 4
.4 5
obtenerDirecciones5 G
(G H
IdH J
)J K
;K L
return 
View 
( 
persona 
)  
;  !
} 	
[ 	
HttpGet	 
] 
public   
IActionResult   
EditarPersona   *
(  * +
)  + ,
{!! 	
int"" 
id"" 
="" 
GetLoggedUser"" "
(""" #
)""# $
.""$ %
Id""% '
;""' (
var## 
persona## 
=## 
personaRepositorio## ,
.##, -
obtenerUsuarioId##- =
(##= >
id##> @
)##@ A
;##A B
return$$ 
View$$ 
($$ 
persona$$ 
)$$  
;$$  !
}%% 	
[&& 	
HttpPost&&	 
]&& 
public'' 
IActionResult'' 
EditarPersona'' *
(''* +
int''+ .
id''/ 1
,''1 2
Usuario''3 :
user''; ?
)''? @
{(( 	
if)) 
()) 
user)) 
.)) 
Nombre)) 
==)) 
null)) #
||))$ &
user))' +
.))+ ,
Nombre)), 2
==))3 5
$str))6 8
||** 
user** 
.** 
Apellido**  
==**! #
null**$ (
||**) +
user**, 0
.**0 1
Apellido**1 9
==**: <
$str**= ?
||++ 
user++ 
.++ 

NroCelular++ "
==++# %
null++& *
||+++ -
user++. 2
.++2 3

NroCelular++3 =
==++> @
$str++A C
||,, 
user,, 
.,, 
Correo,, 
==,, !
null,," &
||,,' )
user,,* .
.,,. /
Correo,,/ 5
==,,6 8
$str,,9 ;
),,; <
{-- 
var.. 
persona.. 
=.. 
_dbEntities.. )
...) *
usuarios..* 2
...2 3
First..3 8
(..8 9
o..9 :
=>..; =
o..> ?
...? @
Id..@ B
==..C E
id..F H
)..H I
;..I J

ModelState// 
.// 
AddModelError// (
(//( )
$str//) 1
,//1 2
$str//3 C
)//C D
;//D E
return00 
View00 
(00 
$str00 +
,00+ ,
persona00- 4
)004 5
;005 6
}11 
var22 
Persona22 
=22 
personaRepositorio22 ,
.22, -
obtenerUsuarioId22- =
(22= >
id22> @
)22@ A
;22A B
Persona33 
.33 
Nombre33 
=33 
user33 !
.33! "
Nombre33" (
;33( )
Persona44 
.44 
Apellido44 
=44 
user44 #
.44# $
Apellido44$ ,
;44, -
Persona55 
.55 

NroCelular55 
=55  
user55! %
.55% &

NroCelular55& 0
;550 1
Persona66 
.66 
Correo66 
=66 
user66 !
.66! "
Correo66" (
;66( )
personaRepositorio77 
.77 
actualizarBD77 +
(77+ ,
)77, -
;77- .
return88 
RedirectToAction88 #
(88# $
$str88$ +
,88+ ,
$str88- 6
)886 7
;887 8
}99 	
public:: 
IActionResult:: 
AgregaDireccion:: ,
(::, -
)::- .
{;; 	
return<< 
View<< 
(<< 
)<< 
;<< 
}== 	
public>> 
IActionResult>> 
NuevaDireccion>> +
(>>+ ,
int>>, /
retorno>>0 7
,>>7 8
string>>9 ?
	Direccion>>@ I
,>>I J
string>>K Q

Referencia>>R \
)>>\ ]
{?? 	
if@@ 
(@@ 
	Direccion@@ 
==@@ 
null@@ !
||@@" $
	Direccion@@% .
==@@/ 1
$str@@2 4
||@@5 7

Referencia@@8 B
==@@C E
null@@F J
||@@K M

Referencia@@N X
==@@Y [
$str@@\ ^
)@@^ _
{AA 

ModelStateBB 
.BB 
AddModelErrorBB (
(BB( )
$strBB) 4
,BB4 5
$strBB6 W
)BBW X
;BBX Y
returnCC 
ViewCC 
(CC 
$strCC -
)CC- .
;CC. /
}DD 
intEE 
IdEE 
=EE 
GetLoggedUserEE "
(EE" #
)EE# $
.EE$ %
IdEE% '
;EE' (
DireccionesFF 
	direccionFF !
=FF" #
newFF$ '
DireccionesFF( 3
(FF3 4
)FF4 5
;FF5 6
	direccionGG 
.GG 
	IdUsuarioGG 
=GG  !
IdGG" $
;GG$ %
	direccionHH 
.HH 
	DireccionHH 
=HH  !
	DireccionHH" +
;HH+ ,
	direccionII 
.II 

ReferenciaII  
=II! "

ReferenciaII# -
;II- .
personaRepositorioJJ 
.JJ 
agregarDireccionJJ /
(JJ/ 0
	direccionJJ0 9
)JJ9 :
;JJ: ;
ifKK 
(KK 
retornoKK 
==KK 
$numKK 
)KK 
returnKK #
RedirectToActionKK$ 4
(KK4 5
$strKK5 <
,KK< =
$strKK> G
)KKG H
;KKH I
elseLL 
returnLL 
RedirectToActionLL (
(LL( )
$strLL) 0
,LL0 1
$strLL2 B
)LLB C
;LLC D
}MM 	
publicNN 
IActionResultNN 
EliminarDireccionNN .
(NN. /
intNN/ 2
idNN3 5
)NN5 6
{OO 	
personaRepositorioPP 
.PP 
eliminarDireccionPP 0
(PP0 1
idPP1 3
)PP3 4
;PP4 5
returnQQ 
RedirectToActionQQ #
(QQ# $
$strQQ$ +
,QQ+ ,
$strQQ- 6
)QQ6 7
;QQ7 8
}RR 	
[SS 	
HttpGetSS	 
]SS 
publicTT 
IActionResultTT !
ActualizarContrase√±aTT 1
(TT1 2
)TT2 3
{UU 	
returnVV 
ViewVV 
(VV 
)VV 
;VV 
}WW 	
[XX 	
HttpPostXX	 
]XX 
publicYY 
IActionResultYY !
ActualizarContrase√±aYY 1
(YY1 2
stringYY2 8
contrase√±aActualYY9 I
,YYI J
stringYYK Q
contrase√±aNuevaYYR a
,YYa b
stringYYc i 
contrase√±aVerificarYYj }
)YY} ~
{ZZ 	
int[[ 
Id[[ 
=[[ 
GetLoggedUser[[ "
([[" #
)[[# $
.[[$ %
Id[[% '
;[[' (
contrase√±aActual\\ 
=\\ 
Convertirsha256\\ .
(\\. /
contrase√±aActual\\/ ?
)\\? @
;\\@ A
if]] 
(]] 
_dbEntities]] 
.]] 
usuarios]] $
.]]$ %
Any]]% (
(]]( )
x]]) *
=>]]+ -
x]]. /
.]]/ 0
Id]]0 2
==]]3 5
Id]]6 8
&&]]9 ;
x]]< =
.]]= >
Contrase√±a]]> H
==]]I K
contrase√±aActual]]L \
)]]\ ]
)]]] ^
{^^ 
if__ 
(__ 
contrase√±aNueva__ #
==__$ & 
contrase√±aVerificar__' :
)__: ;
{`` 
contrase√±aNuevaaa #
=aa$ %
Convertirsha256aa& 5
(aa5 6
contrase√±aNuevaaa6 E
)aaE F
;aaF G
personaRepositoriobb &
.bb& '!
actualizarContrase√±abb' ;
(bb; <
Idbb< >
,bb> ?
contrase√±aNuevabb@ O
)bbO P
;bbP Q

ModelStatecc 
.cc 
AddModelErrorcc ,
(cc, -
$strcc- 9
,cc9 :
$strcc; S
)ccS T
;ccT U
vardd 
personadd 
=dd  !
personaRepositoriodd" 4
.dd4 5
obtenerUsuarioIddd5 E
(ddE F
IdddF H
)ddH I
;ddI J
ViewBagee 
.ee 
Direccionesee '
=ee( )
personaRepositorioee* <
.ee< =
obtenerDireccionesee= O
(eeO P
IdeeP R
)eeR S
;eeS T
returnff 
Viewff 
(ff  
$strff  '
,ff' (
personaff) 0
)ff0 1
;ff1 2
}gg 

ModelStatehh 
.hh 
AddModelErrorhh (
(hh( )
$strhh) :
,hh: ;
$strhh< Z
)hhZ [
;hh[ \
returnii 
Viewii 
(ii 
)ii 
;ii 
}jj 

ModelStatekk 
.kk 
AddModelErrorkk $
(kk$ %
$strkk% 7
,kk7 8
$strkk9 M
)kkM N
;kkN O
returnll 
Viewll 
(ll 
)ll 
;ll 
}mm 	
privatenn 
Usuarionn 
GetLoggedUsernn %
(nn% &
)nn& '
{oo 	
varpp 
claimpp 
=pp 
HttpContextpp #
.pp# $
Userpp$ (
.pp( )
Claimspp) /
.pp/ 0
Firstpp0 5
(pp5 6
)pp6 7
;pp7 8
stringqq 
usernameqq 
=qq 
claimqq #
.qq# $
Valueqq$ )
;qq) *
returnrr 
personaRepositoriorr %
.rr% & 
obtenerUsuarioStringrr& :
(rr: ;
usernamerr; C
)rrC D
;rrD E
}ss 	
publicuu 
staticuu 
stringuu 
Convertirsha256uu ,
(uu, -
stringuu- 3
textouu4 9
)uu9 :
{vv 	
StringBuilderww 
Sbww 
=ww 
newww "
StringBuilderww# 0
(ww0 1
)ww1 2
;ww2 3
usingxx 
(xx 
SHA256xx 
hashxx 
=xx  
SHA256Managedxx! .
.xx. /
Createxx/ 5
(xx5 6
)xx6 7
)xx7 8
{yy 
Encodingzz 
enczz 
=zz 
Encodingzz '
.zz' (
UTF8zz( ,
;zz, -
byte{{ 
[{{ 
]{{ 
result{{ 
={{ 
hash{{  $
.{{$ %
ComputeHash{{% 0
({{0 1
enc{{1 4
.{{4 5
GetBytes{{5 =
({{= >
texto{{> C
){{C D
){{D E
;{{E F
foreach|| 
(|| 
byte|| 
b|| 
in||  "
result||# )
)||) *
Sb}} 
.}} 
Append}} 
(}} 
b}} 
.}}  
ToString}}  (
(}}( )
$str}}) -
)}}- .
)}}. /
;}}/ 0
} 
return
ÅÅ 
Sb
ÅÅ 
.
ÅÅ 
ToString
ÅÅ 
(
ÅÅ 
)
ÅÅ  
;
ÅÅ  !
}
ÇÇ 	
}
ÉÉ 
}ÑÑ Á≤
VD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\ProcesarCompraController.cs
	namespace

 	
Maxdel


 
.

 
Controllers

 
{ 
public 

class $
ProcesarCompraController )
:* +

Controller, 6
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly &
IProcesarCompraRepositorio 3%
procesarCompraRepositorio4 M
;M N
public $
ProcesarCompraController '
(' (

DbEntities( 2

dbEntities3 =
,= >&
IProcesarCompraRepositorio? Y%
procesarCompraRepositorioZ s
)s t
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. %
procesarCompraRepositorio *
=+ ,%
procesarCompraRepositorio- F
;F G
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Detalle $
($ %
int% (

IdProducto) 3
)3 4
{ 	
var 
Producto 
= %
procesarCompraRepositorio 4
.4 5
obtenerProducto5 D
(D E

IdProductoE O
)O P
;P Q
return 
View 
( 
Producto  
)  !
;! "
} 	
[ 	
HttpPost	 
] 
[ 	
	Authorize	 
] 
public 
IActionResult 
Detalle $
($ %
int% (

IdProducto) 3
,3 4"
ComprarClaseIntermedia5 K
claseL Q
)Q R
{ 	
if 
( 
clase 
. 

IdProducto  
==! #
null$ (
||) +
clase, 1
.1 2
Cantidad2 :
==; =
null> B
||C E
claseF K
.K L
CantidadL T
<U V
$numW X
)X Y
{   
var!! 
Producto!! 
=!! %
procesarCompraRepositorio!! 8
.!!8 9
obtenerProducto!!9 H
(!!H I

IdProducto!!I S
)!!S T
;!!T U

ModelState"" 
."" 
AddModelError"" (
(""( )
$str"") 5
,""5 6
$str""7 X
)""X Y
;""Y Z
return## 
View## 
(## 
Producto## $
)##$ %
;##% &
}$$ 
int%% 
Id%% 
=%% 
GetLoggedUser%% "
(%%" #
)%%# $
.%%$ %
Id%%% '
;%%' (
Pedido&& 
pedido&& 
=&& 
new&& 
Pedido&&  &
(&&& '
)&&' (
;&&( )
DetallePedido'' 
detallePedido'' '
=''( )
new''* -
DetallePedido''. ;
(''; <
)''< =
;''= >
pedido(( 
.(( 
	IdUsuario(( 
=(( 
Id(( !
;((! "
pedido)) 
.)) 
Estado)) 
=)) 
$num)) 
;)) 
pedido** 
.** 
Destino** 
=** 
$str** '
;**' (
_dbEntities,, 
.,, 
pedidos,, 
.,,  
Add,,  #
(,,# $
pedido,,$ *
),,* +
;,,+ ,
_dbEntities-- 
.-- 
SaveChanges-- #
(--# $
)--$ %
;--% &
int// 
idPedido// 
=// %
procesarCompraRepositorio// 4
.//4 5
obtenerIdPedido//5 D
(//D E
)//E F
;//F G
detallePedido11 
.11 

IdProducto11 $
=11% &

IdProducto11' 1
;111 2
detallePedido22 
.22 
IdPedido22 "
=22# $
idPedido22% -
;22- .
detallePedido33 
.33 
IdTama√±oPrecio33 (
=33) *
clase33+ 0
.330 1
IdTama√±oPrecio331 ?
;33? @
detallePedido44 
.44 
Cantidad44 "
=44# $
clase44% *
.44* +
Cantidad44+ 3
;443 4
Tama√±oPrecio55 
tama√±oPrecio55 %
=55& '%
procesarCompraRepositorio55( A
.55A B 
obtenerTama√±oPrecio55B U
(55U V
detallePedido55V c
.55c d
IdTama√±oPrecio55d r
)55r s
;55s t
detallePedido66 
.66 
Tama√±oProducto66 (
=66) *
tama√±oPrecio66+ 7
.667 8
Tama√±oProducto668 F
;66F G
detallePedido77 
.77 
precio77  
=77! "
tama√±oPrecio77# /
.77/ 0
Precio770 6
;776 7
Pedido:: 

pedidoAux2:: 
=:: 
new::  #
Pedido::$ *
(::* +
)::+ ,
;::, -

pedidoAux2;; 
=;; 
_dbEntities;; $
.;;$ %
pedidos;;% ,
.;;, -
First;;- 2
(;;2 3
o;;3 4
=>;;5 7
o;;8 9
.;;9 :
Id;;: <
==;;= ?
idPedido;;@ H
);;H I
;;;I J

pedidoAux2<< 
.<< 
Monto<< 
=<< 
clase<< $
.<<$ %
Cantidad<<% -
*<<. /
tama√±oPrecio<<0 <
.<<< =
Precio<<= C
;<<C D
_dbEntities== 
.== 
SaveChanges== #
(==# $
)==$ %
;==% &%
procesarCompraRepositorio>> %
.>>% &
agregarDetalle>>& 4
(>>4 5
detallePedido>>5 B
)>>B C
;>>C D
return@@ 
RedirectToAction@@ #
(@@# $
$str@@$ +
,@@+ ,
$str@@- =
)@@= >
;@@> ?
}AA 	
[BB 	
	AuthorizeBB	 
]BB 
publicCC 
IActionResultCC 
CestaCC "
(CC" #
)CC# $
{DD 	
intEE 
IdEE 
=EE 
GetLoggedUserEE "
(EE" #
)EE# $
.EE$ %
IdEE% '
;EE' (
ViewBagGG 
.GG 

DatosCestaGG 
=GG  %
procesarCompraRepositorioGG! :
.GG: ;
listarDatosCestaGG; K
(GGK L
IdGGL N
)GGN O
;GGO P
ViewBagII 
.II 
MontoII 
=II 
obtenerMontoII (
(II( )
IdII) +
)II+ ,
;II, -
ViewBagKK 
.KK 
DireccionesKK 
=KK  !%
procesarCompraRepositorioKK" ;
.KK; <
obtenerDireccionesKK< N
(KKN O
IdKKO Q
)KKQ R
;KKR S
returnLL 
ViewLL 
(LL 
)LL 
;LL 
}MM 	
publicOO 
decimalOO 
obtenerMontoOO #
(OO# $
intOO$ '
IdOO( *
)OO* +
{PP 	
decimalQQ 
montoQQ 
=QQ 
$numQQ 
;QQ 
varSS 
auxSS 
=SS %
procesarCompraRepositorioSS /
.SS/ 0
obtenerMontosSS0 =
(SS= >
IdSS> @
)SS@ A
;SSA B
foreachUU 
(UU 
varUU 
itemUU 
inUU  
auxUU! $
)UU$ %
{VV 
montoWW 
+=WW 
itemWW 
.WW 
precioWW $
*WW% &
itemWW' +
.WW+ ,
CantidadWW, 4
;WW4 5
}XX 
returnZZ 
montoZZ 
;ZZ 
}[[ 	
[]] 	
	Authorize]]	 
]]] 
public^^ 
IActionResult^^ 
ActualizarCantidad^^ /
(^^/ 0
int^^0 3
Id^^4 6
,^^6 7
int^^8 ;
Cantidad^^< D
)^^D E
{__ 	
if`` 
(`` 
Cantidad`` 
==`` 
null``  
||``! #
Cantidad``$ ,
<``- .
$num``/ 0
)``0 1
{aa 

ModelStatebb 
.bb 
AddModelErrorbb (
(bb( )
$strbb) 3
,bb3 4
$strbb5 H
)bbH I
;bbI J
returncc 
RedirectToActioncc '
(cc' (
$strcc( /
,cc/ 0
$strcc1 A
)ccA B
;ccB C
}dd %
procesarCompraRepositorioee %
.ee% &
actualizarCantidadee& 8
(ee8 9
Idee9 ;
,ee; <
Cantidadee= E
)eeE F
;eeF G
returnff 
RedirectToActionff #
(ff# $
$strff$ +
,ff+ ,
$strff- =
)ff= >
;ff> ?
}gg 	
privatehh 
Usuariohh 
GetLoggedUserhh %
(hh% &
)hh& '
{ii 	
varjj 
claimjj 
=jj 
HttpContextjj #
.jj# $
Userjj$ (
.jj( )
Claimsjj) /
.jj/ 0
Firstjj0 5
(jj5 6
)jj6 7
;jj7 8
stringkk 
usernamekk 
=kk 
claimkk #
.kk# $
Valuekk$ )
;kk) *
returnll %
procesarCompraRepositorioll ,
.ll, -
obtenerUsuarioll- ;
(ll; <
usernamell< D
)llD E
;llE F
}mm 	
privateoo 
stringoo 
generarCodTrackingoo )
(oo) *
intoo* -
Idoo. 0
)oo0 1
{pp 	
stringqq 
codTrackingqq 
=qq  
$strqq! &
;qq& '
Usuariorr 
temprr 
=rr %
procesarCompraRepositoriorr 4
.rr4 5
obtenerUsuarioFirstrr5 H
(rrH I
IdrrI K
)rrK L
;rrL M
stringss 
temp1ss 
=ss 
tempss 
.ss  
Nombress  &
;ss& '
codTrackingtt 
+=tt 
temp1tt  
[tt  !
$numtt! "
]tt" #
;tt# $
temp1uu 
=uu 
tempuu 
.uu 
Apellidouu !
;uu! "
codTrackingvv 
+=vv 
temp1vv  
[vv  !
$numvv! "
]vv" #
;vv# $
intww 
nroww 
=ww %
procesarCompraRepositorioww /
.ww/ 0$
obtenerSecuenciaTrackingww0 H
(wwH I
)wwI J
;wwJ K
temp1xx 
=xx 
nroxx 
.xx 
ToStringxx  
(xx  !
)xx! "
;xx" #
intyy 
cantyy 
=yy 
temp1yy 
.yy 
Lengthyy #
;yy# $
intzz 
maxzz 
=zz 
$numzz 
-zz 
cantzz 
;zz 
for{{ 
({{ 
int{{ 
i{{ 
={{ 
$num{{ 
;{{ 
i{{ 
<{{ 
max{{  #
;{{# $
i{{% &
++{{& (
){{( )
{|| 
codTracking}} 
+=}} 
$str}} "
;}}" #
}~~ 
codTracking 
+= 
temp1  
;  !'
procesarCompraRepositorio
ÄÄ %
.
ÄÄ% &#
actualizarCodTracking
ÄÄ& ;
(
ÄÄ; <
)
ÄÄ< =
;
ÄÄ= >
return
ÅÅ 
codTracking
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
[
ÑÑ 	
HttpGet
ÑÑ	 
]
ÑÑ 
[
ÖÖ 	
	Authorize
ÖÖ	 
]
ÖÖ 
public
ÜÜ 
IActionResult
ÜÜ 
Delete
ÜÜ #
(
ÜÜ# $
int
ÜÜ$ '
id
ÜÜ( *
)
ÜÜ* +
{
áá 	'
procesarCompraRepositorio
àà %
.
àà% &
eliminarPedido
àà& 4
(
àà4 5
id
àà5 7
)
àà7 8
;
àà8 9
return
ää 
RedirectToAction
ää #
(
ää# $
$str
ää$ +
,
ää+ ,
$str
ää- =
)
ää= >
;
ää> ?
}
ãã 	
[
åå 	
	Authorize
åå	 
]
åå 
public
çç 
IActionResult
çç 
PedidoExito
çç (
(
çç( )
int
çç) ,
IdDireccion
çç- 8
)
çç8 9
{
éé 	
if
èè 
(
èè 
IdDireccion
èè 
==
èè 
null
èè #
||
èè$ &
IdDireccion
èè' 2
==
èè3 5
$num
èè6 7
)
èè7 8
{
êê 
int
ëë 
Id
ëë 
=
ëë 
GetLoggedUser
ëë &
(
ëë& '
)
ëë' (
.
ëë( )
Id
ëë) +
;
ëë+ ,
ViewBag
ìì 
.
ìì 

DatosCesta
ìì "
=
ìì# $
_dbEntities
ìì% 0
.
ìì0 1
detallePedidos
ìì1 ?
.
îî 
Include
îî  
(
îî  !
o
îî! "
=>
îî# %
o
îî& '
.
îî' (
Producto
îî( 0
)
îî0 1
.
ïï 
Include
ïï  
(
ïï  !
o
ïï! "
=>
ïï# %
o
ïï& '
.
ïï' (
Pedido
ïï( .
)
ïï. /
.
ññ 
Include
ññ  
(
ññ  !
o
ññ! "
=>
ññ# %
o
ññ& '
.
ññ' (
Pedido
ññ( .
.
ññ. /
EstadoFK
ññ/ 7
)
ññ7 8
.
óó 
Where
óó 
(
óó 
o
óó  
=>
óó! #
o
óó$ %
.
óó% &
Pedido
óó& ,
.
óó, -
	IdUsuario
óó- 6
==
óó7 9
Id
óó: <
&&
óó= ?
o
óó@ A
.
óóA B
Pedido
óóB H
.
óóH I
Estado
óóI O
==
óóP R
$num
óóS T
)
óóT U
.
óóU V
ToList
óóV \
(
óó\ ]
)
óó] ^
;
óó^ _
ViewBag
ôô 
.
ôô 
Monto
ôô 
=
ôô 
obtenerMonto
ôô  ,
(
ôô, -
Id
ôô- /
)
ôô/ 0
;
ôô0 1
ViewBag
õõ 
.
õõ 
Direcciones
õõ #
=
õõ$ %
_dbEntities
õõ& 1
.
õõ1 2
direcciones
õõ2 =
.
úú 
Where
úú 
(
úú 
o
úú  
=>
úú! #
o
úú$ %
.
úú% &
	IdUsuario
úú& /
==
úú0 2
Id
úú3 5
)
úú5 6
;
úú6 7

ModelState
ùù 
.
ùù 
AddModelError
ùù (
(
ùù( )
$str
ùù) 4
,
ùù4 5
$str
ùù6 K
)
ùùK L
;
ùùL M
return
ûû 
View
ûû 
(
ûû 
$str
ûû #
,
ûû# $
$str
ûû% 5
)
ûû5 6
;
ûû6 7
}
üü 
ViewBag
†† 
.
†† 
nroTracking
†† 
=
††  !
Comprar
††" )
(
††) *
IdDireccion
††* 5
)
††5 6
;
††6 7
return
°° 
View
°° 
(
°° 
)
°° 
;
°° 
}
¢¢ 	
private
££ 
string
££ 
Comprar
££ 
(
££ 
int
££ "
IdDireccion
££# .
)
££. /
{
§§ 	
int
•• 
Id
•• 
=
•• 
GetLoggedUser
•• "
(
••" #
)
••# $
.
••$ %
Id
••% '
;
••' (
List
¶¶ 
<
¶¶ 
Pedido
¶¶ 
>
¶¶ 
pedidos
¶¶  
=
¶¶! "
new
¶¶# &
List
¶¶' +
<
¶¶+ ,
Pedido
¶¶, 2
>
¶¶2 3
(
¶¶3 4
)
¶¶4 5
;
¶¶5 6
pedidos
ßß 
=
ßß 
_dbEntities
ßß !
.
ßß! "
pedidos
ßß" )
.
ßß) *
Where
ßß* /
(
ßß/ 0
o
ßß0 1
=>
ßß2 4
o
ßß5 6
.
ßß6 7
	IdUsuario
ßß7 @
==
ßßA C
Id
ßßD F
&&
ßßG I
o
ßßJ K
.
ßßK L
Estado
ßßL R
==
ßßS U
$num
ßßV W
)
ßßW X
.
ßßX Y
ToList
ßßY _
(
ßß_ `
)
ßß` a
;
ßßa b
int
®® 
IdBoleta
®® 
=
®® 
generarNroBoleta
®® +
(
®®+ ,
IdDireccion
®®, 7
)
®®7 8
;
®®8 9
string
©© 
codTracking
©© 
=
©©   
generarCodTracking
©©! 3
(
©©3 4
Id
©©4 6
)
©©6 7
;
©©7 8
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
$num
™™ 
;
™™ 
i
™™ 
<
™™ 
pedidos
™™  '
.
™™' (
Count
™™( -
;
™™- .
i
™™/ 0
++
™™0 2
)
™™2 3
{
´´ 
pedidos
¨¨ 
[
¨¨ 
i
¨¨ 
]
¨¨ 
.
¨¨ 
Estado
¨¨ !
=
¨¨" #
$num
¨¨$ %
;
¨¨% &
pedidos
≠≠ 
[
≠≠ 
i
≠≠ 
]
≠≠ 
.
≠≠ 
CodTracking
≠≠ &
=
≠≠' (
codTracking
≠≠) 4
;
≠≠4 5
pedidos
ÆÆ 
[
ÆÆ 
i
ÆÆ 
]
ÆÆ 
.
ÆÆ 
IdBoleta
ÆÆ #
=
ÆÆ$ %
IdBoleta
ÆÆ& .
;
ÆÆ. /
}
ØØ 
_dbEntities
∞∞ 
.
∞∞ 
SaveChanges
∞∞ #
(
∞∞# $
)
∞∞$ %
;
∞∞% &
return
±± 
codTracking
±± 
;
±± 
}
≤≤ 	
private
≥≥ 
int
≥≥ 
generarNroBoleta
≥≥ $
(
≥≥$ %
int
≥≥% (
IdDireccion
≥≥) 4
)
≥≥4 5
{
¥¥ 	
string
µµ 
	nroBoleta
µµ 
=
µµ 
$str
µµ %
;
µµ% &
int
∂∂ 
aux2
∂∂ 
;
∂∂ 
int
∑∑ 
nroTemp
∑∑ 
=
∑∑ 
_dbEntities
∑∑ %
.
∑∑% &
boletas
∑∑& -
.
∑∑- .
Count
∑∑. 3
(
∑∑3 4
)
∑∑4 5
;
∑∑5 6
nroTemp
∏∏ 
++
∏∏ 
;
∏∏ 
string
ππ 
aux
ππ 
=
ππ 
nroTemp
ππ  
.
ππ  !
ToString
ππ! )
(
ππ) *
)
ππ* +
;
ππ+ ,
nroTemp
∫∫ 
=
∫∫ 
aux
∫∫ 
.
∫∫ 
Length
∫∫  
;
∫∫  !
nroTemp
ªª 
=
ªª 
$num
ªª 
-
ªª 
nroTemp
ªª !
;
ªª! "
for
ºº 
(
ºº 
int
ºº 
i
ºº 
=
ºº 
$num
ºº 
;
ºº 
i
ºº 
<
ºº 
nroTemp
ºº  '
;
ºº' (
i
ºº) *
++
ºº* ,
)
ºº, -
{
ΩΩ 
	nroBoleta
ææ 
+=
ææ 
$str
ææ  
;
ææ  !
}
øø 
	nroBoleta
¿¿ 
+=
¿¿ 
aux
¿¿ 
;
¿¿ 
DateTime
¡¡ 
fecha
¡¡ 
=
¡¡ 
DateTime
¡¡ %
.
¡¡% &
Now
¡¡& )
;
¡¡) *
int
¬¬ 
Id
¬¬ 
=
¬¬ 
GetLoggedUser
¬¬ "
(
¬¬" #
)
¬¬# $
.
¬¬$ %
Id
¬¬% '
;
¬¬' (
var
√√ 
montos
√√ 
=
√√ 
_dbEntities
√√ $
.
√√$ %
pedidos
√√% ,
.
√√, -
Where
√√- 2
(
√√2 3
o
√√3 4
=>
√√5 7
o
√√8 9
.
√√9 :
	IdUsuario
√√: C
==
√√D F
Id
√√G I
&&
√√J L
o
√√M N
.
√√N O
Estado
√√O U
==
√√V X
$num
√√Y Z
)
√√Z [
.
√√[ \
ToList
√√\ b
(
√√b c
)
√√c d
;
√√d e
decimal
ƒƒ 
monto
ƒƒ 
=
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
foreach
≈≈ 
(
≈≈ 
var
≈≈ 
item
≈≈ 
in
≈≈  
montos
≈≈! '
)
≈≈' (
{
∆∆ 
monto
«« 
+=
«« 
(
«« 
decimal
«« !
)
««! "
item
««" &
.
««& '
Monto
««' ,
;
««, -
}
»» 
Boleta
…… 
boleta
…… 
=
…… 
new
…… 
Boleta
……  &
(
……& '
)
……' (
;
……( )
boleta
   
.
   
Fecha
   
=
   
fecha
    
;
    !
boleta
ÀÀ 
.
ÀÀ 
	NroBoleta
ÀÀ 
=
ÀÀ 
	nroBoleta
ÀÀ (
;
ÀÀ( )
boleta
ÃÃ 
.
ÃÃ 

MontoTotal
ÃÃ 
=
ÃÃ 
monto
ÃÃ  %
;
ÃÃ% &
var
ÕÕ 
	direccion
ÕÕ 
=
ÕÕ 
_dbEntities
ÕÕ '
.
ÕÕ' (
direcciones
ÕÕ( 3
.
ÕÕ3 4
First
ÕÕ4 9
(
ÕÕ9 :
o
ÕÕ: ;
=>
ÕÕ< >
o
ÕÕ? @
.
ÕÕ@ A
Id
ÕÕA C
==
ÕÕD F
IdDireccion
ÕÕG R
)
ÕÕR S
;
ÕÕS T
boleta
ŒŒ 
.
ŒŒ 
	Direccion
ŒŒ 
=
ŒŒ 
	direccion
ŒŒ (
.
ŒŒ( )
	Direccion
ŒŒ) 2
;
ŒŒ2 3
boleta
œœ 
.
œœ 

Referencia
œœ 
=
œœ 
	direccion
œœ  )
.
œœ) *

Referencia
œœ* 4
;
œœ4 5
boleta
–– 
.
–– 
	IdUsuario
–– 
=
–– 
GetLoggedUser
–– ,
(
––, -
)
––- .
.
––. /
Id
––/ 1
;
––1 2
_dbEntities
—— 
.
—— 
boletas
—— 
.
——  
Add
——  #
(
——# $
boleta
——$ *
)
——* +
;
——+ ,
_dbEntities
““ 
.
““ 
SaveChanges
““ #
(
““# $
)
““$ %
;
““% &
aux2
”” 
=
”” 
_dbEntities
”” 
.
”” 
boletas
”” &
.
””& '
OrderBy
””' .
(
””. /
o
””/ 0
=>
””1 3
o
””4 5
.
””5 6
Id
””6 8
)
””8 9
.
””9 :
Last
””: >
(
””> ?
)
””? @
.
””@ A
Id
””A C
;
””C D
return
‘‘ 
aux2
‘‘ 
;
‘‘ 
}
’’ 	
}
÷÷ 
}◊◊ “[
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\ProductosController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
[

 
	Authorize

 
]

 
public 

class 
ProductosController $
:% &

Controller' 1
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly "
IProductosRepositorios /!
productosRepositorios0 E
;E F
public 
ProductosController "
(" #

DbEntities# -

dbEntities. 8
,8 9"
IProductosRepositorios: P!
productosRepositoriosQ f
)f g
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. !
productosRepositorios &
=' (!
productosRepositorios) >
;> ?
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
IdRol 
= 
GetLoggedUser %
(% &
)& '
.' (
IdRol( -
;- .
if 
( 
IdRol 
!= 
$num 
) 
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 <
)< =
;= >
} 
var 
ListaProductos 
=  !
productosRepositorios! 6
.6 7
listarProductos7 F
(F G
)G H
;H I
return 
View 
( 
ListaProductos &
)& '
;' (
} 	
[!! 	
HttpGet!!	 
]!! 
public"" 
IActionResult"" 
AgregarProducto"" ,
("", -
)""- .
{## 	
int$$ 
IdRol$$ 
=$$ 
GetLoggedUser$$ %
($$% &
)$$& '
.$$' (
IdRol$$( -
;$$- .
if%% 
(%% 
IdRol%% 
!=%% 
$num%% 
)%% 
{&& 
return'' 
RedirectToAction'' '
(''' (
$str''( /
,''/ 0
$str''1 <
)''< =
;''= >
}(( 
return)) 
View)) 
()) 
))) 
;)) 
}** 	
[++ 	
HttpPost++	 
]++ 
public,, 
IActionResult,, 
AgregarProducto,, ,
(,,, -
	Productos,,- 6
	productos,,7 @
),,@ A
{-- 	!
productosRepositorios33 !
.33! "
agregarProducto33" 1
(331 2
	productos332 ;
)33; <
;33< =
return44 
RedirectToAction44 #
(44# $
$str44$ +
)44+ ,
;44, -
}55 	
[77 	
HttpGet77	 
]77 
public88 
IActionResult88 
EditarProducto88 +
(88+ ,
int88, /
Id880 2
)882 3
{99 	
int:: 
IdRol:: 
=:: 
GetLoggedUser:: %
(::% &
)::& '
.::' (
IdRol::( -
;::- .
if;; 
(;; 
IdRol;; 
!=;; 
$num;; 
);; 
{<< 
return== 
RedirectToAction== '
(==' (
$str==( /
,==/ 0
$str==1 <
)==< =
;=== >
}>> 
var?? 
Producto?? 
=?? !
productosRepositorios?? 0
.??0 1
obtenerProducto??1 @
(??@ A
Id??A C
)??C D
;??D E
return@@ 
View@@ 
(@@ 
Producto@@  
)@@  !
;@@! "
}AA 	
[BB 	
HttpPostBB	 
]BB 
publicCC 
IActionResultCC 
EditarProductoCC +
(CC+ ,
intCC, /
IdCC0 2
,CC2 3
	ProductosCC4 =
	productosCC> G
)CCG H
{DD 	!
productosRepositoriosLL !
.LL! "
editarProductoLL" 0
(LL0 1
IdLL1 3
,LL3 4
	productosLL5 >
)LL> ?
;LL? @
returnMM 
RedirectToActionMM #
(MM# $
$strMM$ +
)MM+ ,
;MM, -
}NN 	
[PP 	
HttpGetPP	 
]PP 
publicQQ 
IActionResultQQ  
AgregarTama√±oPrecioQQ 0
(QQ0 1
intQQ1 4
IdQQ5 7
)QQ7 8
{RR 	
intSS 
IdRolSS 
=SS 
GetLoggedUserSS %
(SS% &
)SS& '
.SS' (
IdRolSS( -
;SS- .
ifTT 
(TT 
IdRolTT 
!=TT 
$numTT 
)TT 
{UU 
returnVV 
RedirectToActionVV '
(VV' (
$strVV( /
,VV/ 0
$strVV1 <
)VV< =
;VV= >
}WW 
varXX 
ProductoXX 
=XX !
productosRepositoriosXX 0
.XX0 1
obtenerProductoXX1 @
(XX@ A
IdXXA C
)XXC D
;XXD E
returnYY 
ViewYY 
(YY 
ProductoYY  
)YY  !
;YY! "
}ZZ 	
[[[ 	
HttpPost[[	 
][[ 
public\\ 
IActionResult\\  
AgregarTama√±oPrecio\\ 0
(\\0 1
int\\1 4
Id\\5 7
,\\7 8
Tama√±oPrecio\\9 E
tama√±oPrecio\\F R
)\\R S
{]] 	
if^^ 
(^^ 
tama√±oPrecio^^ 
.^^ 
Tama√±oProducto^^ +
==^^, .
null^^/ 3
||^^4 6
tama√±oPrecio^^7 C
.^^C D
Tama√±oProducto^^D R
==^^S U
$str^^V X
)^^X Y
{__ 
var`` 
Producto`` 
=`` !
productosRepositorios`` 4
.``4 5
obtenerProducto``5 D
(``D E
Id``E G
)``G H
;``H I

ModelStateaa 
.aa 
AddModelErroraa (
(aa( )
$straa) 2
,aa2 3
$straa4 G
)aaG H
;aaH I
returnbb 
Viewbb 
(bb 
$strbb 1
,bb1 2
Productobb3 ;
)bb; <
;bb< =
}cc 
ifdd 
(dd 
tama√±oPreciodd 
.dd 
Preciodd #
<=dd$ &
$numdd' (
)dd( )
{ee 
varff 
Productoff 
=ff !
productosRepositoriosff 4
.ff4 5
obtenerProductoff5 D
(ffD E
IdffE G
)ffG H
;ffH I

ModelStategg 
.gg 
AddModelErrorgg (
(gg( )
$strgg) 2
,gg2 3
$strgg4 G
)ggG H
;ggH I
returnhh 
Viewhh 
(hh 
$strhh 1
,hh1 2
Productohh3 ;
)hh; <
;hh< =
}ii !
productosRepositoriosjj !
.jj! " 
AgregarTama√±oPreciojj" 5
(jj5 6
Idjj6 8
,jj8 9
tama√±oPreciojj: F
)jjF G
;jjG H
returnkk 
RedirectToActionkk #
(kk# $
$strkk$ +
)kk+ ,
;kk, -
}ll 	
[nn 	
HttpGetnn	 
]nn 
publicoo 
IActionResultoo 
EditarTama√±oPreciooo /
(oo/ 0
intoo0 3
Idoo4 6
)oo6 7
{pp 	
intqq 
IdRolqq 
=qq 
GetLoggedUserqq %
(qq% &
)qq& '
.qq' (
IdRolqq( -
;qq- .
ifrr 
(rr 
IdRolrr 
!=rr 
$numrr 
)rr 
{ss 
returntt 
RedirectToActiontt '
(tt' (
$strtt( /
,tt/ 0
$strtt1 <
)tt< =
;tt= >
}uu 
Tama√±oPreciovv 
tama√±oPreciovv %
=vv& '!
productosRepositoriosvv( =
.vv= > 
obtenerTama√±oPreciovv> Q
(vvQ R
IdvvR T
)vvT U
;vvU V
ViewBagww 
.ww 
Productoww 
=ww !
productosRepositoriosww 4
.ww4 5
obtenerProductoIdww5 F
(wwF G
tama√±oPreciowwG S
.wwS T

IdProductowwT ^
)ww^ _
;ww_ `
returnxx 
Viewxx 
(xx 
tama√±oPrecioxx $
)xx$ %
;xx% &
}yy 	
[zz 	
HttpPostzz	 
]zz 
public{{ 
IActionResult{{ 
EditarTama√±oPrecio{{ /
({{/ 0
int{{0 3
Id{{4 6
,{{6 7
Tama√±oPrecio{{8 D
tama√±oPrecio{{E Q
){{Q R
{|| 	
if
ÉÉ 
(
ÉÉ 
tama√±oPrecio
ÉÉ 
.
ÉÉ 
Precio
ÉÉ #
<
ÉÉ$ %
$num
ÉÉ& '
)
ÉÉ' (
{
ÑÑ 
Tama√±oPrecio
ÖÖ 
tama√±oPrecioo
ÖÖ *
=
ÖÖ+ ,#
productosRepositorios
ÖÖ- B
.
ÖÖB C"
obtenerTama√±oPrecio
ÖÖC V
(
ÖÖV W
Id
ÖÖW Y
)
ÖÖY Z
;
ÖÖZ [
ViewBag
ÜÜ 
.
ÜÜ 
Producto
ÜÜ  
=
ÜÜ! "#
productosRepositorios
ÜÜ# 8
.
ÜÜ8 9
obtenerProductoId
ÜÜ9 J
(
ÜÜJ K
tama√±oPrecioo
ÜÜK X
.
ÜÜX Y

IdProducto
ÜÜY c
)
ÜÜc d
;
ÜÜd e
return
áá 
View
áá 
(
áá 
$str
áá 0
,
áá0 1
tama√±oPrecio
áá2 >
)
áá> ?
;
áá? @
}
àà #
productosRepositorios
ââ !
.
ââ! "
editarTama√±o
ââ" .
(
ââ. /
Id
ââ/ 1
,
ââ1 2
tama√±oPrecio
ââ3 ?
.
ââ? @
Tama√±oProducto
ââ@ N
,
ââN O
tama√±oPrecio
ââP \
.
ââ\ ]
Precio
ââ] c
)
ââc d
;
ââd e
return
ää 
RedirectToAction
ää #
(
ää# $
$str
ää$ +
)
ää+ ,
;
ää, -
}
ãã 	
public
åå 
IActionResult
åå #
EliminarTama√±oPrecio
åå 1
(
åå1 2
int
åå2 5
Id
åå6 8
)
åå8 9
{
çç 	#
productosRepositorios
éé !
.
éé! "#
eliminarTama√±oPrecio
éé" 6
(
éé6 7
Id
éé7 9
)
éé9 :
;
éé: ;
return
èè 
RedirectToAction
èè #
(
èè# $
$str
èè$ +
)
èè+ ,
;
èè, -
}
êê 	
private
íí 
Usuario
íí 
GetLoggedUser
íí %
(
íí% &
)
íí& '
{
ìì 	
var
îî 
claim
îî 
=
îî 
HttpContext
îî #
.
îî# $
User
îî$ (
.
îî( )
Claims
îî) /
.
îî/ 0
First
îî0 5
(
îî5 6
)
îî6 7
;
îî7 8
string
ïï 
username
ïï 
=
ïï 
claim
ïï #
.
ïï# $
Value
ïï$ )
;
ïï) *
return
ññ #
productosRepositorios
ññ (
.
ññ( )
obtenerUsuario
ññ) 7
(
ññ7 8
username
ññ8 @
)
ññ@ A
;
ññA B
}
óó 	
}
òò 
}ôô à)
UD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\RegisterAdminController.cs
	namespace

 	
Maxdel


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
public 

class #
RegisterAdminController (
:) *

Controller+ 5
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly %
IRegisterAdminRepositorio 2$
registerAdminRepositorio3 K
;K L
public #
RegisterAdminController &
(& '

DbEntities' 1

dbEntities2 <
,< =%
IRegisterAdminRepositorio> W$
registerAdminRepositorioX p
)p q
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. $
registerAdminRepositorio )
=* +$
registerAdminRepositorio, D
;D E
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Register %
(% &
)& '
{ 	
int 
IdRol 
= 
GetLoggedUser %
(% &
)& '
.' (
IdRol( -
;- .
if 
( 
IdRol 
!= 
$num 
) 
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 <
)< =
;= >
} 
ViewBag   
.   
PreguntasSeguridad   &
=  ' ($
registerAdminRepositorio  ) A
.  A B
listarPreguntas  B Q
(  Q R
)  R S
;  S T
return!! 
View!! 
(!! 
)!! 
;!! 
}"" 	
[$$ 	
HttpPost$$	 
]$$ 
public%% 
IActionResult%% 
Register%% %
(%%% &'
AgregarAdminClaseIntermedia%%& A
account%%B I
)%%I J
{&& 	
if'' 
('' 

ModelState'' 
.'' 
IsValid'' "
)''" #
{(( 
account)) 
.)) 
Contrase√±a)) "
=))# $
Convertirsha256))% 4
())4 5
account))5 <
.))< =
Contrase√±a))= G
)))G H
;))H I$
registerAdminRepositorio** (
.**( )
guardarUser**) 4
(**4 5
account**5 <
)**< =
;**= >
return++ 
RedirectToAction++ '
(++' (
$str++( /
,++/ 0
$str++0 ;
)++; <
;++< =
},, 
ViewBag-- 
.-- 
PreguntasSeguridad-- &
=--' ($
registerAdminRepositorio--) A
.--A B
listarPreguntas--B Q
(--Q R
)--R S
;--S T
return.. 
View.. 
(.. 
$str.. "
).." #
;..# $
}// 	
public11 
static11 
string11 
Convertirsha25611 ,
(11, -
string11- 3
texto114 9
)119 :
{22 	
StringBuilder33 
Sb33 
=33 
new33 "
StringBuilder33# 0
(330 1
)331 2
;332 3
using44 
(44 
SHA25644 
hash44 
=44  
SHA256Managed44! .
.44. /
Create44/ 5
(445 6
)446 7
)447 8
{55 
Encoding66 
enc66 
=66 
Encoding66 '
.66' (
UTF866( ,
;66, -
byte77 
[77 
]77 
result77 
=77 
hash77  $
.77$ %
ComputeHash77% 0
(770 1
enc771 4
.774 5
GetBytes775 =
(77= >
texto77> C
)77C D
)77D E
;77E F
foreach88 
(88 
byte88 
b88 
in88  "
result88# )
)88) *
Sb99 
.99 
Append99 
(99 
b99 
.99  
ToString99  (
(99( )
$str99) -
)99- .
)99. /
;99/ 0
};; 
return== 
Sb== 
.== 
ToString== 
(== 
)==  
;==  !
}>> 	
private@@ 
Usuario@@ 
GetLoggedUser@@ %
(@@% &
)@@& '
{AA 	
varBB 
claimBB 
=BB 
HttpContextBB #
.BB# $
UserBB$ (
.BB( )
ClaimsBB) /
.BB/ 0
FirstBB0 5
(BB5 6
)BB6 7
;BB7 8
stringCC 
usernameCC 
=CC 
claimCC #
.CC# $
ValueCC$ )
;CC) *
returnDD $
registerAdminRepositorioDD +
.DD+ ,
obtenerUsuarioDD, :
(DD: ;
usernameDD; C
)DDC D
;DDD E
}EE 	
}FF 
}GG Ω
PD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\TrackingController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public		 

class		 
TrackingController		 #
:		$ %

Controller		& 0
{

 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly  
ITrackingRepositorio -
trackingRepositorio. A
;A B
public 
TrackingController !
(! "

DbEntities" ,

dbEntities- 7
,7 8 
ITrackingRepositorio9 M
trackingRepositorioN a
)a b
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
trackingRepositorio $
=% &
trackingRepositorio' :
;: ;
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Estado #
(# $
string$ *
CodTracking+ 6
)6 7
{ 	
if 
( 
CodTracking 
== 
null "
||# %
CodTracking& 1
==2 4
$str5 7
)7 8
{ 
return 
View 
( 
$str #
)# $
;$ %
} 
var 
detallePedido 
= 
trackingRepositorio  3
.3 4
obtenerEstado4 A
(A B
CodTrackingB M
)M N
;N O
ViewBag 
. 
CodTracking 
=  !
CodTracking" -
;- .
if   
(   
detallePedido   
!=   
null    $
)  $ %
{!! 
switch"" 
("" 
detallePedido"" %
.""% &
Pedido""& ,
."", -
Estado""- 3
)""3 4
{## 
case$$ 
$num$$ 
:$$ 
ViewBag$$ #
.$$# $
Estado$$$ *
=$$+ ,
$str$$- n
;$$n o
break$$p u
;$$u v
case%% 
$num%% 
:%% 
ViewBag%% #
.%%# $
Estado%%$ *
=%%+ ,
$str%%- q
;%%q r
break%%s x
;%%x y
case&& 
$num&& 
:&& 
ViewBag&& #
.&&# $
Estado&&$ *
=&&+ ,
$str&&- q
;&&q r
break&&s x
;&&x y
case'' 
$num'' 
:'' 
ViewBag'' #
.''# $
Estado''$ *
=''+ ,
$str''- S
;''S T
break''U Z
;''Z [
case(( 
$num(( 
:(( 
ViewBag(( #
.((# $
Estado(($ *
=((+ ,
$str((- I
;((I J
break((K P
;((P Q
})) 
}** 
else++ 
{,, 
ViewBag-- 
.-- 
Estado-- 
=--  
$str--! ?
;--? @
}.. 
return// 
View// 
(// 
)// 
;// 
}00 	
}11 
}22 ƒô
ND:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\VenderController.cs
	namespace		 	
Maxdel		
 
.		 
Controllers		 
{

 
[ 
	Authorize 
] 
public 

class 
VenderController !
:" #

Controller$ .
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly 
IVenderRepositorio +
venderRepositorio, =
;= >
public 
static 
List 
< 
Pedido !
>! "
?" #
Pedidos$ +
=, -
new. 1
List2 6
<6 7
Pedido7 =
>= >
(> ?
)? @
;@ A
public 
static 
List 
< 
DetallePedido (
>( )
?) *
DetallePedidos+ 9
=: ;
new< ?
List@ D
<D E
DetallePedidoE R
>R S
(S T
)T U
;U V
public 
static 
int 
cantPedidos %
=& '
$num( )
;) *
public 
static 
int 
cont 
=  
$num! "
;" #
public 
VenderController 
(  

DbEntities  *

dbEntities+ 5
,5 6
IVenderRepositorio7 I
venderRepositorioJ [
)[ \
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
venderRepositorio "
=# $
venderRepositorio% 6
;6 7
} 	
public 
IActionResult 
Index "
(" #
string# )
buscar* 0
)0 1
{ 	
int 
IdRol 
= 
GetLoggedUser %
(% &
)& '
.' (
IdRol( -
;- .
if   
(   
IdRol   
!=   
$num   
)   
{!! 
return"" 
RedirectToAction"" '
(""' (
$str""( /
,""/ 0
$str""1 <
)""< =
;""= >
}## 
var$$ 
ListaProductos$$ 
=$$  
venderRepositorio$$! 2
.$$2 3
obtenerProductos$$3 C
($$C D
)$$D E
;$$E F
if&& 
(&& 
buscar&& 
!=&& 
null&& 
&&&& !
buscar&&" (
!=&&) +
$str&&, .
)&&. /
{'' 
ListaProductos(( 
=((  
ListaProductos((! /
.((/ 0
Where((0 5
(((5 6
o((6 7
=>((8 :
o((; <
.((< =
Nombre((= C
.((C D
Contains((D L
(((L M
buscar((M S
,((S T
StringComparison((U e
.((e f
OrdinalIgnoreCase((f w
)((w x
||((y {
o((| }
.((} ~
Descripcion	((~ â
.
((â ä
Contains
((ä í
(
((í ì
buscar
((ì ô
,
((ô ö
StringComparison
((õ ´
.
((´ ¨
OrdinalIgnoreCase
((¨ Ω
)
((Ω æ
)
((æ ø
.
((ø ¿
OrderBy
((¿ «
(
((« »
o
((» …
=>
((  Ã
o
((Õ Œ
.
((Œ œ
Nombre
((œ ’
)
((’ ÷
.
((÷ ◊
ToList
((◊ ›
(
((› ﬁ
)
((ﬁ ﬂ
;
((ﬂ ‡
})) 
ViewBag** 
.** 
Buscar** 
=** 
buscar** #
;**# $
var,, 
	productos,, 
=,, 
new,, 
List,,  $
<,,$ %
	Productos,,% .
>,,. /
(,,/ 0
),,0 1
;,,1 2
var.. 
ids.. 
=.. 
new.. 
List.. 
<.. 
int.. "
>.." #
(..# $
)..$ %
;..% &
foreach00 
(00 
var00 
item00 
in00 
DetallePedidos00  .
)00. /
{11 
ids22 
.22 
Add22 
(22 
item22 
.22 
Id22 
)22  
;22  !
var33 
detalle33 
=33 
venderRepositorio33 /
.33/ 0
obtenerProducto330 ?
(33? @
item33@ D
.33D E

IdProducto33E O
)33O P
;33P Q
	productos44 
.44 
Add44 
(44 
detalle44 %
)44% &
;44& '
}55 
ViewBag77 
.77 
	productos77 
=77 
	productos77  )
;77) *
ViewBag99 
.99 
Cesta99 
=99 
DetallePedidos99 *
.99* +
ToList99+ 1
(991 2
)992 3
;993 4
ViewBag;; 
.;; 
ids;; 
=;; 
ids;; 
;;; 
ViewBag== 
.== 
Monto== 
=== 
obtenerMonto== (
(==( )
)==) *
;==* +
return?? 
View?? 
(?? 
ListaProductos?? &
)??& '
;??' (
}@@ 	
publicBB 
decimalBB 
obtenerMontoBB #
(BB# $
)BB$ %
{CC 	
decimalDD 
montoDD 
=DD 
$numDD 
;DD 
foreachFF 
(FF 
varFF 
itemFF 
inFF  
DetallePedidosFF! /
)FF/ 0
{GG 
montoHH 
+=HH 
itemHH 
.HH 
precioHH $
*HH% &
itemHH' +
.HH+ ,
CantidadHH, 4
;HH4 5
}II 
returnKK 
montoKK 
;KK 
}LL 	
publicNN 
IActionResultNN 
AgregarPedidoNN *
(NN* +
intNN+ .

IdProductoNN/ 9
,NN9 :
intNN; >
IdTama√±oPrecioNN? M
,NNM N
intNNO R
CantidadNNS [
)NN[ \
{OO 	
intPP 
IdRolPP 
=PP 
GetLoggedUserPP %
(PP% &
)PP& '
.PP' (
IdRolPP( -
;PP- .
ifQQ 
(QQ 
IdRolQQ 
!=QQ 
$numQQ 
)QQ 
{RR 
returnSS 
RedirectToActionSS '
(SS' (
$strSS( /
,SS/ 0
$strSS1 <
)SS< =
;SS= >
}TT 
ifUU 
(UU 
IdTama√±oPrecioUU 
==UU !
nullUU" &
||UU' )
CantidadUU* 2
==UU3 5
nullUU6 :
||UU; =
IdTama√±oPrecioUU> L
==UUM O
$numUUP Q
||UUR T
CantidadUUU ]
==UU^ `
$numUUa b
)UUb c
{VV 
returnWW 
RedirectToActionWW '
(WW' (
$strWW( /
)WW/ 0
;WW0 1
}XX 
PedidoYY 
pedidoYY 
=YY 
newYY 
PedidoYY  &
(YY& '
)YY' (
;YY( )
DetallePedidoZZ 
detallePedidoZZ '
=ZZ( )
newZZ* -
DetallePedidoZZ. ;
(ZZ; <
)ZZ< =
;ZZ= >
cantPedidos[[ 
=[[ 
venderRepositorio[[ +
.[[+ ,
obtenerUltimoId[[, ;
([[; <
)[[< =
;[[= >
int\\ 
aux\\ 
=\\ 
$num\\ 
;\\ 
if]] 
(]] 
Pedidos]] 
.]] 
Count]] 
==]] 
$num]]  !
)]]! "
{^^ 
aux__ 
=__ 
$num__ 
;__ 
}`` 
elseaa 
auxaa 
=aa 
Pedidosaa 
.aa 
Countaa $
(aa$ %
)aa% &
+aa' (
$numaa) *
;aa* +
cantPedidosbb 
+=bb 
auxbb 
;bb 
pedidocc 
.cc 
Idcc 
=cc 
contcc 
;cc 
pedidodd 
.dd 
	IdUsuariodd 
=dd 
$numdd  
;dd  !
pedidoee 
.ee 
Estadoee 
=ee 
$numee 
;ee 
pedidoff 
.ff 
Destinoff 
=ff 
$strff %
;ff% &
detallePedidohh 
.hh 
Idhh 
=hh 
conthh #
;hh# $
contii 
++ii 
;ii 
detallePedidojj 
.jj 

IdProductojj $
=jj% &

IdProductojj' 1
;jj1 2
detallePedidokk 
.kk 
IdPedidokk "
=kk# $
cantPedidoskk% 0
;kk0 1
detallePedidoll 
.ll 
IdTama√±oPrecioll (
=ll) *
IdTama√±oPrecioll+ 9
;ll9 :
detallePedidomm 
.mm 
Cantidadmm "
=mm# $
Cantidadmm% -
;mm- .
Tama√±oPrecionn 
tama√±oPrecionn %
=nn& '
venderRepositorionn( 9
.nn9 :
obtenerDetallenn: H
(nnH I
detallePedidonnI V
.nnV W
IdTama√±oPrecionnW e
)nne f
;nnf g
detallePedidooo 
.oo 
Tama√±oProductooo (
=oo) *
tama√±oPreciooo+ 7
.oo7 8
Tama√±oProductooo8 F
;ooF G
detallePedidopp 
.pp 
preciopp  
=pp! "
tama√±oPreciopp# /
.pp/ 0
Preciopp0 6
;pp6 7
DetallePedidosqq 
.qq 
Addqq 
(qq 
detallePedidoqq ,
)qq, -
;qq- .
pedidoss 
.ss 
Montoss 
=ss 
Cantidadss #
*ss$ %
tama√±oPrecioss& 2
.ss2 3
Precioss3 9
;ss9 :
Pedidostt 
.tt 
Addtt 
(tt 
pedidott 
)tt 
;tt  
returnuu 
RedirectToActionuu #
(uu# $
$struu$ +
)uu+ ,
;uu, -
}vv 	
publicxx 
IActionResultxx 
EliminarPedidoxx +
(xx+ ,
intxx, /
Idxx0 2
)xx2 3
{yy 	
DetallePedidoszz 
.zz 
Removezz !
(zz! "
DetallePedidoszz" 0
[zz0 1
Idzz1 3
]zz3 4
)zz4 5
;zz5 6
Pedidos{{ 
.{{ 
Remove{{ 
({{ 
Pedidos{{ "
[{{" #
Id{{# %
]{{% &
){{& '
;{{' (
return|| 
RedirectToAction|| #
(||# $
$str||$ +
)||+ ,
;||, -
}}} 	
public 
IActionResult 
Limpiar $
($ %
)% &
{
ÄÄ 	
DetallePedidos
ÅÅ 
.
ÅÅ 
Clear
ÅÅ  
(
ÅÅ  !
)
ÅÅ! "
;
ÅÅ" #
Pedidos
ÇÇ 
.
ÇÇ 
Clear
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
cont
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
return
ÑÑ 
RedirectToAction
ÑÑ #
(
ÑÑ# $
$str
ÑÑ$ +
)
ÑÑ+ ,
;
ÑÑ, -
}
ÖÖ 	
public
áá 
IActionResult
áá 
Comprar
áá $
(
áá$ %$
ClienteClaseIntermedia
áá% ;
cliente
áá< C
)
ááC D
{
àà 	
int
ââ 
IdRol
ââ 
=
ââ 
GetLoggedUser
ââ %
(
ââ% &
)
ââ& '
.
ââ' (
IdRol
ââ( -
;
ââ- .
if
ää 
(
ää 
IdRol
ää 
!=
ää 
$num
ää 
)
ää 
{
ãã 
return
åå 
RedirectToAction
åå '
(
åå' (
$str
åå( /
,
åå/ 0
$str
åå1 <
)
åå< =
;
åå= >
}
çç 
if
éé 
(
éé 
!
éé 

ModelState
éé 
.
éé 
IsValid
éé #
)
éé# $
{
èè 

ModelState
êê 
.
êê 
AddModelError
êê (
(
êê( )
$str
êê) 2
,
êê2 3
$str
êê4 `
)
êê` a
;
êêa b

ModelState
ëë 
.
ëë 
AddModelError
ëë (
(
ëë( )
$str
ëë) 0
,
ëë0 1
$str
ëë2 ^
)
ëë^ _
;
ëë_ `
return
íí 
RedirectToAction
íí '
(
íí' (
$str
íí( /
)
íí/ 0
;
íí0 1
}
ìì 
if
îî 
(
îî 
DetallePedidos
îî 
.
îî 
Count
îî $
==
îî% '
$num
îî( )
||
îî* ,
Pedidos
îî- 4
.
îî4 5
Count
îî5 :
==
îî; =
$num
îî> ?
)
îî? @
{
ïï 

ModelState
ññ 
.
ññ 
AddModelError
ññ (
(
ññ( )
$str
ññ) 0
,
ññ0 1
$str
ññ2 ^
)
ññ^ _
;
ññ_ `
return
óó 
RedirectToAction
óó '
(
óó' (
$str
óó( /
)
óó/ 0
;
óó0 1
}
òò 
venderRepositorio
öö 
.
öö 
agregarUsuario
öö ,
(
öö, -
cliente
öö- 4
)
öö4 5
;
öö5 6
int
úú 
idUser
úú 
=
úú 
venderRepositorio
úú *
.
úú* +!
obtenerUltimoIdUser
úú+ >
(
úú> ?
)
úú? @
;
úú@ A
int
ûû 
IdBoleta
ûû 
=
ûû 
generarNroBoleta
ûû +
(
ûû+ ,
cliente
ûû, 3
.
ûû3 4
	Direccion
ûû4 =
)
ûû= >
;
ûû> ?
for
üü 
(
üü 
int
üü 
i
üü 
=
üü 
$num
üü 
;
üü 
i
üü 
<
üü 
Pedidos
üü  '
.
üü' (
Count
üü( -
;
üü- .
i
üü/ 0
++
üü0 2
)
üü2 3
{
†† 
Pedidos
°° 
[
°° 
i
°° 
]
°° 
.
°° 
Id
°° 
=
°° 
$num
°°  !
;
°°! "
DetallePedidos
¢¢ 
[
¢¢ 
i
¢¢  
]
¢¢  !
.
¢¢! "
Id
¢¢" $
=
¢¢% &
$num
¢¢' (
;
¢¢( )
Pedidos
££ 
[
££ 
i
££ 
]
££ 
.
££ 
	IdUsuario
££ $
=
££% &
idUser
££' -
;
££- .
Pedidos
§§ 
[
§§ 
i
§§ 
]
§§ 
.
§§ 
Estado
§§ !
=
§§" #
$num
§§$ %
;
§§% &
Pedidos
•• 
[
•• 
i
•• 
]
•• 
.
•• 
IdBoleta
•• #
=
••$ %
IdBoleta
••& .
;
••. /
}
¶¶ 
venderRepositorio
®® 
.
®® 
agregarDatosBd
®® ,
(
®®, -
Pedidos
®®- 4
,
®®4 5
DetallePedidos
®®6 D
)
®®D E
;
®®E F
DetallePedidos
™™ 
.
™™ 
Clear
™™  
(
™™  !
)
™™! "
;
™™" #
Pedidos
´´ 
.
´´ 
Clear
´´ 
(
´´ 
)
´´ 
;
´´ 
return
≠≠ 
RedirectToAction
≠≠ #
(
≠≠# $
$str
≠≠$ +
)
≠≠+ ,
;
≠≠, -
}
ÆÆ 	
private
∞∞ 
int
∞∞ 
generarNroBoleta
∞∞ $
(
∞∞$ %
string
∞∞% +
destino
∞∞, 3
)
∞∞3 4
{
±± 	
string
≤≤ 
	nroBoleta
≤≤ 
=
≤≤ 
$str
≤≤ %
;
≤≤% &
int
≥≥ 
aux2
≥≥ 
;
≥≥ 
int
¥¥ 
nroTemp
¥¥ 
=
¥¥ 
venderRepositorio
¥¥ +
.
¥¥+ ,
contarBoletas
¥¥, 9
(
¥¥9 :
)
¥¥: ;
;
¥¥; <
nroTemp
µµ 
++
µµ 
;
µµ 
string
∂∂ 
aux
∂∂ 
=
∂∂ 
nroTemp
∂∂  
.
∂∂  !
ToString
∂∂! )
(
∂∂) *
)
∂∂* +
;
∂∂+ ,
nroTemp
∑∑ 
=
∑∑ 
aux
∑∑ 
.
∑∑ 
Length
∑∑  
;
∑∑  !
nroTemp
∏∏ 
=
∏∏ 
$num
∏∏ 
-
∏∏ 
nroTemp
∏∏ !
;
∏∏! "
for
ππ 
(
ππ 
int
ππ 
i
ππ 
=
ππ 
$num
ππ 
;
ππ 
i
ππ 
<
ππ 
nroTemp
ππ  '
;
ππ' (
i
ππ) *
++
ππ* ,
)
ππ, -
{
∫∫ 
	nroBoleta
ªª 
+=
ªª 
$str
ªª  
;
ªª  !
}
ºº 
	nroBoleta
ΩΩ 
+=
ΩΩ 
aux
ΩΩ 
;
ΩΩ 
DateTime
øø 
fecha
øø 
=
øø 
DateTime
øø %
.
øø% &
Now
øø& )
;
øø) *
int
¡¡ 
Id
¡¡ 
=
¡¡ 
venderRepositorio
¡¡ &
.
¡¡& '!
obtenerUltimoIdUser
¡¡' :
(
¡¡: ;
)
¡¡; <
;
¡¡< =
Boleta
√√ 
boleta
√√ 
=
√√ 
new
√√ 
Boleta
√√  &
(
√√& '
)
√√' (
;
√√( )
boleta
ƒƒ 
.
ƒƒ 
Fecha
ƒƒ 
=
ƒƒ 
fecha
ƒƒ  
;
ƒƒ  !
boleta
≈≈ 
.
≈≈ 
	NroBoleta
≈≈ 
=
≈≈ 
	nroBoleta
≈≈ (
;
≈≈( )
boleta
∆∆ 
.
∆∆ 

MontoTotal
∆∆ 
=
∆∆ 
obtenerMonto
∆∆  ,
(
∆∆, -
)
∆∆- .
;
∆∆. /
boleta
«« 
.
«« 
	Direccion
«« 
=
«« 
destino
«« &
;
««& '
boleta
»» 
.
»» 
	IdUsuario
»» 
=
»» 
Id
»» !
;
»»! "
venderRepositorio
   
.
   
agregarBoleta
   +
(
  + ,
boleta
  , 2
)
  2 3
;
  3 4
aux2
ÃÃ 
=
ÃÃ 
venderRepositorio
ÃÃ $
.
ÃÃ$ %#
obtenerUltimoIdBoleta
ÃÃ% :
(
ÃÃ: ;
)
ÃÃ; <
;
ÃÃ< =
return
ŒŒ 
aux2
ŒŒ 
;
ŒŒ 
}
œœ 	
private
–– 
Usuario
–– 
GetLoggedUser
–– %
(
––% &
)
––& '
{
—— 	
var
““ 
claim
““ 
=
““ 
HttpContext
““ #
.
““# $
User
““$ (
.
““( )
Claims
““) /
.
““/ 0
First
““0 5
(
““5 6
)
““6 7
;
““7 8
string
”” 
username
”” 
=
”” 
claim
”” #
.
””# $
Value
””$ )
;
””) *
return
‘‘ 
venderRepositorio
‘‘ $
.
‘‘$ %
obtenerUsuario
‘‘% 3
(
‘‘3 4
username
‘‘4 <
)
‘‘< =
;
‘‘= >
}
’’ 	
}
÷÷ 
}◊◊ •
ND:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\VentasController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
[

 
	Authorize

 
]

 
public 

class 
VentasController !
:" #

Controller$ .
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
private 
readonly 
IVentasRepositorio +
ventasRepositorio, =
;= >
public 
VentasController 
(  

DbEntities  *

dbEntities+ 5
,5 6
IVentasRepositorio7 I
ventasRepositorioJ [
)[ \
{ 	
_dbEntities 
= 

dbEntities $
;$ %
this 
. 
ventasRepositorio "
=# $
ventasRepositorio% 6
;6 7
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
IdRol 
= 
GetLoggedUser %
(% &
)& '
.' (
IdRol( -
;- .
if 
( 
IdRol 
!= 
$num 
) 
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 <
)< =
;= >
} 
var 
boletas 
= 
ventasRepositorio +
.+ ,
listarBoletas, 9
(9 :
): ;
;; <
decimal 
subtotal 
= 
$num  
;  !
foreach!! 
(!! 
var!! 
item!! 
in!!  
boletas!!! (
)!!( )
{"" 
subtotal## 
+=## 
item##  
.##  !

MontoTotal##! +
;##+ ,
}$$ 
ViewBag&& 
.&& 
Subtotal&& 
=&& 
subtotal&& '
;&&' (
return(( 
View(( 
((( 
boletas(( 
)((  
;((  !
})) 	
private++ 
Usuario++ 
GetLoggedUser++ %
(++% &
)++& '
{,, 	
var-- 
claim-- 
=-- 
HttpContext-- #
.--# $
User--$ (
.--( )
Claims--) /
.--/ 0
First--0 5
(--5 6
)--6 7
;--7 8
string.. 
username.. 
=.. 
claim.. #
...# $
Value..$ )
;..) *
return// 
ventasRepositorio// $
.//$ %
obtenerUsuario//% 3
(//3 4
username//4 <
)//< =
;//= >
}00 	
}11 
}22 ˆ*
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\DbEntities.cs
	namespace 	
Maxdel
 
. 
DB 
{ 
public 

class 

DbEntities 
: 
	DbContext '
{		 
public

 
DbSet

 
<

 
	Productos

 
>

 
	Productos

  )
{

* +
get

, /
;

/ 0
set

1 4
;

4 5
}

6 7
public 
DbSet 
< 
DetallePedido "
>" #
detallePedidos$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
DbSet 
< 
Pedido 
> 
pedidos $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Usuario 
> 
usuarios &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Tama√±oPrecio !
>! "
tama√±oPrecios# 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
DbSet 
< 
Roles 
> 
tipos !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DbSet 
< 
Direcciones  
>  !
direcciones" -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Estado 
> 
estado #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DbSet 
< 
NroTracking  
>  !
nroTrackings" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Boleta 
> 
boletas $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
PreguntaSeguridad &
>& '
preguntaSeguridads( :
{; <
get= @
;@ A
setB E
;E F
}G H
public 

DbEntities 
( 
) 
{ 
} 
public 

DbEntities 
( 
DbContextOptions *
<* +

DbEntities+ 5
>5 6
options7 >
)> ?
:? @
baseA E
(E F
optionsF M
)M N
{O P
}Q R
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
ProductosMapping0 @
(@ A
)A B
)B C
;C D
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, / 
DetallePedidoMapping0 D
(D E
)E F
)F G
;G H
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
PedidoMapping0 =
(= >
)> ?
)? @
;@ A
modelBuilder   
.   
ApplyConfiguration   +
(  + ,
new  , /
UsuarioMapping  0 >
(  > ?
)  ? @
)  @ A
;  A B
modelBuilder!! 
.!! 
ApplyConfiguration!! +
(!!+ ,
new!!, /
EstadoMapping!!0 =
(!!= >
)!!> ?
)!!? @
;!!@ A
modelBuilder"" 
."" 
ApplyConfiguration"" +
(""+ ,
new"", / 
Tama√±oPrecioMapping""0 C
(""C D
)""D E
)""E F
;""F G
modelBuilder## 
.## 
ApplyConfiguration## +
(##+ ,
new##, /
RolesMapping##0 <
(##< =
)##= >
)##> ?
;##? @
modelBuilder$$ 
.$$ 
ApplyConfiguration$$ +
($$+ ,
new$$, /
DireccionesMapping$$0 B
($$B C
)$$C D
)$$D E
;$$E F
modelBuilder%% 
.%% 
ApplyConfiguration%% +
(%%+ ,
new%%, /
NroTrackingMapping%%0 B
(%%B C
)%%C D
)%%D E
;%%E F
modelBuilder&& 
.&& 
ApplyConfiguration&& +
(&&+ ,
new&&, /
BoletaMapping&&0 =
(&&= >
)&&> ?
)&&? @
;&&@ A
modelBuilder'' 
.'' 
ApplyConfiguration'' +
(''+ ,
new'', /$
PreguntaSeguridadMapping''0 H
(''H I
)''I J
)''J K
;''K L
}(( 	
})) 
}** ´
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\BoletaMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
BoletaMapping 
:  $
IEntityTypeConfiguration! 9
<9 :
Boleta: @
>@ A
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Boleta		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
o 
=> 
o  
.  !
Boletas! (
)( )
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
} 	
} 
} Ü
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\DetallePedidoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class  
DetallePedidoMapping %
:% &$
IEntityTypeConfiguration' ?
<? @
DetallePedido@ M
>M N
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
DetallePedido		0 =
>		= >
builder		? F
)		F G
{

 	
builder 
. 
ToTable 
( 
$str +
,+ ,
$str- 2
)2 3
;3 4
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Producto" *
)* +
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &

IdProducto& 0
)0 1
;1 2
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Pedido" (
)( )
. 
WithMany 
( 
o 
=> 
o  
.  !
DetallePedidos! /
)/ 0
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdPedido& .
). /
;/ 0
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
tama√±oPrecio" .
). /
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdTama√±oPrecio& 4
)4 5
;5 6
} 	
} 
} √
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\DireccionesMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
DireccionesMapping #
:$ %$
IEntityTypeConfiguration& >
<> ?
Direcciones? J
>J K
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Direcciones		0 ;
>		; <
builder		= D
)		D E
{

 	
builder 
. 
ToTable 
( 
$str )
,) *
$str+ 0
)0 1
;1 2
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
o 
=> 
o  
.  !
Direcciones! ,
), -
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
} 	
} 
} √
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\EstadoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
EstadoMapping 
: $
IEntityTypeConfiguration  8
<8 9
Estado9 ?
>? @
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Estado		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ◊
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\NroTrackingMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
NroTrackingMapping #
:$ %$
IEntityTypeConfiguration& >
<> ?
NroTracking? J
>J K
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
NroTracking		0 ;
>		; <
builder		= D
)		D E
{

 	
builder 
. 
ToTable 
( 
$str )
,) *
$str+ 0
)0 1
;1 2
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} •
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\PedidoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
PedidoMapping 
: $
IEntityTypeConfiguration  8
<8 9
Pedido9 ?
>? @
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Pedido		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
o 
=> 
o  
.  !
Pedidos! (
)( )
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
EstadoFK" *
)* +
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
Estado& ,
), -
;- .
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
boleta" (
)( )
. 
WithMany 
( 
o 
=> 
o  
.  !
Pedidos! (
)( )
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdBoleta& .
). /
;/ 0
} 	
} 
} Ô
UD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\PreguntaSeguridadMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class $
PreguntaSeguridadMapping )
:* +$
IEntityTypeConfiguration, D
<D E
PreguntaSeguridadE V
>V W
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
PreguntaSeguridad		0 A
>		A B
builder		C J
)		J K
{

 	
builder 
. 
ToTable 
( 
$str /
,/ 0
$str1 6
)6 7
;7 8
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} œ
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\ProductosMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
ProductosMapping !
:! "$
IEntityTypeConfiguration# ;
<; <
	Productos< E
>E F
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
	Productos		0 9
>		9 :
builder		; B
)		B C
{

 	
builder 
. 
ToTable 
( 
$str '
,' (
$str) .
). /
;/ 0
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ø
ID:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\RolesMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
RolesMapping 
: $
IEntityTypeConfiguration  8
<8 9
Roles9 >
>> ?
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Roles		0 5
>		5 6
builder		7 >
)		> ?
{

 	
builder 
. 
ToTable 
( 
$str "
," #
$str$ )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} —
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\Tama√±oPrecioMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class  
Tama√±oPrecioMapping $
:% &$
IEntityTypeConfiguration' ?
<? @
Tama√±oPrecio@ L
>L M
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Tama√±oPrecio		0 <
>		< =
builder		> E
)		E F
{

 	
builder 
. 
ToTable 
( 
$str *
,* +
$str, 1
)1 2
;2 3
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
	Productos" +
)+ ,
. 
WithMany 
( 
o 
=> 
o  
.  !
Tama√±oPrecios! .
). /
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &

IdProducto& 0
)0 1
;1 2
} 	
} 
} Å
KD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\UsuarioMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
UsuarioMapping 
:  $
IEntityTypeConfiguration! 9
<9 :
Usuario: A
>A B
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Usuario		0 7
>		7 8
builder		9 @
)		@ A
{

 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Roles" '
)' (
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdRol& +
)+ ,
;, -
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
PreguntaSeguridad" 3
)3 4
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdPreguntaSeguridad& 9
)9 :
;: ;
} 	
} 
} ”
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Boleta.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Boleta 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
	NroBoleta 
{  !
get" %
;% &
set' *
;* +
}, -
public 
decimal 

MontoTotal !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
Fecha 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
?		 
	Direccion		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
?

 

Referencia

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
int 
? 
	IdUsuario 
{ 
get  #
;# $
set% (
;( )
}* +
public 
Usuario 
Usuario 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
List 
< 
Pedido 
> 
Pedidos #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} ≠
FD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\DetallePedido.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
DetallePedido 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
	Productos 
Producto !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
IdPedido 
{ 
get !
;! "
set# &
;& '
}( )
public		 
Pedido		 
Pedido		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
int

 
IdTama√±oPrecio

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
Tama√±oPrecio 
tama√±oPrecio (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
precio 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} é
DD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Direcciones.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Direcciones 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Usuario 
Usuario 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 

Referencia		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
}

 
} û
GD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\ErrorViewModel.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ≠
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Estado.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Estado 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ¥
DD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\NroTracking.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
NroTracking 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
Numero 
{ 
get 
;  
set! $
;$ %
}& '
} 
} â
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Pedido.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Pedido 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
Usuario		 
Usuario		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
int

 
Estado

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 
Estado 
EstadoFK 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
decimal 
? 
Monto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
CodTracking "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
IdBoleta 
{ 
get !
;! "
set# &
;& '
}( )
public 
Boleta 
boleta 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Destino 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
List 
< 
DetallePedido !
>! "
DetallePedidos# 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
} 
} ≈
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\PreguntaSeguridad.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
PreguntaSeguridad "
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Pregunta 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} »
BD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Productos.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
	Productos 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
Descripcion		 !
{		" #
get		$ '
;		' (
set		) ,
;		, -
}		. /
public

 
string

 
	UrlImagen

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
List 
< 
Tama√±oPrecio  
>  !
Tama√±oPrecios" /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
} 
} ´
>D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Roles.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Roles 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ö
FD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Tama√±oPrecio.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Tama√±oPrecio 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
	Productos 
	Productos "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 
decimal		 
Precio		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
}

 
} ≠
@D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Usuario.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Usuario 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
IdRol 
{ 
get 
; 
set  #
;# $
}% &
public		 
Roles		 
Roles		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public

 
string

 
Nombre

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 

NroCelular !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Correo 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Contrase√±a !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
DNI 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
? 
IdPreguntaSeguridad '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
PreguntaSeguridad  
?  !
PreguntaSeguridad" 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
public 
string 
? 
RespuestaPS "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
List 
< 
Direcciones 
>  
Direcciones! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
List 
< 
Pedido 
> 
Pedidos #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
List 
< 
Boleta 
> 
Boletas #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} ¡-
9D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder

 
.

 
Services

 
.

 #
AddControllersWithViews

 (
(

( )
)

) *
;

* +
builder 
. 
Services 
. 
AddAuthentication "
(" #(
CookieAuthenticationDefaults# ?
.? @ 
AuthenticationScheme@ T
)T U
. 
	AddCookie 
( 
options 
=> 
{ 
options 
. 
	LoginPath 
= 
$str )
;) *
} 
) 
; 
builder 
. 
Services 
. 
AddDbContext 
< 

DbEntities (
>( )
() *
options 
=> 
options 
. 
UseSqlServer #
(# $
builder$ +
.+ ,
Configuration, 9
.9 :
GetConnectionString: M
(M N
$strN X
)X Y
)Y Z
) 
; 
builder 
. 
Services 
. 
AddTransient 
< 
IAuthRepositorio .
,. /
AuthRepositorio0 ?
>? @
(@ A
)A B
;B C
builder 
. 
Services 
. 
AddTransient 
< !
IHomeAdminRepositorio 3
,3 4 
HomeAdminRepositorio5 I
>I J
(J K
)K L
;L M
builder 
. 
Services 
. 
AddTransient 
< 
IHomeRepositorio .
,. /
HomeRepositorio0 ?
>? @
(@ A
)A B
;B C
builder 
. 
Services 
. 
AddTransient 
< 
IMenuRepositorio .
,. /
MenuRepositorio0 ?
>? @
(@ A
)A B
;B C
builder 
. 
Services 
. 
AddTransient 
< 
IPedidosRepositorio 1
,1 2
PedidosRepositorio3 E
>E F
(F G
)G H
;H I
builder 
. 
Services 
. 
AddTransient 
< 
IPersonaRepositorio 1
,1 2
PersonaRepositorio3 E
>E F
(F G
)G H
;H I
builder 
. 
Services 
. 
AddTransient 
< &
IProcesarCompraRepositorio 8
,8 9%
ProcesarCompraRepositorio: S
>S T
(T U
)U V
;V W
builder 
. 
Services 
. 
AddTransient 
< "
IProductosRepositorios 4
,4 5!
ProductosRepositorios6 K
>K L
(L M
)M N
;N O
builder 
. 
Services 
. 
AddTransient 
< %
IRegisterAdminRepositorio 7
,7 8$
RegisterAdminRepositorio9 Q
>Q R
(R S
)S T
;T U
builder 
. 
Services 
. 
AddTransient 
<  
ITrackingRepositorio 2
,2 3
TrackingRepositorio4 G
>G H
(H I
)I J
;J K
builder   
.   
Services   
.   
AddTransient   
<   
IVenderRepositorio   0
,  0 1
VenderRepositorio  2 C
>  C D
(  D E
)  E F
;  F G
builder!! 
.!! 
Services!! 
.!! 
AddTransient!! 
<!! 
IVentasRepositorio!! 0
,!!0 1
VentasRepositorio!!2 C
>!!C D
(!!D E
)!!E F
;!!F G
var## 
app## 
=## 	
builder##
 
.## 
Build## 
(## 
)## 
;## 
if&& 
(&& 
!&& 
app&& 
.&& 	
Environment&&	 
.&& 
IsDevelopment&& "
(&&" #
)&&# $
)&&$ %
{'' 
app(( 
.(( 
UseExceptionHandler(( 
((( 
$str(( )
)(() *
;((* +
app** 
.** 
UseHsts** 
(** 
)** 
;** 
}++ 
app-- 
.-- 
UseHttpsRedirection-- 
(-- 
)-- 
;-- 
app.. 
... 
UseStaticFiles.. 
(.. 
).. 
;.. 
app00 
.00 

UseRouting00 
(00 
)00 
;00 
app22 
.22 
UseAuthentication22 
(22 
)22 
;22 
app33 
.33 
UseAuthorization33 
(33 
)33 
;33 
app55 
.55 
MapControllerRoute55 
(55 
name66 
:66 	
$str66
 
,66 
pattern77 
:77 
$str77 5
)775 6
;776 7
app99 
.99 
Run99 
(99 
)99 	
;99	 
ä9
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\AuthRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IAuthRepositorio %
{ 
bool 
	verificar 
( 
string 
correo $
,$ %
string& ,
contrase√±a- 7
)7 8
;8 9
Usuario		 
obtenerUsuario		 
(		 
string		 %
correo		& ,
,		, -
string		. 4
contrase√±a		5 ?
)		? @
;		@ A
List

 
<

 
PreguntaSeguridad

 
>

 
obtenerPreguntas

  0
(

0 1
)

1 2
;

2 3
int 
contarUsuarios 
( 
) 
; 
int 
obtenerUltimoUsuaro 
(  
)  !
;! "
Usuario 
obtenerUsuario 
( 
string %
correo& ,
), -
;- .
bool &
verificarPreguntaSeguridad '
(' (
int( +
Id, .
,. /
int0 3
IdPreguntaSeguridad4 G
,G H
stringI O
RespuestaPSP [
)[ \
;\ ]
void 
actualizarUsuario 
( 
int "
Id# %
,% &
string' -
contrase√±a. 8
)8 9
;9 :
void 
	registrar 
( 
Usuario 
user #
,# $
Direcciones% 0
direcciones1 <
)< =
;= >
} 
public 

class 
AuthRepositorio  
:! "
IAuthRepositorio# 3
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
AuthRepositorio 
( 

DbEntities )

dbEntities* 4
)4 5
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
bool 
	verificar 
( 
string $
correo% +
,+ ,
string- 3
contrase√±a4 >
)> ?
{ 	
return 
_dbEntities 
. 
usuarios '
.' (
Any( +
(+ ,
x, -
=>. 0
x1 2
.2 3
Correo3 9
==: <
correo= C
&&D F
xG H
.H I
Contrase√±aI S
==T V
contrase√±aW a
)a b
;b c
} 	
public   
Usuario   
obtenerUsuario   %
(  % &
string  & ,
correo  - 3
,  3 4
string  5 ;
contrase√±a  < F
)  F G
{!! 	
return"" 
_dbEntities"" 
."" 
usuarios"" '
.""' (
First""( -
(""- .
x"". /
=>""0 2
x""3 4
.""4 5
Correo""5 ;
==""< >
correo""? E
&&""F H
x""I J
.""J K
Contrase√±a""K U
==""V X
contrase√±a""Y c
)""c d
;""d e
}## 	
public%% 
List%% 
<%% 
PreguntaSeguridad%% %
>%%% &
obtenerPreguntas%%' 7
(%%7 8
)%%8 9
{&& 	
return'' 
_dbEntities'' 
.'' 
preguntaSeguridads'' 1
.''1 2
ToList''2 8
(''8 9
)''9 :
;'': ;
}(( 	
public** 
int** 
contarUsuarios** !
(**! "
)**" #
{++ 	
return,, 
_dbEntities,, 
.,, 
usuarios,, '
.,,' (
Count,,( -
(,,- .
),,. /
;,,/ 0
}-- 	
public// 
int// 
obtenerUltimoUsuaro// &
(//& '
)//' (
{00 	
return11 
_dbEntities11 
.11 
usuarios11 '
.11' (
OrderBy11( /
(11/ 0
o110 1
=>112 4
o115 6
.116 7
Id117 9
)119 :
.11: ;
Last11; ?
(11? @
)11@ A
.11A B
Id11B D
+11E F
$num11G H
;11H I
}22 	
public44 
void44 
	registrar44 
(44 
Usuario44 %
user44& *
,44* +
Direcciones44, 7
direcciones448 C
)44C D
{55 	
_dbEntities66 
.66 
usuarios66  
.66  !
Add66! $
(66$ %
user66% )
)66) *
;66* +
_dbEntities77 
.77 
direcciones77 #
.77# $
Add77$ '
(77' (
direcciones77( 3
)773 4
;774 5
_dbEntities88 
.88 
SaveChanges88 #
(88# $
)88$ %
;88% &
}99 	
public;; 
Usuario;; 
obtenerUsuario;; %
(;;% &
string;;& ,
correo;;- 3
);;3 4
{<< 	
return== 
_dbEntities== 
.== 
usuarios== '
.==' (
FirstOrDefault==( 6
(==6 7
o==7 8
=>==9 ;
o==< =
.=== >
Correo==> D
====E G
correo==H N
)==N O
;==O P
}>> 	
public@@ 
bool@@ &
verificarPreguntaSeguridad@@ .
(@@. /
int@@/ 2
Id@@3 5
,@@5 6
int@@7 :
IdPreguntaSeguridad@@; N
,@@N O
string@@P V
RespuestaPS@@W b
)@@b c
{AA 	
returnBB 
_dbEntitiesBB 
.BB 
usuariosBB '
.BB' (
AnyBB( +
(BB+ ,
oBB, -
=>BB. 0
oBB1 2
.BB2 3
IdBB3 5
==BB6 8
IdBB9 ;
&&CC 
oCC 
.CC 
IdPreguntaSeguridadCC /
==CC0 2
IdPreguntaSeguridadCC3 F
&&DD 
oDD 
.DD 
RespuestaPSDD '
==DD( *
RespuestaPSDD+ 6
)DD6 7
;DD7 8
}EE 	
publicGG 
voidGG 
actualizarUsuarioGG %
(GG% &
intGG& )
IdGG* ,
,GG, -
stringGG. 4
contrase√±aGG5 ?
)GG? @
{HH 	
UsuarioII 
userII 
=II 
_dbEntitiesII &
.II& '
usuariosII' /
.II/ 0
FirstII0 5
(II5 6
oII6 7
=>II8 :
oII; <
.II< =
IdII= ?
==II@ B
IdIIC E
)IIE F
;IIF G
userJJ 
.JJ 
Contrase√±aJJ 
=JJ 
contrase√±aJJ (
;JJ( )
_dbEntitiesKK 
.KK 
SaveChangesKK #
(KK# $
)KK$ %
;KK% &
}LL 	
}MM 
}NN Î

RD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\HomeAdminRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface !
IHomeAdminRepositorio *
{ 
Usuario 
obtenerUsuario 
( 
string %
username& .
). /
;/ 0
}		 
public

 

class

  
HomeAdminRepositorio

 %
:

% &!
IHomeAdminRepositorio

' <
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public  
HomeAdminRepositorio #
(# $

DbEntities$ .

dbEntities/ 9
)9 :
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
Usuario 
obtenerUsuario %
(% &
string& ,
username- 5
)5 6
{ 	
return 
_dbEntities 
. 
usuarios '
.' (
First( -
(- .
o. /
=>0 2
o3 4
.4 5
Correo5 ;
==< >
username? G
)G H
;H I
} 	
} 
} Ò
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\HomeRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IHomeRepositorio %
{ 
}		 
public

 

class

 
HomeRepositorio

  
:

! "
IHomeRepositorio

# 3
{ 
private 

DbEntities 
_dbEntities &
;& '
public 
HomeRepositorio 
( 

DbEntities )

dbEntities* 4
)4 5
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
} 
} Ô	
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\MenuRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IMenuRepositorio %
{ 
List 
< 
	Productos 
> 
listarProductos '
(' (
)( )
;) *
}		 
public

 

class

 
MenuRepositorio

  
:

  !
IMenuRepositorio

" 2
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
MenuRepositorio 
( 

DbEntities )

dbEntities* 4
)4 5
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
	Productos 
> 
listarProductos .
(. /
)/ 0
{ 	
return 
_dbEntities 
. 
	Productos (
.( )
ToList) /
(/ 0
)0 1
;1 2
} 	
} 
} ¿/
PD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\PedidosRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IPedidosRepositorio (
{ 
List		 
<		 
Boleta		 
>		 
listarEspera		 !
(		! "
)		" #
;		# $
List

 
<

 
Boleta

 
>

 
listarEntregado

 $
(

$ %
)

% &
;

& '
List 
< 
Boleta 
> 
listarAnulado "
(" #
)# $
;$ %
List 
< 
Pedido 
> 
listarPedidos "
(" #
int# &
id' )
)) *
;* +
Usuario 
obtenerUsuario 
( 
string %
username& .
). /
;/ 0
void 
actualizarEstado 
( 
) 
;  
} 
public 

class 
PedidosRepositorio #
:# $
IPedidosRepositorio% 8
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
PedidosRepositorio !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
Boleta 
> 
listarEspera (
(( )
)) *
{ 	
return 
_dbEntities 
. 
boletas &
.  !
Include! (
(( )
$str) 2
)2 3
.  !
Include! (
(( )
$str) ;
); <
.  !
Include! (
(( )
$str) A
)A B
.  !
Include! (
(( )
$str) J
)J K
.  !
Where! &
(& '
o' (
=>) +
o, -
.- .
Pedidos. 5
.5 6
Any6 9
(9 :
x: ;
=>< >
x? @
.@ A
EstadoA G
>=H J
$numK L
)L M
&&N P
oQ R
.R S
PedidosS Z
.Z [
Any[ ^
(^ _
x_ `
=>a c
xd e
.e f
Estadof l
<=m o
$nump q
)q r
)r s
.s t
ToListt z
(z {
){ |
;| }
} 	
public!! 
List!! 
<!! 
Boleta!! 
>!! 
listarEntregado!! +
(!!+ ,
)!!, -
{"" 	
return## 
_dbEntities## 
.## 
boletas## &
.$$  !
Include$$! (
($$( )
$str$$) 2
)$$2 3
.%%  !
Include%%! (
(%%( )
$str%%) ;
)%%; <
.&&  !
Include&&! (
(&&( )
$str&&) A
)&&A B
.''  !
Include''! (
(''( )
$str'') J
)''J K
.((  !
Where((! &
(((& '
o((' (
=>(() +
o((, -
.((- .
Pedidos((. 5
.((5 6
Any((6 9
(((9 :
x((: ;
=>((< >
x((? @
.((@ A
Estado((A G
==((H J
$num((K L
)((L M
)((M N
.((N O
ToList((O U
(((U V
)((V W
;((W X
})) 	
public++ 
List++ 
<++ 
Boleta++ 
>++ 
listarAnulado++ )
(++) *
)++* +
{,, 	
return-- 
_dbEntities-- 
.-- 
boletas-- &
...  !
Include..! (
(..( )
$str..) 2
)..2 3
.//  !
Include//! (
(//( )
$str//) ;
)//; <
.00  !
Include00! (
(00( )
$str00) A
)00A B
.11  !
Include11! (
(11( )
$str11) J
)11J K
.22  !
Where22! &
(22& '
o22' (
=>22) +
o22, -
.22- .
Pedidos22. 5
.225 6
Any226 9
(229 :
x22: ;
=>22< >
x22? @
.22@ A
Estado22A G
==22H J
$num22K L
)22L M
)22M N
.22N O
ToList22O U
(22U V
)22V W
;22W X
}33 	
public55 
List55 
<55 
Pedido55 
>55 
listarPedidos55 )
(55) *
int55* -
id55. 0
)550 1
{66 	
return77 
_dbEntities77 
.77 
pedidos77 &
.77& '
Where77' ,
(77, -
o77- .
=>77/ 1
o772 3
.773 4
IdBoleta774 <
==77= ?
id77@ B
)77B C
.77C D
ToList77D J
(77J K
)77K L
;77L M
}88 	
public:: 
void:: 
actualizarEstado:: $
(::$ %
)::% &
{;; 	
_dbEntities<< 
.<< 
SaveChanges<< #
(<<# $
)<<$ %
;<<% &
}== 	
public?? 
Usuario?? 
obtenerUsuario?? %
(??% &
string??& ,
username??- 5
)??5 6
{@@ 	
returnAA 
_dbEntitiesAA 
.AA 
usuariosAA '
.AA' (
FirstAA( -
(AA- .
oAA. /
=>AA0 2
oAA3 4
.AA4 5
CorreoAA5 ;
==AA< >
usernameAA? G
)AAG H
;AAH I
}BB 	
}CC 
}DD à1
PD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\PersonaRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IPersonaRepositorio (
{ 
Usuario 
obtenerUsuarioId  
(  !
int! $
Id% '
)' (
;( )
List		 
<		 
Direcciones		 
>		 
obtenerDirecciones		 ,
(		, -
int		- 0
Id		1 3
)		3 4
;		4 5
void

 
agregarDireccion

 
(

 
Direcciones

 )
	direccion

* 3
)

3 4
;

4 5
void 
eliminarDireccion 
( 
int "
id# %
)% &
;& '
bool &
verificarContrase√±aActual &
(& '
int' *
Id+ -
,- .
string/ 5
contrase√±aActual6 F
)F G
;G H
void 
actualizarBD 
( 
) 
; 
Usuario  
obtenerUsuarioString $
($ %
string% +
username, 4
)4 5
;5 6
void !
actualizarContrase√±a !
(! "
int" %
Id& (
,( )
string* 0
contrase√±aNueva1 @
)@ A
;A B
} 
public 

class 
PersonaRepositorio #
:# $
IPersonaRepositorio% 8
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
PersonaRepositorio !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
Usuario 
obtenerUsuarioId '
(' (
int( +
Id, .
). /
{ 	
return 
_dbEntities 
. 
usuarios '
.' (
First( -
(- .
o. /
=>0 2
o3 4
.4 5
Id5 7
==8 :
Id; =
)= >
;> ?
} 	
public 
List 
< 
Direcciones 
>  
obtenerDirecciones! 3
(3 4
int4 7
Id8 :
): ;
{   	
return!! 
_dbEntities!! 
.!! 
direcciones!! *
.!!* +
Where!!+ 0
(!!0 1
o!!1 2
=>!!3 5
o!!6 7
.!!7 8
	IdUsuario!!8 A
==!!B D
Id!!E G
)!!G H
.!!H I
ToList!!I O
(!!O P
)!!P Q
;!!Q R
}"" 	
public$$ 
void$$ 
agregarDireccion$$ $
($$$ %
Direcciones$$% 0
	direccion$$1 :
)$$: ;
{%% 	
_dbEntities&& 
.&& 
direcciones&& #
.&&# $
Add&&$ '
(&&' (
	direccion&&( 1
)&&1 2
;&&2 3
_dbEntities'' 
.'' 
SaveChanges'' #
(''# $
)''$ %
;''% &
}(( 	
public** 
void** 
eliminarDireccion** %
(**% &
int**& )
id*** ,
)**, -
{++ 	
Direcciones,, 
	direccion,, !
=,," #
_dbEntities,,$ /
.,,/ 0
direcciones,,0 ;
.,,; <
First,,< A
(,,A B
o,,B C
=>,,D F
o,,G H
.,,H I
Id,,I K
==,,L N
id,,O Q
),,Q R
;,,R S
_dbEntities-- 
.-- 
direcciones-- #
.--# $
Remove--$ *
(--* +
	direccion--+ 4
)--4 5
;--5 6
_dbEntities.. 
... 
SaveChanges.. #
(..# $
)..$ %
;..% &
}// 	
public11 
bool11 &
verificarContrase√±aActual11 -
(11- .
int11. 1
Id112 4
,114 5
string116 <
contrase√±aActual11= M
)11M N
{22 	
return33 
_dbEntities33 
.33 
usuarios33 '
.33' (
Any33( +
(33+ ,
x33, -
=>33. 0
x331 2
.332 3
Id333 5
==336 8
Id339 ;
&&33< >
x33? @
.33@ A
Contrase√±a33A K
==33L N
contrase√±aActual33O _
)33_ `
;33` a
}44 	
public66 
void66 
actualizarBD66  
(66  !
)66! "
{77 	
_dbEntities88 
.88 
SaveChanges88 #
(88# $
)88$ %
;88% &
}99 	
public;; 
Usuario;;  
obtenerUsuarioString;; +
(;;+ ,
string;;, 2
username;;3 ;
);;; <
{<< 	
return== 
_dbEntities== 
.== 
usuarios== '
.==' (
First==( -
(==- .
o==. /
=>==0 2
o==3 4
.==4 5
Correo==5 ;
====< >
username==? G
)==G H
;==H I
}>> 	
public@@ 
void@@ !
actualizarContrase√±a@@ (
(@@( )
int@@) ,
Id@@- /
,@@/ 0
string@@1 7
contrase√±aNueva@@8 G
)@@G H
{AA 	
UsuarioBB 
userBB 
=BB 
_dbEntitiesBB &
.BB& '
usuariosBB' /
.BB/ 0
FirstBB0 5
(BB5 6
oBB6 7
=>BB8 :
oBB; <
.BB< =
IdBB= ?
==BB@ B
IdBBC E
)BBE F
;BBF G
userCC 
.CC 
Contrase√±aCC 
=CC 
contrase√±aNuevaCC -
;CC- .
_dbEntitiesDD 
.DD 
SaveChangesDD #
(DD# $
)DD$ %
;DD% &
}EE 	
}FF 
}GG öí
WD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\ProcesarCompraRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface &
IProcesarCompraRepositorio /
{ 
	Productos		 
obtenerProducto		 !
(		! "
int		" %

IdProducto		& 0
)		0 1
;		1 2
void

 
registrarPedido

 
(

 
int

  
Id

! #
)

# $
;

$ %
int 
obtenerIdPedido 
( 
) 
; 
Tama√±oPrecio  
obtenerTama√±oPrecio (
(( )
int) ,
IdTama√±oPrecio- ;
); <
;< =
void 
actualizarMonto 
( 
int  
idPedido! )
,) *
int+ .
Cantidad/ 7
,7 8
decimal9 @
PrecioA G
)G H
;H I
void 
agregarDetalle 
( 
DetallePedido )
detallePedido* 7
)7 8
;8 9
List 
< 
DetallePedido 
> 
listarDatosCesta ,
(, -
int- 0
Id1 3
)3 4
;4 5
List 
< 
Direcciones 
> 
obtenerDirecciones ,
(, -
int- 0
Id1 3
)3 4
;4 5
List 
< 
DetallePedido 
> 
obtenerMontos )
() *
int* -
Id. 0
)0 1
;1 2
void 
actualizarCantidad 
(  
int  #
Id$ &
,& '
int( +
Cantidad, 4
)4 5
;5 6
Usuario 
obtenerUsuario 
( 
string %
username& .
). /
;/ 0
Usuario 
obtenerUsuarioFirst #
(# $
int$ '
Id( *
)* +
;+ ,
int $
obtenerSecuenciaTracking $
($ %
)% &
;& '
void !
actualizarCodTracking "
(" #
)# $
;$ %
void 
eliminarPedido 
( 
int 
id  "
)" #
;# $
List 
< 
DetallePedido 
> 
listarPedidos )
() *
int* -
Id. 0
)0 1
;1 2
List 
< 
Pedido 
> #
listarPedidosActualizar ,
(, -
int- 0
Id1 3
)3 4
;4 5
void 
comprar 
( 
) 
; 
int 
contarBoletas 
( 
) 
; 
Direcciones 
obtenerDireccion $
($ %
int% (
IdDireccion) 4
)4 5
;5 6
int 
guardarBoleta 
( 
Boleta  
boleta! '
)' (
;( )
} 
public 

class %
ProcesarCompraRepositorio *
:+ ,&
IProcesarCompraRepositorio- G
{   
private!! 
readonly!! 

DbEntities!! #
_dbEntities!!$ /
;!!/ 0
public## %
ProcesarCompraRepositorio## (
(##( )

DbEntities##) 3

dbEntities##4 >
)##> ?
{$$ 	
_dbEntities%% 
=%% 

dbEntities%% $
;%%$ %
}&& 	
public(( 
	Productos(( 
obtenerProducto(( (
(((( )
int(() ,

IdProducto((- 7
)((7 8
{)) 	
return** 
_dbEntities** 
.** 
	Productos** (
.++  !
Include++! (
(++( )
$str++) 8
)++8 9
.,,  !
First,,! &
(,,& '
o,,' (
=>,,) +
o,,, -
.,,- .
Id,,. 0
==,,1 3

IdProducto,,4 >
),,> ?
;,,? @
}-- 	
public// 
void// 
registrarPedido// #
(//# $
int//$ '
Id//( *
)//* +
{00 	
Pedido11 
pedido11 
=11 
new11 
Pedido11  &
(11& '
)11' (
;11( )
pedido22 
.22 
	IdUsuario22 
=22 
Id22 !
;22! "
pedido33 
.33 
Estado33 
=33 
$num33 
;33 
pedido44 
.44 
Destino44 
=44 
$str44 '
;44' (
_dbEntities55 
.55 
pedidos55 
.55  
Add55  #
(55# $
pedido55$ *
)55* +
;55+ ,
_dbEntities66 
.66 
SaveChanges66 #
(66# $
)66$ %
;66% &
}77 	
public99 
int99 
obtenerIdPedido99 "
(99" #
)99# $
{:: 	
return;; 
_dbEntities;; 
.;; 
pedidos;; &
.;;& '
OrderBy;;' .
(;;. /
o;;/ 0
=>;;1 3
o;;4 5
.;;5 6
Id;;6 8
);;8 9
.;;9 :
Last;;: >
(;;> ?
);;? @
.;;@ A
Id;;A C
;;;C D
}<< 	
public>> 
Tama√±oPrecio>>  
obtenerTama√±oPrecio>> /
(>>/ 0
int>>0 3
IdTama√±oPrecio>>4 B
)>>B C
{?? 	
return@@ 
_dbEntities@@ 
.@@ 
tama√±oPrecios@@ ,
.@@, -
First@@- 2
(@@2 3
o@@3 4
=>@@5 7
o@@8 9
.@@9 :
Id@@: <
==@@= ?
IdTama√±oPrecio@@@ N
)@@N O
;@@O P
}AA 	
publicCC 
voidCC 
actualizarMontoCC #
(CC# $
intCC$ '
idPedidoCC( 0
,CC0 1
intCC2 5
CantidadCC6 >
,CC> ?
decimalCC@ G
PrecioCCH N
)CCN O
{DD 	
PedidoEE 

pedidoAux2EE 
=EE 
newEE  #
PedidoEE$ *
(EE* +
)EE+ ,
;EE, -

pedidoAux2FF 
=FF 
_dbEntitiesFF $
.FF$ %
pedidosFF% ,
.FF, -
FirstFF- 2
(FF2 3
oFF3 4
=>FF5 7
oFF8 9
.FF9 :
IdFF: <
==FF= ?
idPedidoFF@ H
)FFH I
;FFI J

pedidoAux2GG 
.GG 
MontoGG 
=GG 
CantidadGG '
*GG( )
PrecioGG* 0
;GG0 1
_dbEntitiesHH 
.HH 
SaveChangesHH #
(HH# $
)HH$ %
;HH% &
}II 	
publicKK 
voidKK 
agregarDetalleKK "
(KK" #
DetallePedidoKK# 0
detallePedidoKK1 >
)KK> ?
{LL 	
_dbEntitiesMM 
.MM 
detallePedidosMM &
.MM& '
AddMM' *
(MM* +
detallePedidoMM+ 8
)MM8 9
;MM9 :
_dbEntitiesNN 
.NN 
SaveChangesNN #
(NN# $
)NN$ %
;NN% &
}OO 	
publicQQ 
ListQQ 
<QQ 
DetallePedidoQQ !
>QQ! "
listarDatosCestaQQ# 3
(QQ3 4
intQQ4 7
IdQQ8 :
)QQ: ;
{RR 	
returnSS 
_dbEntitiesSS 
.SS 
detallePedidosSS -
.TT 
IncludeTT 
(TT 
oTT 
=>TT !
oTT" #
.TT# $
ProductoTT$ ,
)TT, -
.UU 
IncludeUU 
(UU 
oUU 
=>UU !
oUU" #
.UU# $
PedidoUU$ *
)UU* +
.VV 
IncludeVV 
(VV 
oVV 
=>VV !
oVV" #
.VV# $
PedidoVV$ *
.VV* +
EstadoFKVV+ 3
)VV3 4
.WW 
WhereWW 
(WW 
oWW 
=>WW 
oWW  !
.WW! "
PedidoWW" (
.WW( )
	IdUsuarioWW) 2
==WW3 5
IdWW6 8
&&WW9 ;
oWW< =
.WW= >
PedidoWW> D
.WWD E
EstadoWWE K
==WWL N
$numWWO P
)WWP Q
.WWQ R
ToListWWR X
(WWX Y
)WWY Z
;WWZ [
}XX 	
publicZZ 
ListZZ 
<ZZ 
DireccionesZZ 
>ZZ  
obtenerDireccionesZZ! 3
(ZZ3 4
intZZ4 7
IdZZ8 :
)ZZ: ;
{[[ 	
return\\ 
_dbEntities\\ 
.\\ 
direcciones\\ *
.]] 
Where]] 
(]] 
o]] 
=>]] 
o]]  !
.]]! "
	IdUsuario]]" +
==]], .
Id]]/ 1
)]]1 2
.]]2 3
ToList]]3 9
(]]9 :
)]]: ;
;]]; <
}^^ 	
public`` 
List`` 
<`` 
DetallePedido`` !
>``! "
obtenerMontos``# 0
(``0 1
int``1 4
Id``5 7
)``7 8
{aa 	
returnbb 
_dbEntitiesbb 
.bb 
detallePedidosbb -
.cc 
Includecc 
(cc 
occ 
=>cc !
occ" #
.cc# $
Pedidocc$ *
)cc* +
.dd 
Wheredd 
(dd 
odd 
=>dd 
odd  !
.dd! "
Pedidodd" (
.dd( )
	IdUsuariodd) 2
==dd3 5
Iddd6 8
&&dd9 ;
odd< =
.dd= >
Pedidodd> D
.ddD E
EstadoddE K
==ddL N
$numddO P
)ddP Q
.ddQ R
ToListddR X
(ddX Y
)ddY Z
;ddZ [
}ee 	
publicgg 
voidgg 
actualizarCantidadgg &
(gg& '
intgg' *
Idgg+ -
,gg- .
intgg/ 2
Cantidadgg3 ;
)gg; <
{hh 	
DetallePedidoii 
pedidoii  
=ii! "
_dbEntitiesii# .
.ii. /
detallePedidosii/ =
.ii= >
Firstii> C
(iiC D
oiiD E
=>iiF H
oiiI J
.iiJ K
IdiiK M
==iiN P
IdiiQ S
)iiS T
;iiT U
pedidojj 
.jj 
Cantidadjj 
=jj 
Cantidadjj &
;jj& '
_dbEntitieskk 
.kk 
SaveChangeskk #
(kk# $
)kk$ %
;kk% &
}ll 	
publicnn 
Usuarionn 
obtenerUsuarionn %
(nn% &
stringnn& ,
usernamenn- 5
)nn5 6
{oo 	
returnpp 
_dbEntitiespp 
.pp 
usuariospp '
.pp' (
Firstpp( -
(pp- .
opp. /
=>pp0 2
opp3 4
.pp4 5
Correopp5 ;
==pp< >
usernamepp? G
)ppG H
;ppH I
}qq 	
publicss 
Usuarioss 
obtenerUsuarioFirstss *
(ss* +
intss+ .
Idss/ 1
)ss1 2
{tt 	
returnuu 
_dbEntitiesuu 
.uu 
usuariosuu '
.uu' (
Firstuu( -
(uu- .
ouu. /
=>uu0 2
ouu3 4
.uu4 5
Iduu5 7
==uu8 :
Iduu; =
)uu= >
;uu> ?
}vv 	
publicxx 
intxx $
obtenerSecuenciaTrackingxx +
(xx+ ,
)xx, -
{yy 	
returnzz 
_dbEntitieszz 
.zz 
nroTrackingszz +
.zz+ ,
Firstzz, 1
(zz1 2
ozz2 3
=>zz4 6
ozz7 8
.zz8 9
Idzz9 ;
==zz< >
$numzz? @
)zz@ A
.zzA B
NumerozzB H
;zzH I
}{{ 	
public}} 
void}} !
actualizarCodTracking}} )
(}}) *
)}}* +
{~~ 	
NroTracking 
nroTracking #
=$ %
new& )
NroTracking* 5
(5 6
)6 7
;7 8
nroTracking
ÄÄ 
=
ÄÄ 
_dbEntities
ÄÄ %
.
ÄÄ% &
nroTrackings
ÄÄ& 2
.
ÄÄ2 3
First
ÄÄ3 8
(
ÄÄ8 9
o
ÄÄ9 :
=>
ÄÄ; =
o
ÄÄ> ?
.
ÄÄ? @
Id
ÄÄ@ B
==
ÄÄC E
$num
ÄÄF G
)
ÄÄG H
;
ÄÄH I
nroTracking
ÅÅ 
.
ÅÅ 
Numero
ÅÅ 
++
ÅÅ  
;
ÅÅ  !
_dbEntities
ÇÇ 
.
ÇÇ 
SaveChanges
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
;
ÇÇ% &
}
ÉÉ 	
public
ÖÖ 
void
ÖÖ 
eliminarPedido
ÖÖ "
(
ÖÖ" #
int
ÖÖ# &
id
ÖÖ' )
)
ÖÖ) *
{
ÜÜ 	
var
áá 
pedidoDb
áá 
=
áá 
_dbEntities
áá &
.
áá& '
pedidos
áá' .
.
áá. /
First
áá/ 4
(
áá4 5
o
áá5 6
=>
áá7 9
o
áá: ;
.
áá; <
Id
áá< >
==
áá? A
id
ááB D
)
ááD E
;
ááE F
_dbEntities
àà 
.
àà 
pedidos
àà 
.
àà  
Remove
àà  &
(
àà& '
pedidoDb
àà' /
)
àà/ 0
;
àà0 1
_dbEntities
ââ 
.
ââ 
SaveChanges
ââ #
(
ââ# $
)
ââ$ %
;
ââ% &
var
ää 
	detalleDb
ää 
=
ää 
_dbEntities
ää '
.
ää' (
detallePedidos
ää( 6
.
ää6 7
First
ää7 <
(
ää< =
o
ää= >
=>
ää? A
o
ääB C
.
ääC D
IdPedido
ääD L
==
ääM O
id
ääP R
)
ääR S
;
ääS T
_dbEntities
ãã 
.
ãã 
detallePedidos
ãã &
.
ãã& '
Remove
ãã' -
(
ãã- .
	detalleDb
ãã. 7
)
ãã7 8
;
ãã8 9
_dbEntities
åå 
.
åå 
SaveChanges
åå #
(
åå# $
)
åå$ %
;
åå% &
}
çç 	
public
èè 
List
èè 
<
èè 
DetallePedido
èè !
>
èè! "
listarPedidos
èè# 0
(
èè0 1
int
èè1 4
Id
èè5 7
)
èè7 8
{
êê 	
return
ëë 
_dbEntities
ëë 
.
ëë 
detallePedidos
ëë -
.
íí 
Include
íí  
(
íí  !
o
íí! "
=>
íí# %
o
íí& '
.
íí' (
Producto
íí( 0
)
íí0 1
.
ìì 
Include
ìì  
(
ìì  !
o
ìì! "
=>
ìì# %
o
ìì& '
.
ìì' (
Pedido
ìì( .
)
ìì. /
.
îî 
Include
îî  
(
îî  !
o
îî! "
=>
îî# %
o
îî& '
.
îî' (
Pedido
îî( .
.
îî. /
EstadoFK
îî/ 7
)
îî7 8
.
ïï 
Where
ïï 
(
ïï 
o
ïï  
=>
ïï! #
o
ïï$ %
.
ïï% &
Pedido
ïï& ,
.
ïï, -
	IdUsuario
ïï- 6
==
ïï7 9
Id
ïï: <
&&
ïï= ?
o
ïï@ A
.
ïïA B
Pedido
ïïB H
.
ïïH I
Estado
ïïI O
==
ïïP R
$num
ïïS T
)
ïïT U
.
ïïU V
ToList
ïïV \
(
ïï\ ]
)
ïï] ^
;
ïï^ _
}
ññ 	
public
òò 
List
òò 
<
òò 
Pedido
òò 
>
òò %
listarPedidosActualizar
òò 3
(
òò3 4
int
òò4 7
Id
òò8 :
)
òò: ;
{
ôô 	
return
öö 
_dbEntities
öö 
.
öö 
pedidos
öö &
.
öö& '
Where
öö' ,
(
öö, -
o
öö- .
=>
öö/ 1
o
öö2 3
.
öö3 4
	IdUsuario
öö4 =
==
öö> @
Id
ööA C
&&
ööD F
o
ööG H
.
ööH I
Estado
ööI O
==
ööP R
$num
ööS T
)
ööT U
.
ööU V
ToList
ööV \
(
öö\ ]
)
öö] ^
;
öö^ _
}
õõ 	
public
ùù 
void
ùù 
comprar
ùù 
(
ùù 
)
ùù 
{
ûû 	
_dbEntities
üü 
.
üü 
SaveChanges
üü #
(
üü# $
)
üü$ %
;
üü% &
}
†† 	
public
¢¢ 
int
¢¢ 
contarBoletas
¢¢  
(
¢¢  !
)
¢¢! "
{
££ 	
return
§§ 
_dbEntities
§§ 
.
§§ 
boletas
§§ &
.
§§& '
Count
§§' ,
(
§§, -
)
§§- .
;
§§. /
}
•• 	
public
ßß 
Direcciones
ßß 
obtenerDireccion
ßß +
(
ßß+ ,
int
ßß, /
IdDireccion
ßß0 ;
)
ßß; <
{
®® 	
return
©© 
_dbEntities
©© 
.
©© 
direcciones
©© *
.
©©* +
First
©©+ 0
(
©©0 1
o
©©1 2
=>
©©3 5
o
©©6 7
.
©©7 8
Id
©©8 :
==
©©; =
IdDireccion
©©> I
)
©©I J
;
©©J K
}
™™ 	
public
¨¨ 
int
¨¨ 
guardarBoleta
¨¨  
(
¨¨  !
Boleta
¨¨! '
boleta
¨¨( .
)
¨¨. /
{
≠≠ 	
_dbEntities
ÆÆ 
.
ÆÆ 
boletas
ÆÆ 
.
ÆÆ  
Add
ÆÆ  #
(
ÆÆ# $
boleta
ÆÆ$ *
)
ÆÆ* +
;
ÆÆ+ ,
_dbEntities
ØØ 
.
ØØ 
SaveChanges
ØØ #
(
ØØ# $
)
ØØ$ %
;
ØØ% &
return
±± 
_dbEntities
±± 
.
±± 
boletas
±± &
.
±±& '
OrderBy
±±' .
(
±±. /
o
±±/ 0
=>
±±1 3
o
±±4 5
.
±±5 6
Id
±±6 8
)
±±8 9
.
±±9 :
Last
±±: >
(
±±> ?
)
±±? @
.
±±@ A
Id
±±A C
;
±±C D
}
≤≤ 	
}
≥≥ 
}¥¥ çP
SD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\ProductosRepositorios.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface "
IProductosRepositorios +
{ 
List		 
<		 
	Productos		 
>		 
listarProductos		 '
(		' (
)		( )
;		) *
void

 
agregarProducto

 
(

 
	Productos

 &
	productos

' 0
)

0 1
;

1 2
	Productos 
obtenerProducto !
(! "
int" %
Id& (
)( )
;) *
void 
actualizarProducto 
(  
int  #
Id$ &
,& '
	Productos( 1
	productos2 ;
); <
;< =
void  
AgregarTama√±oPrecio  
(  !
int! $
Id% '
,' (
Tama√±oPrecio) 5
tama√±oPrecio6 B
)B C
;C D
Tama√±oPrecio  
obtenerTama√±oPrecio (
(( )
int) ,
Id- /
)/ 0
;0 1
	Productos 
obtenerProductoId #
(# $
int$ '

IdProducto( 2
)2 3
;3 4
void 
editarTama√±o 
( 
int 
Id  
,  !
string" (
Tama√±oProducto) 7
,7 8
decimal9 @
PrecioA G
)G H
;H I
void !
eliminarTama√±oPrecio !
(! "
int" %
Id& (
)( )
;) *
Usuario 
obtenerUsuario 
( 
string %
username& .
). /
;/ 0
void 
editarProducto 
( 
int 
Id  "
," #
	Productos$ -
	productos. 7
)7 8
;8 9
} 
public 

class !
ProductosRepositorios &
:' ("
IProductosRepositorios) ?
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public !
ProductosRepositorios $
($ %

DbEntities% /

dbEntities0 :
): ;
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
	Productos 
> 
listarProductos .
(. /
)/ 0
{ 	
return   
_dbEntities   
.   
	Productos   (
.!!( )
Include!!) 0
(!!0 1
$str!!1 @
)!!@ A
.""( )
ToList"") /
(""/ 0
)""0 1
;""1 2
}## 	
public%% 
void%% 
agregarProducto%% #
(%%# $
	Productos%%$ -
	productos%%. 7
)%%7 8
{&& 	
_dbEntities'' 
.'' 
	Productos'' !
.''! "
Add''" %
(''% &
	productos''& /
)''/ 0
;''0 1
_dbEntities(( 
.(( 
SaveChanges(( #
(((# $
)(($ %
;((% &
})) 	
public++ 
	Productos++ 
obtenerProducto++ (
(++( )
int++) ,
Id++- /
)++/ 0
{,, 	
return-- 
_dbEntities-- 
.-- 
	Productos-- (
.--( )
First--) .
(--. /
o--/ 0
=>--1 3
o--4 5
.--5 6
Id--6 8
==--9 ;
Id--< >
)--> ?
;--? @
}.. 	
public00 
void00 
actualizarProducto00 &
(00& '
int00' *
Id00+ -
,00- .
	Productos00/ 8
	productos009 B
)00B C
{11 	
var22 
producto22 
=22 
_dbEntities22 &
.22& '
	Productos22' 0
.220 1
First221 6
(226 7
o227 8
=>229 ;
o22< =
.22= >
Id22> @
==22A C
Id22D F
)22F G
;22G H
producto33 
.33 
Nombre33 
=33 
	productos33 '
.33' (
Nombre33( .
;33. /
producto44 
.44 
Descripcion44  
=44! "
	productos44# ,
.44, -
Descripcion44- 8
;448 9
producto55 
.55 
	UrlImagen55 
=55  
	productos55! *
.55* +
	UrlImagen55+ 4
;554 5
_dbEntities66 
.66 
SaveChanges66 #
(66# $
)66$ %
;66% &
}77 	
public99 
void99  
AgregarTama√±oPrecio99 '
(99' (
int99( +
Id99, .
,99. /
Tama√±oPrecio990 <
tama√±oPrecio99= I
)99I J
{:: 	
Tama√±oPrecio;; 
tama√±oPrecio1;; &
=;;' (
new;;) ,
Tama√±oPrecio;;- 9
(;;9 :
);;: ;
;;;; <
tama√±oPrecio1<< 
.<< 

IdProducto<< $
=<<% &
Id<<' )
;<<) *
tama√±oPrecio1== 
.== 
Tama√±oProducto== (
===) *
tama√±oPrecio==+ 7
.==7 8
Tama√±oProducto==8 F
;==F G
tama√±oPrecio1>> 
.>> 
Precio>>  
=>>! "
tama√±oPrecio>># /
.>>/ 0
Precio>>0 6
;>>6 7
_dbEntities?? 
.?? 
tama√±oPrecios?? %
.??% &
Add??& )
(??) *
tama√±oPrecio1??* 7
)??7 8
;??8 9
_dbEntities@@ 
.@@ 
SaveChanges@@ #
(@@# $
)@@$ %
;@@% &
}AA 	
publicCC 
Tama√±oPrecioCC  
obtenerTama√±oPrecioCC /
(CC/ 0
intCC0 3
IdCC4 6
)CC6 7
{DD 	
returnEE 
_dbEntitiesEE 
.EE 
tama√±oPreciosEE ,
.EE, -
FirstEE- 2
(EE2 3
oEE3 4
=>EE5 7
oEE8 9
.EE9 :
IdEE: <
==EE= ?
IdEE@ B
)EEB C
;EEC D
}FF 	
publicHH 
	ProductosHH 
obtenerProductoIdHH *
(HH* +
intHH+ .

IdProductoHH/ 9
)HH9 :
{II 	
returnJJ 
_dbEntitiesJJ 
.JJ 
	ProductosJJ (
.JJ( )
FirstJJ) .
(JJ. /
oJJ/ 0
=>JJ1 3
oJJ4 5
.JJ5 6
IdJJ6 8
==JJ9 ;

IdProductoJJ< F
)JJF G
;JJG H
}KK 	
publicMM 
voidMM 
editarTama√±oMM  
(MM  !
intMM! $
IdMM% '
,MM' (
stringMM) /
Tama√±oProductoMM0 >
,MM> ?
decimalMM@ G
PrecioMMH N
)MMN O
{NN 	
Tama√±oPrecioOO 
tama√±oPrecio1OO &
=OO' (
_dbEntitiesOO) 4
.OO4 5
tama√±oPreciosOO5 B
.OOB C
FirstOOC H
(OOH I
oOOI J
=>OOK M
oOON O
.OOO P
IdOOP R
==OOS U
IdOOV X
)OOX Y
;OOY Z
tama√±oPrecio1PP 
.PP 
Tama√±oProductoPP (
=PP) *
Tama√±oProductoPP+ 9
;PP9 :
tama√±oPrecio1QQ 
.QQ 
PrecioQQ  
=QQ! "
PrecioQQ# )
;QQ) *
_dbEntitiesRR 
.RR 
SaveChangesRR #
(RR# $
)RR$ %
;RR% &
}SS 	
publicTT 
voidTT !
eliminarTama√±oPrecioTT (
(TT( )
intTT) ,
IdTT- /
)TT/ 0
{UU 	
varVV 
	precioTamVV 
=VV 
_dbEntitiesVV '
.VV' (
tama√±oPreciosVV( 5
.VV5 6
FirstVV6 ;
(VV; <
oVV< =
=>VV> @
oVVA B
.VVB C
IdVVC E
==VVF H
IdVVI K
)VVK L
;VVL M
_dbEntitiesWW 
.WW 
tama√±oPreciosWW %
.WW% &
RemoveWW& ,
(WW, -
	precioTamWW- 6
)WW6 7
;WW7 8
_dbEntitiesXX 
.XX 
SaveChangesXX #
(XX# $
)XX$ %
;XX% &
}YY 	
public[[ 
Usuario[[ 
obtenerUsuario[[ %
([[% &
string[[& ,
username[[- 5
)[[5 6
{\\ 	
return]] 
_dbEntities]] 
.]] 
usuarios]] '
.]]' (
First]]( -
(]]- .
o]]. /
=>]]0 2
o]]3 4
.]]4 5
Correo]]5 ;
==]]< >
username]]? G
)]]G H
;]]H I
}^^ 	
public`` 
void`` 
editarProducto`` "
(``" #
int``# &
Id``' )
,``) *
	Productos``+ 4
	productos``5 >
)``> ?
{aa 	
varbb 
productobb 
=bb 
_dbEntitiesbb &
.bb& '
	Productosbb' 0
.bb0 1
Firstbb1 6
(bb6 7
obb7 8
=>bb9 ;
obb< =
.bb= >
Idbb> @
==bbA C
IdbbD F
)bbF G
;bbG H
productocc 
.cc 
Nombrecc 
=cc 
	productoscc '
.cc' (
Nombrecc( .
;cc. /
productodd 
.dd 
Descripciondd  
=dd! "
	productosdd# ,
.dd, -
Descripciondd- 8
;dd8 9
productoee 
.ee 
	UrlImagenee 
=ee  
	productosee! *
.ee* +
	UrlImagenee+ 4
;ee4 5
_dbEntitiesff 
.ff 
SaveChangesff #
(ff# $
)ff$ %
;ff% &
}gg 	
}hh 
}ii ‚
VD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\RegisterAdminRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface %
IRegisterAdminRepositorio .
{ 
List		 
<		 
PreguntaSeguridad		 
>		 
listarPreguntas		  /
(		/ 0
)		0 1
;		1 2
void

 
guardarUser

 
(

 '
AgregarAdminClaseIntermedia

 4
account

5 <
)

< =
;

= >
Usuario 
obtenerUsuario 
( 
string %
username& .
). /
;/ 0
} 
public 

class $
RegisterAdminRepositorio )
:* +%
IRegisterAdminRepositorio, E
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public $
RegisterAdminRepositorio '
(' (

DbEntities( 2

dbEntities3 =
)= >
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
PreguntaSeguridad %
>% &
listarPreguntas' 6
(6 7
)7 8
{ 	
return 
_dbEntities 
. 
preguntaSeguridads 1
.1 2
ToList2 8
(8 9
)9 :
;: ;
;< =
} 	
public 
void 
guardarUser 
(  '
AgregarAdminClaseIntermedia  ;
account< C
)C D
{ 	
Usuario 
user 
= 
new 
Usuario &
(& '
)' (
;( )
user 
. 
IdRol 
= 
$num 
; 
user 
. 
Nombre 
= 
account !
.! "
Nombre" (
;( )
user   
.   
Apellido   
=   
account   #
.  # $
Apellido  $ ,
;  , -
user!! 
.!! 

NroCelular!! 
=!! 
account!! %
.!!% &

NroCelular!!& 0
;!!0 1
user"" 
."" 
Correo"" 
="" 
account"" !
.""! "
Correo""" (
;""( )
user## 
.## 
Contrase√±a## 
=## 
account## %
.##% &
Contrase√±a##& 0
;##0 1
user$$ 
.$$ 
DNI$$ 
=$$ 
account$$ 
.$$ 
DNI$$ "
;$$" #
user%% 
.%% 
IdPreguntaSeguridad%% $
=%%% &
account%%' .
.%%. /
IdPreguntaSeguridad%%/ B
;%%B C
user&& 
.&& 
RespuestaPS&& 
=&& 
account&& &
.&&& '
RespuestaPS&&' 2
;&&2 3
_dbEntities'' 
.'' 
usuarios''  
.''  !
Add''! $
(''$ %
user''% )
)'') *
;''* +
_dbEntities(( 
.(( 
SaveChanges(( #
(((# $
)(($ %
;((% &
})) 	
public++ 
Usuario++ 
obtenerUsuario++ %
(++% &
string++& ,
username++- 5
)++5 6
{,, 	
return-- 
_dbEntities-- 
.-- 
usuarios-- '
.--' (
First--( -
(--- .
o--. /
=>--0 2
o--3 4
.--4 5
Correo--5 ;
==--< >
username--? G
)--G H
;--H I
}.. 	
}// 
}00 ÿ
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\TrackingRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface  
ITrackingRepositorio )
{ 
DetallePedido		 
obtenerEstado		 #
(		# $
string		$ *
CodTracking		+ 6
)		6 7
;		7 8
}

 
public 

class 
TrackingRepositorio $
:$ % 
ITrackingRepositorio& :
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
TrackingRepositorio "
(" #

DbEntities# -

dbEntities. 8
)8 9
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
DetallePedido 
obtenerEstado *
(* +
string+ 1
CodTracking2 =
)= >
{ 	
return 
_dbEntities 
. 
detallePedidos -
.+ ,
Include, 3
(3 4
o4 5
=>6 8
o9 :
.: ;
Pedido; A
)A B
.+ ,
Include, 3
(3 4
o4 5
=>6 8
o9 :
.: ;
Producto; C
)C D
.+ ,
FirstOrDefault, :
(: ;
o; <
=>= ?
o@ A
.A B
PedidoB H
.H I
CodTrackingI T
==U W
CodTrackingX c
)c d
;d e
} 	
} 
} À?
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\VenderRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IVenderRepositorio '
{		 
public

 
List

 
<

 
	Productos

 
>

 
obtenerProductos

 /
(

/ 0
)

0 1
;

1 2
	Productos 
obtenerProducto !
(! "
int" %

IdProducto& 0
)0 1
;1 2
int 
obtenerUltimoId 
( 
) 
; 
Tama√±oPrecio 
obtenerDetalle #
(# $
int$ '
IdTama√±oPrecio( 6
)6 7
;7 8
void 
agregarUsuario 
( "
ClienteClaseIntermedia 2
cliente3 :
): ;
;; <
int 
obtenerUltimoIdUser 
(  
)  !
;! "
void 
agregarDatosBd 
( 
List  
<  !
Pedido! '
>' (
Pedidos) 0
,0 1
List2 6
<6 7
DetallePedido7 D
>D E
DetallePedidosF T
)T U
;U V
int 
contarBoletas 
( 
) 
; 
void 
agregarBoleta 
( 
Boleta !
boleta" (
)( )
;) *
int !
obtenerUltimoIdBoleta !
(! "
)" #
;# $
Usuario 
obtenerUsuario 
( 
string %
username& .
). /
;/ 0
} 
public 

class 
VenderRepositorio "
:# $
IVenderRepositorio% 7
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
VenderRepositorio  
(  !

DbEntities! +

dbEntities, 6
)6 7
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
	Productos 
> 
obtenerProductos /
(/ 0
)0 1
{   	
return!! 
_dbEntities!! 
.!! 
	Productos!! (
.""( )
Include"") 0
(""0 1
$str""1 @
)""@ A
.##( )
ToList##) /
(##/ 0
)##0 1
;##1 2
}$$ 	
public&& 
	Productos&& 
obtenerProducto&& (
(&&( )
int&&) ,

IdProducto&&- 7
)&&7 8
{'' 	
return(( 
_dbEntities(( 
.(( 
	Productos(( (
.((( )
FirstOrDefault(() 7
(((7 8
o((8 9
=>((: <
o((= >
.((> ?
Id((? A
==((B D

IdProducto((E O
)((O P
;((P Q
})) 	
public++ 
int++ 
obtenerUltimoId++ "
(++" #
)++# $
{,, 	
return-- 
_dbEntities-- 
.-- 
pedidos-- &
.--& '
OrderBy--' .
(--. /
o--/ 0
=>--1 3
o--4 5
.--5 6
Id--6 8
)--8 9
.--9 :
Last--: >
(--> ?
)--? @
.--@ A
Id--A C
;--C D
}.. 	
public00 
Tama√±oPrecio00 
obtenerDetalle00 *
(00* +
int00+ .
IdTama√±oPrecio00/ =
)00= >
{11 	
return22 
_dbEntities22 
.22 
tama√±oPrecios22 ,
.22, -
First22- 2
(222 3
o223 4
=>225 7
o228 9
.229 :
Id22: <
==22= ?
IdTama√±oPrecio22@ N
)22N O
;22O P
}33 	
public55 
void55 
agregarUsuario55 "
(55" #"
ClienteClaseIntermedia55# 9
cliente55: A
)55A B
{66 	
Usuario77 
usuario77 
=77 
new77 !
Usuario77" )
(77) *
)77* +
;77+ ,
usuario88 
.88 
IdRol88 
=88 
$num88 
;88 
usuario99 
.99 
Nombre99 
=99 
cliente99 $
.99$ %
Nombre99% +
;99+ ,
usuario:: 
.:: 
Apellido:: 
=:: 
cliente:: &
.::& '
Apellido::' /
;::/ 0
usuario;; 
.;; 
DNI;; 
=;; 
cliente;; !
.;;! "
DNI;;" %
;;;% &
_dbEntities== 
.== 
usuarios==  
.==  !
Add==! $
(==$ %
usuario==% ,
)==, -
;==- .
_dbEntities>> 
.>> 
SaveChanges>> #
(>># $
)>>$ %
;>>% &
}?? 	
publicAA 
intAA 
obtenerUltimoIdUserAA &
(AA& '
)AA' (
{BB 	
returnCC 
_dbEntitiesCC 
.CC 
usuariosCC '
.CC' (
OrderByCC( /
(CC/ 0
oCC0 1
=>CC2 4
oCC5 6
.CC6 7
IdCC7 9
)CC9 :
.CC: ;
LastCC; ?
(CC? @
)CC@ A
.CCA B
IdCCB D
;CCD E
}DD 	
publicFF 
voidFF 
agregarDatosBdFF "
(FF" #
ListFF# '
<FF' (
PedidoFF( .
>FF. /
PedidosFF0 7
,FF7 8
ListFF9 =
<FF= >
DetallePedidoFF> K
>FFK L
DetallePedidosFFM [
)FF[ \
{GG 	
_dbEntitiesHH 
.HH 
pedidosHH 
.HH  
AddRangeHH  (
(HH( )
PedidosHH) 0
)HH0 1
;HH1 2
_dbEntitiesII 
.II 
detallePedidosII &
.II& '
AddRangeII' /
(II/ 0
DetallePedidosII0 >
)II> ?
;II? @
_dbEntitiesJJ 
.JJ 
SaveChangesJJ #
(JJ# $
)JJ$ %
;JJ% &
}KK 	
publicMM 
intMM 
contarBoletasMM  
(MM  !
)MM! "
{NN 	
returnOO 
_dbEntitiesOO 
.OO 
boletasOO &
.OO& '
CountOO' ,
(OO, -
)OO- .
;OO. /
}PP 	
publicRR 
voidRR 
agregarBoletaRR !
(RR! "
BoletaRR" (
boletaRR) /
)RR/ 0
{SS 	
_dbEntitiesTT 
.TT 
boletasTT 
.TT  
AddTT  #
(TT# $
boletaTT$ *
)TT* +
;TT+ ,
_dbEntitiesUU 
.UU 
SaveChangesUU #
(UU# $
)UU$ %
;UU% &
}VV 	
publicXX 
intXX !
obtenerUltimoIdBoletaXX (
(XX( )
)XX) *
{YY 	
returnZZ 
_dbEntitiesZZ 
.ZZ 
boletasZZ &
.ZZ& '
OrderByZZ' .
(ZZ. /
oZZ/ 0
=>ZZ1 3
oZZ4 5
.ZZ5 6
IdZZ6 8
)ZZ8 9
.ZZ9 :
LastZZ: >
(ZZ> ?
)ZZ? @
.ZZ@ A
IdZZA C
;ZZC D
}[[ 	
public]] 
Usuario]] 
obtenerUsuario]] %
(]]% &
string]]& ,
username]]- 5
)]]5 6
{^^ 	
return__ 
_dbEntities__ 
.__ 
usuarios__ '
.__' (
First__( -
(__- .
o__. /
=>__0 2
o__3 4
.__4 5
Correo__5 ;
==__< >
username__? G
)__G H
;__H I
}`` 	
}aa 
}bb œ
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\VentasRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IVentasRepositorio '
{ 
List		 
<		 
Boleta		 
>		 
listarBoletas		 "
(		" #
)		# $
;		$ %
Usuario

 
obtenerUsuario

 
(

 
string

 %
username

& .
)

. /
;

/ 0
} 
public 

class 
VentasRepositorio "
:# $
IVentasRepositorio% 7
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
VentasRepositorio  
(  !

DbEntities! +

dbEntities, 6
)6 7
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
Boleta 
> 
listarBoletas )
() *
)* +
{ 	
return 
_dbEntities 
. 
boletas &
.  !
Include! (
(( )
$str) 2
)2 3
.  !
Where! &
(& '
o' (
=>) +
o, -
.- .
Pedidos. 5
.5 6
Any6 9
(9 :
x: ;
=>< >
x? @
.@ A
EstadoA G
==H J
$numK L
)L M
)M N
.N O
ToListO U
(U V
)V W
;W X
} 	
public 
Usuario 
obtenerUsuario %
(% &
string& ,
username- 5
)5 6
{ 	
return 
_dbEntities 
. 
usuarios '
.' (
First( -
(- .
o. /
=>0 2
o3 4
.4 5
Correo5 ;
==< >
username? G
)G H
;H I
} 	
}   
}!! ô
XD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\AgregarAdminClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class '
AgregarAdminClaseIntermedia ,
{ 
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 

NroCelular  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
Correo 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
Contrase√±a		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
DNI

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 
int 
IdPreguntaSeguridad &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RespuestaPS !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} í
SD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\ClienteClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class "
ClienteClaseIntermedia '
{ 
public 
string 
DNI 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
}		 
}

 ⁄
SD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\ComprarClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class "
ComprarClaseIntermedia '
{ 
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Estado 
{ 
get 
;  
set! $
;$ %
}& '
public 
decimal 
Monto 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CodTracking !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
	NroBoleta		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
int

 

IdProducto

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
int 
IdPedido 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
IdTama√±oPrecio !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
Precio 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ∂
TD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\RegistroClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class #
RegistroClaseIntermedia (
{ 
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	Apellidos 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 

NroCelular		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
correo

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
contrase√±a  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

Referencia  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
IdPreguntaSeguridad &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RespuestaPS !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} 