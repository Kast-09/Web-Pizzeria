≥@
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\AuthController.cs
	namespace

 	
Maxdel


 
.

 
Controllers

 
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 

DbEntities 
_dbEntities &
;& '
public 
AuthController 
( 

DbEntities (

dbEntities) 3
)3 4
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public 
IActionResult 
Login "
(" #
string# )
correo* 0
,0 1
string2 8
contrase√±a9 C
)C D
{ 	
if 
( 
_dbEntities 
. 
usuarios $
.$ %
Any% (
(( )
x) *
=>+ -
x. /
./ 0
Correo0 6
==7 9
correo: @
&&A C
xD E
.E F
Contrase√±aF P
==Q S
contrase√±aT ^
)^ _
)_ `
{ 
var 
claims 
= 
new  
List! %
<% &
Claim& +
>+ ,
(, -
)- .
{   
new!! 
Claim!! 
(!! 

ClaimTypes!! (
.!!( )
Name!!) -
,!!- .
correo!!/ 5
)!!5 6
,!!6 7
}"" 
;"" 
var## 
claimsIdentity## "
=### $
new##% (
ClaimsIdentity##) 7
(##7 8
claims##8 >
,##> ?(
CookieAuthenticationDefaults##@ \
.##\ ] 
AuthenticationScheme##] q
)##q r
;##r s
var$$ 
claimsPrincipal$$ #
=$$$ %
new$$& )
ClaimsPrincipal$$* 9
($$9 :
claimsIdentity$$: H
)$$H I
;$$I J
HttpContext&& 
.&& 
SignInAsync&& '
(&&' (
claimsPrincipal&&( 7
)&&7 8
;&&8 9
var(( 
usuario(( 
=(( 
_dbEntities(( )
.(() *
usuarios((* 2
.((2 3
First((3 8
(((8 9
x((9 :
=>((; =
x((> ?
.((? @
Correo((@ F
==((G I
correo((J P
&&((Q S
x((T U
.((U V
Contrase√±a((V `
==((a c
contrase√±a((d n
)((n o
;((o p
if** 
(** 
usuario** 
.** 
IdTipo** !
==**" $
$num**% &
)**& '
{++ 
return,, 
RedirectToAction,, +
(,,+ ,
$str,,, 3
,,,3 4
$str,,5 @
),,@ A
;,,A B
}-- 
else.. 
{// 
return00 
RedirectToAction00 +
(00+ ,
$str00, 3
,003 4
$str005 ;
)00; <
;00< =
}11 
}22 
if33 
(33 
correo33 
==33 
null33 
)33 

ModelState33  *
.33* +
AddModelError33+ 8
(338 9
$str339 A
,33A B
$str33C h
)33h i
;33i j
else44 
if44 
(44 
contrase√±a44 
==44  "
null44# '
)44' (

ModelState44) 3
.443 4
AddModelError444 A
(44A B
$str44B N
,44N O
$str44P y
)44y z
;44z {
else55 

ModelState55 
.55 
AddModelError55 )
(55) *
$str55* 5
,555 6
$str557 W
)55W X
;55X Y
return66 
View66 
(66 
)66 
;66 
}77 	
[99 	
HttpGet99	 
]99 
public:: 
IActionResult:: 
Register:: %
(::% &
)::& '
{;; 	
return<< 
View<< 
(<< 
)<< 
;<< 
}== 	
public>> 
IActionResult>> 
Prueba>> #
(>># $
)>>$ %
{?? 	
return@@ 
View@@ 
(@@ 
)@@ 
;@@ 
}AA 	
[CC 	
HttpPostCC	 
]CC 
publicDD 
IActionResultDD 
RegisterDD %
(DD% &#
RegistroClaseIntermediaDD& =
accountDD> E
)DDE F
{EE 	
intFF 
auxFF 
=FF 
_dbEntitiesFF !
.FF! "
usuariosFF" *
.FF* +
CountFF+ 0
(FF0 1
)FF1 2
;FF2 3
UsuarioGG 
userGG 
=GG 
newGG 
UsuarioGG &
(GG& '
)GG' (
;GG( )
DireccionesHH 
direccionesHH #
=HH$ %
newHH& )
DireccionesHH* 5
(HH5 6
)HH6 7
;HH7 8
ifJJ 
(JJ 

ModelStateJJ 
.JJ 
IsValidJJ "
)JJ" #
{KK 
userLL 
.LL 
IdTipoLL 
=LL 
$numLL 
;LL  
userMM 
.MM 
NombreMM 
=MM 
accountMM %
.MM% &
NombreMM& ,
;MM, -
userNN 
.NN 
ApellidoNN 
=NN 
accountNN  '
.NN' (
	ApellidosNN( 1
;NN1 2
userOO 
.OO 

NroCelularOO 
=OO  !
accountOO" )
.OO) *

NroCelularOO* 4
;OO4 5
userPP 
.PP 
CorreoPP 
=PP 
accountPP %
.PP% &
correoPP& ,
;PP, -
userQQ 
.QQ 
Contrase√±aQQ 
=QQ  !
accountQQ" )
.QQ) *
contrase√±aQQ* 4
;QQ4 5
direccionesRR 
.RR 
	IdUsuarioRR %
=RR& '
auxRR( +
+RR, -
$numRR. /
;RR/ 0
direccionesSS 
.SS 
	DireccionSS %
=SS& '
accountSS( /
.SS/ 0
	DireccionSS0 9
;SS9 :
direccionesTT 
.TT 

ReferenciaTT &
=TT' (
accountTT) 0
.TT0 1

ReferenciaTT1 ;
;TT; <
_dbEntitiesUU 
.UU 
usuariosUU $
.UU$ %
AddUU% (
(UU( )
userUU) -
)UU- .
;UU. /
_dbEntitiesVV 
.VV 
direccionesVV '
.VV' (
AddVV( +
(VV+ ,
direccionesVV, 7
)VV7 8
;VV8 9
_dbEntitiesWW 
.WW 
SaveChangesWW '
(WW' (
)WW( )
;WW) *
TempDataXX 
[XX 
$strXX )
]XX) *
=XX+ ,
$strXX- S
;XXS T
returnYY 
RedirectToActionYY '
(YY' (
$strYY( /
)YY/ 0
;YY0 1
}ZZ 
TempData[[ 
[[[ 
$str[[ %
][[% &
=[[' (
$str[[) @
;[[@ A
return\\ 
View\\ 
(\\ 
$str\\ "
,\\" #
account\\$ +
)\\+ ,
;\\, -
}]] 	
[__ 	
HttpGet__	 
]__ 
public`` 
IActionResult`` 
Logout`` #
(``# $
)``$ %
{aa 	
HttpContextbb 
.bb 
SignOutAsyncbb $
(bb$ %
)bb% &
;bb& '
returncc 
RedirectToActioncc #
(cc# $
$strcc$ +
)cc+ ,
;cc, -
}dd 	
}ee 
}ff —
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\HomeAdminController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
public 

class 
HomeAdminController $
:% &

Controller' 1
{ 
public		 
IActionResult		 
Index		 "
(		" #
)		# $
{

 	
return 
View 
( 
) 
; 
} 	
} 
} Ü
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\HomeController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
public

 

class

 
HomeController

 
:

  !

Controller

" ,
{ 
private 

DbEntities 
_dbEntities &
;& '
private 
readonly 
IHomeRepositorio )
_homeRepositorio* :
;: ;
public 
HomeController 
( 

DbEntities (

dbEntities) 3
,3 4
IHomeRepositorio5 E
homeRepositorioF U
)U V
{ 	
_dbEntities 
= 

dbEntities $
;$ %
_homeRepositorio 
= 
homeRepositorio .
;. /
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
About "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public   
IActionResult   
Error   "
(  " #
)  # $
{!! 	
return"" 
View"" 
("" 
new"" 
ErrorViewModel"" *
{""+ ,
	RequestId""- 6
=""7 8
Activity""9 A
.""A B
Current""B I
?""I J
.""J K
Id""K M
??""N P
HttpContext""Q \
.""\ ]
TraceIdentifier""] l
}""m n
)""n o
;""o p
}## 	
}$$ 
}%% π
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\MenuController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
public

 

class

 
MenuController

 
:

  !

Controller

" ,
{ 
private 

DbEntities 
_dbEntities &
;& '
public 
MenuController 
( 

DbEntities (

dbEntities) 3
)3 4
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
var 
ListaProductos 
=  !
_dbEntities" -
.- .
	Productos. 7
.7 8
ToList8 >
(> ?
)? @
;@ A
return 
View 
( 
ListaProductos &
)& '
;' (
} 	
} 
} Î9
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\PersonaController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
[		 
	Authorize		 
]		 
public

 

class

 
PersonaController

 "
:

# $

Controller

% /
{ 

DbEntities 
_dbEntities 
; 
public 
PersonaController  
(  !

DbEntities! +

dbEntities, 6
)6 7
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
Id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
var 
persona 
= 
_dbEntities %
.% &
usuarios& .
.. /
First/ 4
(4 5
o5 6
=>7 9
o: ;
.; <
Id< >
==? A
IdB D
)D E
;E F
ViewBag 
. 
Direcciones 
=  !
_dbEntities" -
.- .
direcciones. 9
.9 :
Where: ?
(? @
o@ A
=>B D
oE F
.F G
	IdUsuarioG P
==Q S
IdT V
)V W
.W X
ToListX ^
(^ _
)_ `
;` a
return 
View 
( 
persona 
)  
;  !
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
EditarPersona *
(* +
)+ ,
{ 	
int 
id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
var 
persona 
= 
_dbEntities %
.% &
usuarios& .
.. /
First/ 4
(4 5
o5 6
=>7 9
o: ;
.; <
Id< >
==? A
idB D
)D E
;E F
return 
View 
( 
persona 
)  
;  !
} 	
[   	
HttpPost  	 
]   
public!! 
IActionResult!! 
EditarPersona!! *
(!!* +
int!!+ .
id!!/ 1
,!!1 2
Usuario!!3 :
user!!; ?
)!!? @
{"" 	
var## 
Persona## 
=## 
_dbEntities## %
.##% &
usuarios##& .
.##. /
First##/ 4
(##4 5
o##5 6
=>##7 9
o##: ;
.##; <
Id##< >
==##? A
id##B D
)##D E
;##E F
Persona$$ 
.$$ 
Nombre$$ 
=$$ 
user$$ !
.$$! "
Nombre$$" (
;$$( )
Persona%% 
.%% 
Apellido%% 
=%% 
user%% #
.%%# $
Apellido%%$ ,
;%%, -
Persona&& 
.&& 

NroCelular&& 
=&&  
user&&! %
.&&% &

NroCelular&&& 0
;&&0 1
Persona'' 
.'' 
Correo'' 
='' 
user'' !
.''! "
Correo''" (
;''( )
_dbEntities(( 
.(( 
SaveChanges(( #
(((# $
)(($ %
;((% &
return)) 
RedirectToAction)) #
())# $
$str))$ +
,))+ ,
$str))- 6
)))6 7
;))7 8
}** 	
public++ 
IActionResult++ 
AgregaDireccion++ ,
(++, -
)++- .
{,, 	
return-- 
View-- 
(-- 
)-- 
;-- 
}.. 	
public// 
IActionResult// 
NuevaDireccion// +
(//+ ,
int//, /
retorno//0 7
,//7 8
string//9 ?
	Direccion//@ I
,//I J
string//K Q

Referencia//R \
)//\ ]
{00 	
int11 
Id11 
=11 
GetLoggedUser11 "
(11" #
)11# $
.11$ %
Id11% '
;11' (
Direcciones22 
	direccion22 !
=22" #
new22$ '
Direcciones22( 3
(223 4
)224 5
;225 6
	direccion33 
.33 
	IdUsuario33 
=33  !
Id33" $
;33$ %
	direccion44 
.44 
	Direccion44 
=44  !
	Direccion44" +
;44+ ,
	direccion55 
.55 

Referencia55  
=55! "

Referencia55# -
;55- .
_dbEntities66 
.66 
direcciones66 #
.66# $
Add66$ '
(66' (
	direccion66( 1
)661 2
;662 3
_dbEntities77 
.77 
SaveChanges77 #
(77# $
)77$ %
;77% &
if88 
(88 
retorno88 
==88 
$num88 
)88 
return88 #
RedirectToAction88$ 4
(884 5
$str885 <
,88< =
$str88> G
)88G H
;88H I
else99 
return99 
RedirectToAction99 (
(99( )
$str99) 0
,990 1
$str992 B
)99B C
;99C D
}:: 	
public;; 
IActionResult;; 
EliminarDireccion;; .
(;;. /
int;;/ 2
id;;3 5
);;5 6
{<< 	
var== 
	direccion== 
=== 
_dbEntities== '
.==' (
direcciones==( 3
.==3 4
First==4 9
(==9 :
o==: ;
=>==< >
o==? @
.==@ A
Id==A C
====D F
id==G I
)==I J
;==J K
_dbEntities>> 
.>> 
direcciones>> #
.>># $
Remove>>$ *
(>>* +
	direccion>>+ 4
)>>4 5
;>>5 6
_dbEntities?? 
.?? 
SaveChanges?? #
(??# $
)??$ %
;??% &
return@@ 
RedirectToAction@@ #
(@@# $
$str@@$ +
,@@+ ,
$str@@- 6
)@@6 7
;@@7 8
}AA 	
privateBB 
UsuarioBB 
GetLoggedUserBB %
(BB% &
)BB& '
{CC 	
varDD 
claimDD 
=DD 
HttpContextDD #
.DD# $
UserDD$ (
.DD( )
ClaimsDD) /
.DD/ 0
FirstDD0 5
(DD5 6
)DD6 7
;DD7 8
stringEE 
usernameEE 
=EE 
claimEE #
.EE# $
ValueEE$ )
;EE) *
returnFF 
_dbEntitiesFF 
.FF 
usuariosFF '
.FF' (
FirstFF( -
(FF- .
oFF. /
=>FF0 2
oFF3 4
.FF4 5
CorreoFF5 ;
==FF< >
usernameFF? G
)FFG H
;FFH I
}GG 	
}HH 
}II Œ§
VD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\ProcesarCompraController.cs
	namespace		 	
Maxdel		
 
.		 
Controllers		 
{

 
public 

class $
ProcesarCompraController )
:* +

Controller, 6
{ 

DbEntities 
_dbEntities 
; 
public $
ProcesarCompraController '
(' (

DbEntities( 2

dbEntities3 =
)= >
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Detalle $
($ %
int% (

IdProducto) 3
)3 4
{ 	
var 
Producto 
= 
_dbEntities &
.& '
	Productos' 0
.0 1
First1 6
(6 7
o7 8
=>9 ;
o< =
.= >
Id> @
==A C

IdProductoD N
)N O
;O P
ViewBag 
. 
Tama√±oPrecio  
=! "
_dbEntities# .
.. /
tama√±oPrecios/ <
.< =
Where= B
(B C
oC D
=>E G
oH I
.I J

IdProductoJ T
==U W

IdProductoX b
)b c
.c d
ToListd j
(j k
)k l
;l m
return 
View 
( 
Producto  
)  !
;! "
} 	
[ 	
HttpPost	 
] 
[ 	
	Authorize	 
] 
public 
IActionResult 
Detalle $
($ %
int% (

IdProducto) 3
,3 4"
ComprarClaseIntermedia5 K
claseL Q
)Q R
{ 	
int 
Id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
Pedido 
pedido 
= 
new 
Pedido  &
(& '
)' (
;( )
DetallePedido 
detallePedido '
=( )
new* -
DetallePedido. ;
(; <
)< =
;= >
pedido   
.   
	IdUsuario   
=   
Id   !
;  ! "
pedido!! 
.!! 
Estado!! 
=!! 
$num!! 
;!! 
_dbEntities"" 
."" 
pedidos"" 
.""  
Add""  #
(""# $
pedido""$ *
)""* +
;""+ ,
_dbEntities## 
.## 
SaveChanges## #
(### $
)##$ %
;##% &
var$$ 
pedidos$$ 
=$$ 
_dbEntities$$ %
.$$% &
pedidos$$& -
.$$- .
ToList$$. 4
($$4 5
)$$5 6
;$$6 7
Pedido%% 
	pedidoAux%% 
=%% 
new%% "
Pedido%%# )
(%%) *
)%%* +
;%%+ ,
foreach&& 
(&& 
var&& 
item&& 
in&&  
pedidos&&! (
)&&( )
{'' 
	pedidoAux(( 
.(( 
Id(( 
=(( 
item(( #
.((# $
Id(($ &
;((& '
})) 
detallePedido** 
.** 

IdProducto** $
=**% &

IdProducto**' 1
;**1 2
detallePedido++ 
.++ 
IdPedido++ "
=++# $
	pedidoAux++% .
.++. /
Id++/ 1
;++1 2
detallePedido,, 
.,, 
IdTama√±oPrecio,, (
=,,) *
clase,,+ 0
.,,0 1
IdTama√±oPrecio,,1 ?
;,,? @
detallePedido-- 
.-- 
Cantidad-- "
=--# $
clase--% *
.--* +
Cantidad--+ 3
;--3 4
Tama√±oPrecio.. 
tama√±oPrecio.. %
=..& '
_dbEntities..( 3
...3 4
tama√±oPrecios..4 A
...A B
First..B G
(..G H
o..H I
=>..J L
o..M N
...N O
Id..O Q
==..R T
detallePedido..U b
...b c
IdTama√±oPrecio..c q
)..q r
;..r s
detallePedido// 
.// 
Tama√±oProducto// (
=//) *
tama√±oPrecio//+ 7
.//7 8
Tama√±oProducto//8 F
;//F G
detallePedido00 
.00 
precio00  
=00! "
tama√±oPrecio00# /
.00/ 0
Precio000 6
;006 7
Pedido11 

pedidoAux211 
=11 
new11  #
Pedido11$ *
(11* +
)11+ ,
;11, -

pedidoAux222 
=22 
_dbEntities22 $
.22$ %
pedidos22% ,
.22, -
First22- 2
(222 3
o223 4
=>225 7
o228 9
.229 :
Id22: <
==22= ?
	pedidoAux22@ I
.22I J
Id22J L
)22L M
;22M N

pedidoAux233 
.33 
Monto33 
=33 
clase33 $
.33$ %
Cantidad33% -
*33. /
tama√±oPrecio330 <
.33< =
Precio33= C
;33C D
_dbEntities44 
.44 
SaveChanges44 #
(44# $
)44$ %
;44% &
_dbEntities55 
.55 
detallePedidos55 &
.55& '
Add55' *
(55* +
detallePedido55+ 8
)558 9
;559 :
_dbEntities66 
.66 
SaveChanges66 #
(66# $
)66$ %
;66% &
return88 
RedirectToAction88 #
(88# $
$str88$ +
,88+ ,
$str88- =
)88= >
;88> ?
}99 	
[:: 	
	Authorize::	 
]:: 
public;; 
IActionResult;; 
Cesta;; "
(;;" #
);;# $
{<< 	
int== 
Id== 
=== 
GetLoggedUser== "
(==" #
)==# $
.==$ %
Id==% '
;==' (
ViewBag?? 
.?? 

DatosCesta?? 
=??  
_dbEntities??! ,
.??, -
detallePedidos??- ;
.@@ 
Include@@ 
(@@ 
o@@ 
=>@@ !
o@@" #
.@@# $
Producto@@$ ,
)@@, -
.AA 
IncludeAA 
(AA 
oAA 
=>AA !
oAA" #
.AA# $
PedidoAA$ *
)AA* +
.BB 
IncludeBB 
(BB 
oBB 
=>BB !
oBB" #
.BB# $
PedidoBB$ *
.BB* +
EstadoFKBB+ 3
)BB3 4
.CC 
WhereCC 
(CC 
oCC 
=>CC 
oCC  !
.CC! "
PedidoCC" (
.CC( )
	IdUsuarioCC) 2
==CC3 5
IdCC6 8
&&CC9 ;
oCC< =
.CC= >
PedidoCC> D
.CCD E
EstadoCCE K
==CCL N
$numCCO P
)CCP Q
.CCQ R
ToListCCR X
(CCX Y
)CCY Z
;CCZ [
ViewBagEE 
.EE 
DireccionesEE 
=EE  !
_dbEntitiesEE" -
.EE- .
direccionesEE. 9
.FF 
WhereFF 
(FF 
oFF 
=>FF 
oFF  !
.FF! "
	IdUsuarioFF" +
==FF, .
IdFF/ 1
)FF1 2
;FF2 3
returnGG 
ViewGG 
(GG 
)GG 
;GG 
}HH 	
privateII 
UsuarioII 
GetLoggedUserII %
(II% &
)II& '
{JJ 	
varKK 
claimKK 
=KK 
HttpContextKK #
.KK# $
UserKK$ (
.KK( )
ClaimsKK) /
.KK/ 0
FirstKK0 5
(KK5 6
)KK6 7
;KK7 8
stringLL 
usernameLL 
=LL 
claimLL #
.LL# $
ValueLL$ )
;LL) *
returnMM 
_dbEntitiesMM 
.MM 
usuariosMM '
.MM' (
FirstMM( -
(MM- .
oMM. /
=>MM0 2
oMM3 4
.MM4 5
CorreoMM5 ;
==MM< >
usernameMM? G
)MMG H
;MMH I
}NN 	
privatePP 
stringPP 
generarCodTrackingPP )
(PP) *
intPP* -
IdPP. 0
)PP0 1
{QQ 	
stringRR 
codTrackingRR 
=RR  
$strRR! &
;RR& '
UsuarioSS 
tempSS 
=SS 
_dbEntitiesSS &
.SS& '
usuariosSS' /
.SS/ 0
FirstSS0 5
(SS5 6
oSS6 7
=>SS8 :
oSS; <
.SS< =
IdSS= ?
==SS@ B
IdSSC E
)SSE F
;SSF G
stringTT 
temp1TT 
=TT 
tempTT 
.TT  
NombreTT  &
;TT& '
codTrackingUU 
+=UU 
temp1UU  
[UU  !
$numUU! "
]UU" #
;UU# $
temp1VV 
=VV 
tempVV 
.VV 
ApellidoVV !
;VV! "
codTrackingWW 
+=WW 
temp1WW  
[WW  !
$numWW! "
]WW" #
;WW# $
intXX 
nroXX 
=XX 
_dbEntitiesXX !
.XX! "
nroTrackingsXX" .
.XX. /
FirstXX/ 4
(XX4 5
oXX5 6
=>XX7 9
oXX: ;
.XX; <
IdXX< >
==XX? A
$numXXB C
)XXC D
.XXD E
NumeroXXE K
;XXK L
temp1YY 
=YY 
nroYY 
.YY 
ToStringYY  
(YY  !
)YY! "
;YY" #
intZZ 
cantZZ 
=ZZ 
temp1ZZ 
.ZZ 
LengthZZ #
;ZZ# $
int[[ 
max[[ 
=[[ 
$num[[ 
-[[ 
cant[[ 
;[[ 
for\\ 
(\\ 
int\\ 
i\\ 
=\\ 
$num\\ 
;\\ 
i\\ 
<\\ 
max\\ "
;\\" #
i\\$ %
++\\% '
)\\' (
{]] 
codTracking^^ 
+=^^ 
$str^^ "
;^^" #
}__ 
codTracking`` 
+=`` 
temp1``  
;``  !
NroTrackingaa 
nroTrackingaa #
=aa$ %
newaa& )
NroTrackingaa* 5
(aa5 6
)aa6 7
;aa7 8
nroTrackingbb 
=bb 
_dbEntitiesbb %
.bb% &
nroTrackingsbb& 2
.bb2 3
Firstbb3 8
(bb8 9
obb9 :
=>bb; =
obb> ?
.bb? @
Idbb@ B
==bbC E
$numbbF G
)bbG H
;bbH I
nroTrackingcc 
.cc 
Numerocc 
++cc  
;cc  !
_dbEntitiesdd 
.dd 
SaveChangesdd #
(dd# $
)dd$ %
;dd% &
returnee 
codTrackingee 
;ee 
}ff 	
[hh 	
HttpGethh	 
]hh 
[ii 	
	Authorizeii	 
]ii 
publicjj 
IActionResultjj 
Deletejj #
(jj# $
intjj$ '
idjj( *
)jj* +
{kk 	
varll 
pedidoDbll 
=ll 
_dbEntitiesll &
.ll& '
pedidosll' .
.ll. /
Firstll/ 4
(ll4 5
oll5 6
=>ll7 9
oll: ;
.ll; <
Idll< >
==ll? A
idllB D
)llD E
;llE F
_dbEntitiesmm 
.mm 
pedidosmm 
.mm  
Removemm  &
(mm& '
pedidoDbmm' /
)mm/ 0
;mm0 1
_dbEntitiesnn 
.nn 
SaveChangesnn #
(nn# $
)nn$ %
;nn% &
varoo 
	detalleDboo 
=oo 
_dbEntitiesoo '
.oo' (
detallePedidosoo( 6
.oo6 7
Firstoo7 <
(oo< =
ooo= >
=>oo? A
oooB C
.ooC D
IdPedidoooD L
==ooM O
idooP R
)ooR S
;ooS T
_dbEntitiespp 
.pp 
detallePedidospp &
.pp& '
Removepp' -
(pp- .
	detalleDbpp. 7
)pp7 8
;pp8 9
_dbEntitiesqq 
.qq 
SaveChangesqq #
(qq# $
)qq$ %
;qq% &
returnss 
RedirectToActionss #
(ss# $
$strss$ +
,ss+ ,
$strss- =
)ss= >
;ss> ?
}tt 	
[uu 	
	Authorizeuu	 
]uu 
publicvv 
IActionResultvv 
PedidoExitovv (
(vv( )
intvv) ,
IdDireccionvv- 8
)vv8 9
{ww 	
ViewBagxx 
.xx 
nroTrackingxx 
=xx  !
Comprarxx" )
(xx) *
IdDireccionxx* 5
)xx5 6
;xx6 7
returnyy 
Viewyy 
(yy 
)yy 
;yy 
}zz 	
private|| 
string|| 
Comprar|| 
(|| 
int|| "
IdDireccion||# .
)||. /
{}} 	
int~~ 
Id~~ 
=~~ 
GetLoggedUser~~ "
(~~" #
)~~# $
.~~$ %
Id~~% '
;~~' (
List 
< 
Pedido 
> 
pedidos  
=! "
new# &
List' +
<+ ,
Pedido, 2
>2 3
(3 4
)4 5
;5 6
pedidos
ÄÄ 
=
ÄÄ 
_dbEntities
ÄÄ !
.
ÄÄ! "
pedidos
ÄÄ" )
.
ÄÄ) *
Where
ÄÄ* /
(
ÄÄ/ 0
o
ÄÄ0 1
=>
ÄÄ2 4
o
ÄÄ5 6
.
ÄÄ6 7
	IdUsuario
ÄÄ7 @
==
ÄÄA C
Id
ÄÄD F
&&
ÄÄG I
o
ÄÄJ K
.
ÄÄK L
Estado
ÄÄL R
==
ÄÄS U
$num
ÄÄV W
)
ÄÄW X
.
ÄÄX Y
ToList
ÄÄY _
(
ÄÄ_ `
)
ÄÄ` a
;
ÄÄa b
int
ÅÅ 
IdBoleta
ÅÅ 
=
ÅÅ 
generarNroBoleta
ÅÅ +
(
ÅÅ+ ,
IdDireccion
ÅÅ, 7
)
ÅÅ7 8
;
ÅÅ8 9
string
ÇÇ 
codTracking
ÇÇ 
=
ÇÇ   
generarCodTracking
ÇÇ! 3
(
ÇÇ3 4
Id
ÇÇ4 6
)
ÇÇ6 7
;
ÇÇ7 8
for
ÉÉ 
(
ÉÉ 
int
ÉÉ 
i
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
i
ÉÉ 
<
ÉÉ 
pedidos
ÉÉ  '
.
ÉÉ' (
Count
ÉÉ( -
;
ÉÉ- .
i
ÉÉ/ 0
++
ÉÉ0 2
)
ÉÉ2 3
{
ÑÑ 
pedidos
ÖÖ 
[
ÖÖ 
i
ÖÖ 
]
ÖÖ 
.
ÖÖ 
Estado
ÖÖ !
=
ÖÖ" #
$num
ÖÖ$ %
;
ÖÖ% &
pedidos
ÜÜ 
[
ÜÜ 
i
ÜÜ 
]
ÜÜ 
.
ÜÜ 
CodTracking
ÜÜ &
=
ÜÜ' (
codTracking
ÜÜ) 4
;
ÜÜ4 5
pedidos
áá 
[
áá 
i
áá 
]
áá 
.
áá 
IdBoleta
áá #
=
áá$ %
IdBoleta
áá& .
;
áá. /
}
àà 
_dbEntities
ââ 
.
ââ 
SaveChanges
ââ #
(
ââ# $
)
ââ$ %
;
ââ% &
return
ää 
codTracking
ää 
;
ää 
}
ãã 	
private
åå 
int
åå 
generarNroBoleta
åå $
(
åå$ %
int
åå% (
IdDireccion
åå) 4
)
åå4 5
{
çç 	
string
éé 
	nroBoleta
éé 
=
éé 
$str
éé %
;
éé% &
int
èè 
aux2
èè 
;
èè 
int
êê 
nroTemp
êê 
=
êê 
_dbEntities
êê %
.
êê% &
boletas
êê& -
.
êê- .
Count
êê. 3
(
êê3 4
)
êê4 5
;
êê5 6
aux2
ëë 
=
ëë 
nroTemp
ëë 
;
ëë 
nroTemp
íí 
++
íí 
;
íí 
string
ìì 
aux
ìì 
=
ìì 
nroTemp
ìì  
.
ìì  !
ToString
ìì! )
(
ìì) *
)
ìì* +
;
ìì+ ,
nroTemp
îî 
=
îî 
aux
îî 
.
îî 
Length
îî  
;
îî  !
nroTemp
ïï 
=
ïï 
$num
ïï 
-
ïï 
nroTemp
ïï !
;
ïï! "
for
ññ 
(
ññ 
int
ññ 
i
ññ 
=
ññ 
$num
ññ 
;
ññ 
i
ññ 
<
ññ 
nroTemp
ññ  '
;
ññ' (
i
ññ) *
++
ññ* ,
)
ññ, -
{
óó 
	nroBoleta
òò 
+=
òò 
$str
òò  
;
òò  !
}
ôô 
	nroBoleta
öö 
+=
öö 
aux
öö 
;
öö 
DateTime
úú 
fecha
úú 
=
úú 
new
úú  
DateTime
úú! )
(
úú) *
DateTime
úú* 2
.
úú2 3
Now
úú3 6
.
úú6 7
Year
úú7 ;
,
úú; <
DateTime
ùù( 0
.
ùù0 1
Now
ùù1 4
.
ùù4 5
Month
ùù5 :
,
ùù: ;
DateTime
ûû( 0
.
ûû0 1
Now
ûû1 4
.
ûû4 5
Day
ûû5 8
,
ûû8 9
DateTime
üü( 0
.
üü0 1
Now
üü1 4
.
üü4 5
Hour
üü5 9
,
üü9 :
DateTime
††( 0
.
††0 1
Now
††1 4
.
††4 5
Minute
††5 ;
,
††; <
DateTime
°°( 0
.
°°0 1
Now
°°1 4
.
°°4 5
Second
°°5 ;
)
°°; <
;
°°< =
int
££ 
Id
££ 
=
££ 
GetLoggedUser
££ "
(
££" #
)
££# $
.
££$ %
Id
££% '
;
££' (
var
§§ 
montos
§§ 
=
§§ 
_dbEntities
§§ $
.
§§$ %
pedidos
§§% ,
.
§§, -
Where
§§- 2
(
§§2 3
o
§§3 4
=>
§§5 7
o
§§8 9
.
§§9 :
	IdUsuario
§§: C
==
§§D F
Id
§§G I
&&
§§J L
o
§§M N
.
§§N O
Estado
§§O U
==
§§V X
$num
§§Y Z
)
§§Z [
.
§§[ \
ToList
§§\ b
(
§§b c
)
§§c d
;
§§d e
decimal
•• 
monto
•• 
=
•• 
$num
•• 
;
•• 
foreach
ßß 
(
ßß 
var
ßß 
item
ßß 
in
ßß  
montos
ßß! '
)
ßß' (
{
®® 
monto
©© 
+=
©© 
(
©© 
decimal
©© !
)
©©! "
item
©©" &
.
©©& '
Monto
©©' ,
;
©©, -
}
™™ 
Boleta
¨¨ 
boleta
¨¨ 
=
¨¨ 
new
¨¨ 
Boleta
¨¨  &
(
¨¨& '
)
¨¨' (
;
¨¨( )
boleta
≠≠ 
.
≠≠ 
Fecha
≠≠ 
=
≠≠ 
fecha
≠≠  
;
≠≠  !
boleta
ÆÆ 
.
ÆÆ 
	NroBoleta
ÆÆ 
=
ÆÆ 
	nroBoleta
ÆÆ (
;
ÆÆ( )
boleta
ØØ 
.
ØØ 

MontoTotal
ØØ 
=
ØØ 
monto
ØØ  %
;
ØØ% &
var
∞∞ 
	direccion
∞∞ 
=
∞∞ 
_dbEntities
∞∞ '
.
∞∞' (
direcciones
∞∞( 3
.
∞∞3 4
First
∞∞4 9
(
∞∞9 :
o
∞∞: ;
=>
∞∞< >
o
∞∞? @
.
∞∞@ A
Id
∞∞A C
==
∞∞D F
IdDireccion
∞∞G R
)
∞∞R S
;
∞∞S T
boleta
±± 
.
±± 
	Direccion
±± 
=
±± 
	direccion
±± (
.
±±( )
	Direccion
±±) 2
;
±±2 3
boleta
≤≤ 
.
≤≤ 

Referencia
≤≤ 
=
≤≤ 
	direccion
≤≤  )
.
≤≤) *

Referencia
≤≤* 4
;
≤≤4 5
_dbEntities
¥¥ 
.
¥¥ 
boletas
¥¥ 
.
¥¥  
Add
¥¥  #
(
¥¥# $
boleta
¥¥$ *
)
¥¥* +
;
¥¥+ ,
_dbEntities
µµ 
.
µµ 
SaveChanges
µµ #
(
µµ# $
)
µµ$ %
;
µµ% &
return
∑∑ 
aux2
∑∑ 
;
∑∑ 
}
∏∏ 	
}
ππ 
}∫∫ ‡
PD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\TrackingController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
TrackingController #
:$ %

Controller& 0
{		 

DbEntities

 
_dbEntities

 
;

 
public 
TrackingController !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Estado #
(# $
string$ *
CodTracking+ 6
)6 7
{ 	
var 
detallePedido 
= 
_dbEntities  +
.+ ,
detallePedidos, :
.+ ,
Include, 3
(3 4
o4 5
=>6 8
o9 :
.: ;
Pedido; A
)A B
.+ ,
Include, 3
(3 4
o4 5
=>6 8
o9 :
.: ;
Producto; C
)C D
.+ ,
FirstOrDefault, :
(: ;
o; <
=>= ?
o@ A
.A B
PedidoB H
.H I
CodTrackingI T
==U W
CodTrackingX c
)c d
;d e
ViewBag 
. 
CodTracking 
=  !
CodTracking" -
;- .
if 
( 
detallePedido 
!= 
null  $
)$ %
{ 
switch 
( 
detallePedido %
.% &
Pedido& ,
., -
Estado- 3
)3 4
{ 
case   
$num   
:   
ViewBag   #
.  # $
Estado  $ *
=  + ,
$str  - n
;  n o
break  p u
;  u v
case!! 
$num!! 
:!! 
ViewBag!! #
.!!# $
Estado!!$ *
=!!+ ,
$str!!- q
;!!q r
break!!s x
;!!x y
case"" 
$num"" 
:"" 
ViewBag"" #
.""# $
Estado""$ *
=""+ ,
$str""- q
;""q r
break""s x
;""x y
case## 
$num## 
:## 
ViewBag## #
.### $
Estado##$ *
=##+ ,
$str##- S
;##S T
break##U Z
;##Z [
case$$ 
$num$$ 
:$$ 
ViewBag$$ #
.$$# $
Estado$$$ *
=$$+ ,
$str$$- I
;$$I J
break$$K P
;$$P Q
}%% 
}&& 
else'' 
{(( 
ViewBag)) 
.)) 
Estado)) 
=))  
$str))! ?
;))? @
}** 
return++ 
View++ 
(++ 
)++ 
;++ 
},, 	
}-- 
}.. «'
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\DbEntities.cs
	namespace 	
Maxdel
 
. 
DB 
{ 
public 

class 

DbEntities 
: 
	DbContext '
{		 
public

 
DbSet

 
<

 
	Productos

 
>

 
	Productos

  )
{

* +
get

, /
;

/ 0
set

1 4
;

4 5
}

6 7
public 
DbSet 
< 
DetallePedido "
>" #
detallePedidos$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
DbSet 
< 
Pedido 
> 
pedidos $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Usuario 
> 
usuarios &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Tama√±oPrecio !
>! "
tama√±oPrecios# 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
DbSet 
< 
Tipo 
> 
tipos  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Direcciones  
>  !
direcciones" -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Estado 
> 
estado #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DbSet 
< 
NroTracking  
>  !
nroTrackings" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Boleta 
> 
boletas $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

DbEntities 
( 
) 
{ 
} 
public 

DbEntities 
( 
DbContextOptions *
<* +

DbEntities+ 5
>5 6
options7 >
)> ?
:? @
baseA E
(E F
optionsF M
)M N
{O P
}Q R
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
ProductosMapping0 @
(@ A
)A B
)B C
;C D
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, / 
DetallePedidoMapping0 D
(D E
)E F
)F G
;G H
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
PedidoMapping0 =
(= >
)> ?
)? @
;@ A
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
UsuarioMapping0 >
(> ?
)? @
)@ A
;A B
modelBuilder   
.   
ApplyConfiguration   +
(  + ,
new  , /
EstadoMapping  0 =
(  = >
)  > ?
)  ? @
;  @ A
modelBuilder!! 
.!! 
ApplyConfiguration!! +
(!!+ ,
new!!, / 
Tama√±oPrecioMapping!!0 C
(!!C D
)!!D E
)!!E F
;!!F G
modelBuilder"" 
."" 
ApplyConfiguration"" +
(""+ ,
new"", /
TipoMapping""0 ;
(""; <
)""< =
)""= >
;""> ?
modelBuilder## 
.## 
ApplyConfiguration## +
(##+ ,
new##, /
DireccionesMapping##0 B
(##B C
)##C D
)##D E
;##E F
modelBuilder$$ 
.$$ 
ApplyConfiguration$$ +
($$+ ,
new$$, /
NroTrackingMapping$$0 B
($$B C
)$$C D
)$$D E
;$$E F
modelBuilder%% 
.%% 
ApplyConfiguration%% +
(%%+ ,
new%%, /
BoletaMapping%%0 =
(%%= >
)%%> ?
)%%? @
;%%@ A
}&& 	
}'' 
}(( √
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\BoletaMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
BoletaMapping 
:  $
IEntityTypeConfiguration! 9
<9 :
Boleta: @
>@ A
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Boleta		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ≠
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\DetallePedidoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class  
DetallePedidoMapping %
:% &$
IEntityTypeConfiguration' ?
<? @
DetallePedido@ M
>M N
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
DetallePedido		0 =
>		= >
builder		? F
)		F G
{

 	
builder 
. 
ToTable 
( 
$str +
,+ ,
$str- 2
)2 3
;3 4
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Producto" *
)* +
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &

IdProducto& 0
)0 1
;1 2
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Pedido" (
)( )
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdPedido& .
). /
;/ 0
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
tama√±oPrecio" .
). /
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdTama√±oPrecio& 4
)4 5
;5 6
} 	
} 
} Ì

OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\DireccionesMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
DireccionesMapping #
:$ %$
IEntityTypeConfiguration& >
<> ?
Direcciones? J
>J K
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Direcciones		0 ;
>		; <
builder		= D
)		D E
{

 	
builder 
. 
ToTable 
( 
$str )
,) *
$str+ 0
)0 1
;1 2
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
} 	
} 
} √
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\EstadoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
EstadoMapping 
: $
IEntityTypeConfiguration  8
<8 9
Estado9 ?
>? @
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Estado		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ◊
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\NroTrackingMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
NroTrackingMapping #
:$ %$
IEntityTypeConfiguration& >
<> ?
NroTracking? J
>J K
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
NroTracking		0 ;
>		; <
builder		= D
)		D E
{

 	
builder 
. 
ToTable 
( 
$str )
,) *
$str+ 0
)0 1
;1 2
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} Å
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\PedidoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
PedidoMapping 
: $
IEntityTypeConfiguration  8
<8 9
Pedido9 ?
>? @
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Pedido		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
EstadoFK" *
)* +
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
Estado& ,
), -
;- .
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
boleta" (
)( )
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdBoleta& .
). /
;/ 0
} 	
} 
} œ
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\ProductosMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
ProductosMapping !
:! "$
IEntityTypeConfiguration# ;
<; <
	Productos< E
>E F
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
	Productos		0 9
>		9 :
builder		; B
)		B C
{

 	
builder 
. 
ToTable 
( 
$str '
,' (
$str) .
). /
;/ 0
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ¯

QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\Tama√±oPrecioMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class  
Tama√±oPrecioMapping $
:% &$
IEntityTypeConfiguration' ?
<? @
Tama√±oPrecio@ L
>L M
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Tama√±oPrecio		0 <
>		< =
builder		> E
)		E F
{

 	
builder 
. 
ToTable 
( 
$str *
,* +
$str, 1
)1 2
;2 3
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
	Productos" +
)+ ,
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &

IdProducto& 0
)0 1
;1 2
} 	
} 
} ª
HD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\TipoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
TipoMapping 
: $
IEntityTypeConfiguration 7
<7 8
Tipo8 <
>< =
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Tipo		0 4
>		4 5
builder		6 =
)		= >
{

 	
builder 
. 
ToTable 
( 
$str "
," #
$str$ )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ◊

KD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\UsuarioMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
UsuarioMapping 
:  $
IEntityTypeConfiguration! 9
<9 :
Usuario: A
>A B
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Usuario		0 7
>		7 8
builder		9 @
)		@ A
{

 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Tipo" &
)& '
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdTipo& ,
), -
;- .
} 	
} 
} •	
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Boleta.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Boleta 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
	NroBoleta 
{  !
get" %
;% &
set' *
;* +
}, -
public 
decimal 

MontoTotal !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
Fecha 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
	Direccion		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
string

 

Referencia

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
} 
} ≠
FD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\DetallePedido.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
DetallePedido 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
	Productos 
Producto !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
IdPedido 
{ 
get !
;! "
set# &
;& '
}( )
public		 
Pedido		 
Pedido		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
int

 
IdTama√±oPrecio

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
Tama√±oPrecio 
tama√±oPrecio (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
precio 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} é
DD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Direcciones.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Direcciones 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Usuario 
Usuario 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 

Referencia		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
}

 
} û
GD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\ErrorViewModel.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ≠
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Estado.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Estado 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ¥
DD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\NroTracking.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
NroTracking 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
Numero 
{ 
get 
;  
set! $
;$ %
}& '
} 
} ï
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Pedido.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Pedido 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
Usuario		 
Usuario		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
int

 
Estado

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 
Estado 
EstadoFK 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
decimal 
? 
Monto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
CodTracking "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
? 
IdBoleta 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Boleta 
boleta 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} Ô
BD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Productos.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
	Productos 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Descripcion !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	UrlImagen 
{  !
get" %
;% &
set' *
;* +
}, -
}		 
}

 ö
FD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Tama√±oPrecio.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Tama√±oPrecio 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
	Productos 
	Productos "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 
decimal		 
Precio		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
}

 
} ©
=D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Tipo.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Tipo 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ¢
@D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Usuario.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Usuario 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
IdTipo 
{ 
get 
;  
set! $
;$ %
}& '
public 
Tipo 
Tipo 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
Apellido		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
string

 
?

 

NroCelular

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
string 
? 
Correo 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Contrase√±a !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
DNI 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ◊
9D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 #
AddControllersWithViews		 (
(		( )
)		) *
;		* +
builder 
. 
Services 
. 
AddAuthentication "
(" #(
CookieAuthenticationDefaults# ?
.? @ 
AuthenticationScheme@ T
)T U
. 
	AddCookie 
( 
options 
=> 
{ 
options 
. 
	LoginPath 
= 
$str )
;) *
} 
) 
; 
builder 
. 
Services 
. 
AddDbContext 
< 

DbEntities (
>( )
() *
options 
=> 
options 
. 
UseSqlServer #
(# $
builder$ +
.+ ,
Configuration, 9
.9 :
GetConnectionString: M
(M N
$strN X
)X Y
)Y Z
) 
; 
builder 
. 
Services 
. 
AddTransient 
< 
IHomeRepositorio .
,. /
HomeRepositorio0 ?
>? @
(@ A
)A B
;B C
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app!! 
.!! 
UseHttpsRedirection!! 
(!! 
)!! 
;!! 
app"" 
."" 
UseStaticFiles"" 
("" 
)"" 
;"" 
app$$ 
.$$ 

UseRouting$$ 
($$ 
)$$ 
;$$ 
app&& 
.&& 
UseAuthentication&& 
(&& 
)&& 
;&& 
app'' 
.'' 
UseAuthorization'' 
('' 
)'' 
;'' 
app)) 
.)) 
MapControllerRoute)) 
()) 
name** 
:** 	
$str**
 
,** 
pattern++ 
:++ 
$str++ 5
)++5 6
;++6 7
app-- 
.-- 
Run-- 
(-- 
)-- 	
;--	 
‚
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\HomeRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IHomeRepositorio %
{ 
List		 
<		 
DetallePedido		 
>		 
ObtenerDetalleCesta		 /
(		/ 0
int		0 3
id		4 6
)		6 7
;		7 8
List

 
<

 
	Productos

 
>

 
ObtenerProductos

 (
(

( )
)

) *
;

* +
} 
public 

class 
HomeRepositorio  
:! "
IHomeRepositorio# 3
{ 
private 

DbEntities 
_dbEntities &
;& '
public 
HomeRepositorio 
( 

DbEntities )

dbEntities* 4
)4 5
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
DetallePedido !
>! "
ObtenerDetalleCesta# 6
(6 7
int7 :
id; =
)= >
{ 	
return 
_dbEntities 
. 
detallePedidos -
. 
Include 
( 
o 
=> !
o" #
.# $
Producto$ ,
), -
. 
Where 
( 
o 
=> 
o  !
.! "
IdPedido" *
==+ -
id. 0
)0 1
.1 2
ToList2 8
(8 9
)9 :
;: ;
} 	
public 
List 
< 
	Productos 
> 
ObtenerProductos /
(/ 0
)0 1
{ 	
return 
_dbEntities 
. 
	Productos (
.( )
ToList) /
(/ 0
)0 1
;1 2
} 	
}   
}!! ⁄
SD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\ComprarClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class "
ComprarClaseIntermedia '
{ 
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Estado 
{ 
get 
;  
set! $
;$ %
}& '
public 
decimal 
Monto 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CodTracking !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
	NroBoleta		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
int

 

IdProducto

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
int 
IdPedido 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
IdTama√±oPrecio !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
Precio 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} Û

TD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\RegistroClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class #
RegistroClaseIntermedia (
{ 
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	Apellidos 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

NroCelular  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
correo 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
contrase√±a		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
	Direccion

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 

Referencia  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 
} 