úp
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\AuthController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 

DbEntities 
_dbEntities &
;& '
public 
AuthController 
( 

DbEntities (

dbEntities) 3
)3 4
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public 
IActionResult 
Login "
(" #
string# )
correo* 0
,0 1
string2 8
contrase√±a9 C
)C D
{ 	
if 
( 
_dbEntities 
. 
usuarios $
.$ %
Any% (
(( )
x) *
=>+ -
x. /
./ 0
Correo0 6
==7 9
correo: @
&&A C
xD E
.E F
Contrase√±aF P
==Q S
contrase√±aT ^
)^ _
)_ `
{ 
var   
claims   
=   
new    
List  ! %
<  % &
Claim  & +
>  + ,
(  , -
)  - .
{!! 
new"" 
Claim"" 
("" 

ClaimTypes"" (
.""( )
Name"") -
,""- .
correo""/ 5
)""5 6
,""6 7
}## 
;## 
var$$ 
claimsIdentity$$ "
=$$# $
new$$% (
ClaimsIdentity$$) 7
($$7 8
claims$$8 >
,$$> ?(
CookieAuthenticationDefaults$$@ \
.$$\ ] 
AuthenticationScheme$$] q
)$$q r
;$$r s
var%% 
claimsPrincipal%% #
=%%$ %
new%%& )
ClaimsPrincipal%%* 9
(%%9 :
claimsIdentity%%: H
)%%H I
;%%I J
HttpContext'' 
.'' 
SignInAsync'' '
(''' (
claimsPrincipal''( 7
)''7 8
;''8 9
var)) 
usuario)) 
=)) 
_dbEntities)) )
.))) *
usuarios))* 2
.))2 3
First))3 8
())8 9
x))9 :
=>)); =
x))> ?
.))? @
Correo))@ F
==))G I
correo))J P
&&))Q S
x))T U
.))U V
Contrase√±a))V `
==))a c
contrase√±a))d n
)))n o
;))o p
if++ 
(++ 
usuario++ 
.++ 
IdTipo++ !
==++" $
$num++% &
)++& '
{,, 
return-- 
RedirectToAction-- +
(--+ ,
$str--, 3
,--3 4
$str--5 @
)--@ A
;--A B
}.. 
else// 
{00 
return11 
RedirectToAction11 +
(11+ ,
$str11, 3
,113 4
$str115 ;
)11; <
;11< =
}22 
}33 
if44 
(44 
correo44 
==44 
null44 
)44 

ModelState44  *
.44* +
AddModelError44+ 8
(448 9
$str449 A
,44A B
$str44C h
)44h i
;44i j
else55 
if55 
(55 
contrase√±a55 
==55  "
null55# '
)55' (

ModelState55) 3
.553 4
AddModelError554 A
(55A B
$str55B N
,55N O
$str55P y
)55y z
;55z {
else66 

ModelState66 
.66 
AddModelError66 )
(66) *
$str66* 5
,665 6
$str667 W
)66W X
;66X Y
return77 
View77 
(77 
)77 
;77 
}88 	
[:: 	
HttpGet::	 
]:: 
public;; 
IActionResult;; 
Register;; %
(;;% &
);;& '
{<< 	
ViewBag== 
.== 
PreguntasSeguridad== &
===' (
_dbEntities==) 4
.==4 5
preguntaSeguridads==5 G
.==G H
ToList==H N
(==N O
)==O P
;==P Q
return>> 
View>> 
(>> 
)>> 
;>> 
}?? 	
[AA 	
HttpPostAA	 
]AA 
publicBB 
IActionResultBB 
RegisterBB %
(BB% &#
RegistroClaseIntermediaBB& =
accountBB> E
)BBE F
{CC 	
intDD 
auxDD 
=DD 
_dbEntitiesDD !
.DD! "
usuariosDD" *
.DD* +
CountDD+ 0
(DD0 1
)DD1 2
;DD2 3
UsuarioEE 
userEE 
=EE 
newEE 
UsuarioEE &
(EE& '
)EE' (
;EE( )
DireccionesFF 
direccionesFF #
=FF$ %
newFF& )
DireccionesFF* 5
(FF5 6
)FF6 7
;FF7 8
ifHH 
(HH 

ModelStateHH 
.HH 
IsValidHH "
)HH" #
{II 
userJJ 
.JJ 
IdTipoJJ 
=JJ 
$numJJ 
;JJ  
userKK 
.KK 
NombreKK 
=KK 
accountKK %
.KK% &
NombreKK& ,
;KK, -
userLL 
.LL 
ApellidoLL 
=LL 
accountLL  '
.LL' (
	ApellidosLL( 1
;LL1 2
userMM 
.MM 

NroCelularMM 
=MM  !
accountMM" )
.MM) *

NroCelularMM* 4
;MM4 5
userNN 
.NN 
CorreoNN 
=NN 
accountNN %
.NN% &
correoNN& ,
;NN, -
userOO 
.OO 
Contrase√±aOO 
=OO  !
accountOO" )
.OO) *
contrase√±aOO* 4
;OO4 5
userPP 
.PP 
IdPreguntaSeguridadPP (
=PP) *
accountPP+ 2
.PP2 3
IdPreguntaSeguridadPP3 F
;PPF G
userQQ 
.QQ 
RespuestaPSQQ  
=QQ! "
accountQQ# *
.QQ* +
RespuestaPSQQ+ 6
;QQ6 7
direccionesRR 
.RR 
	IdUsuarioRR %
=RR& '
auxRR( +
+RR, -
$numRR. /
;RR/ 0
direccionesSS 
.SS 
	DireccionSS %
=SS& '
accountSS( /
.SS/ 0
	DireccionSS0 9
;SS9 :
direccionesTT 
.TT 

ReferenciaTT &
=TT' (
accountTT) 0
.TT0 1

ReferenciaTT1 ;
;TT; <
_dbEntitiesUU 
.UU 
usuariosUU $
.UU$ %
AddUU% (
(UU( )
userUU) -
)UU- .
;UU. /
_dbEntitiesVV 
.VV 
direccionesVV '
.VV' (
AddVV( +
(VV+ ,
direccionesVV, 7
)VV7 8
;VV8 9
_dbEntitiesWW 
.WW 
SaveChangesWW '
(WW' (
)WW( )
;WW) *
returnXX 
RedirectToActionXX '
(XX' (
$strXX( /
)XX/ 0
;XX0 1
}YY 
returnZZ 
ViewZZ 
(ZZ 
$strZZ "
,ZZ" #
accountZZ$ +
)ZZ+ ,
;ZZ, -
}[[ 	
[\\ 	
HttpGet\\	 
]\\ 
public]] 
IActionResult]] 
Correo]] #
(]]# $
)]]$ %
{^^ 	
return__ 
View__ 
(__ 
)__ 
;__ 
}`` 	
[aa 	
HttpPostaa	 
]aa 
publicbb 
IActionResultbb 
Correobb #
(bb# $
stringbb$ *
correobb+ 1
)bb1 2
{cc 	
Usuariodd 
?dd 
userdd 
=dd 
_dbEntitiesdd '
.dd' (
usuariosdd( 0
.dd0 1
FirstOrDefaultdd1 ?
(dd? @
odd@ A
=>ddB D
oddE F
.ddF G
CorreoddG M
==ddN P
correoddQ W
)ddW X
;ddX Y
ifee 
(ee 
useree 
!=ee 
nullee 
)ee 
{ff 
returngg 
RedirectToActiongg '
(gg' (
$strgg( ;
,gg; <
newgg= @
{ggA B
IdggC E
=ggF G
userggH L
.ggL M
IdggM O
}ggP Q
)ggQ R
;ggR S
}hh 
elseii 

ModelStateii 
.ii 
AddModelErrorii )
(ii) *
$strii* 2
,ii2 3
$strii4 J
)iiJ K
;iiK L
returnjj 
Viewjj 
(jj 
)jj 
;jj 
}kk 	
[ll 	
HttpGetll	 
]ll 
publicmm 
IActionResultmm 
PreguntaSeguridadmm .
(mm. /
intmm/ 2
Idmm3 5
)mm5 6
{nn 	
ViewBagoo 
.oo 
PreguntasSeguridadoo &
=oo' (
_dbEntitiesoo) 4
.oo4 5
preguntaSeguridadsoo5 G
.ooG H
ToListooH N
(ooN O
)ooO P
;ooP Q
ViewBagpp 
.pp 
Idpp 
=pp 
Idpp 
;pp 
returnqq 
Viewqq 
(qq 
)qq 
;qq 
}rr 	
[ss 	
HttpPostss	 
]ss 
publictt 
IActionResulttt 
PreguntaSeguridadtt .
(tt. /
inttt/ 2
Idtt3 5
,tt5 6
inttt7 :
IdPreguntaSeguridadtt; N
,ttN O
stringttP V
RespuestaPSttW b
)ttb c
{uu 	
ifvv 
(vv 
_dbEntitiesvv 
.vv 
usuariosvv $
.vv$ %
Anyvv% (
(vv( )
ovv) *
=>vv+ -
ovv. /
.vv/ 0
Idvv0 2
==vv3 5
Idvv6 8
&&ww 
oww 
.ww 
IdPreguntaSeguridadww /
==ww0 2
IdPreguntaSeguridadww3 F
&&xx 
oxx 
.xx 
RespuestaPSxx '
==xx( *
RespuestaPSxx+ 6
)xx6 7
)xx7 8
{yy 
returnzz 
RedirectToActionzz '
(zz' (
$strzz( >
,zz> ?
newzz@ C
{zzD E
IdzzF H
=zzI J
IdzzK M
}zzN O
)zzO P
;zzP Q
}{{ 

ModelState|| 
.|| 
AddModelError|| $
(||$ %
$str||% 4
,||4 5
$str||6 I
)||I J
;||J K
return}} 
RedirectToAction}} #
(}}# $
$str}}$ 7
,}}7 8
new}}9 <
{}}= >
Id}}? A
=}}B C
Id}}D F
}}}G H
)}}H I
;}}I J
}~~ 	
[ 	
HttpGet	 
] 
public
ÄÄ 
IActionResult
ÄÄ #
ActualizarContrase√±a
ÄÄ 1
(
ÄÄ1 2
int
ÄÄ2 5
Id
ÄÄ6 8
)
ÄÄ8 9
{
ÅÅ 	
ViewBag
ÇÇ 
.
ÇÇ 
Id
ÇÇ 
=
ÇÇ 
Id
ÇÇ 
;
ÇÇ 
return
ÉÉ 
View
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
[
ÖÖ 	
HttpPost
ÖÖ	 
]
ÖÖ 
public
ÜÜ 
IActionResult
ÜÜ #
ActualizarContrase√±a
ÜÜ 1
(
ÜÜ1 2
int
ÜÜ2 5
Id
ÜÜ6 8
,
ÜÜ8 9
string
ÜÜ: @
contrase√±a
ÜÜA K
,
ÜÜK L
string
ÜÜM S
contrase√±aV
ÜÜT _
)
ÜÜ_ `
{
áá 	
if
àà 
(
àà 
contrase√±a
àà 
==
àà 
contrase√±aV
àà (
)
àà( )
{
ââ 
Usuario
ää 
user
ää 
=
ää 
_dbEntities
ää *
.
ää* +
usuarios
ää+ 3
.
ää3 4
First
ää4 9
(
ää9 :
o
ää: ;
=>
ää< >
o
ää? @
.
ää@ A
Id
ääA C
==
ääD F
Id
ääG I
)
ääI J
;
ääJ K
user
ãã 
.
ãã 
Contrase√±a
ãã 
=
ãã  !
contrase√±a
ãã" ,
;
ãã, -
_dbEntities
åå 
.
åå 
SaveChanges
åå '
(
åå' (
)
åå( )
;
åå) *

ModelState
çç 
.
çç 
AddModelError
çç (
(
çç( )
$str
çç) 5
,
çç5 6
$str
çç7 O
)
ççO P
;
ççP Q
return
éé 
RedirectToAction
éé '
(
éé' (
$str
éé( /
,
éé/ 0
$str
éé1 7
)
éé7 8
;
éé8 9
}
èè 
else
êê 

ModelState
êê 
.
êê 
AddModelError
êê )
(
êê) *
$str
êê* 6
,
êê6 7
$str
êê8 V
)
êêV W
;
êêW X
return
ëë 
RedirectToAction
ëë #
(
ëë# $
$str
ëë$ :
,
ëë: ;
new
ëë< ?
{
ëë@ A
Id
ëëB D
=
ëëE F
Id
ëëG I
}
ëëJ K
)
ëëK L
;
ëëL M
}
íí 	
[
îî 	
HttpGet
îî	 
]
îî 
public
ïï 
IActionResult
ïï 
Logout
ïï #
(
ïï# $
)
ïï$ %
{
ññ 	
HttpContext
óó 
.
óó 
SignOutAsync
óó $
(
óó$ %
)
óó% &
;
óó& '
return
òò 
RedirectToAction
òò #
(
òò# $
$str
òò$ +
)
òò+ ,
;
òò, -
}
ôô 	
}
öö 
}õõ —
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\HomeAdminController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
public 

class 
HomeAdminController $
:% &

Controller' 1
{ 
public		 
IActionResult		 
Index		 "
(		" #
)		# $
{

 	
return 
View 
( 
) 
; 
} 	
} 
} Ü
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\HomeController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
public

 

class

 
HomeController

 
:

  !

Controller

" ,
{ 
private 

DbEntities 
_dbEntities &
;& '
private 
readonly 
IHomeRepositorio )
_homeRepositorio* :
;: ;
public 
HomeController 
( 

DbEntities (

dbEntities) 3
,3 4
IHomeRepositorio5 E
homeRepositorioF U
)U V
{ 	
_dbEntities 
= 

dbEntities $
;$ %
_homeRepositorio 
= 
homeRepositorio .
;. /
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
About "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public   
IActionResult   
Error   "
(  " #
)  # $
{!! 	
return"" 
View"" 
("" 
new"" 
ErrorViewModel"" *
{""+ ,
	RequestId""- 6
=""7 8
Activity""9 A
.""A B
Current""B I
?""I J
.""J K
Id""K M
??""N P
HttpContext""Q \
.""\ ]
TraceIdentifier""] l
}""m n
)""n o
;""o p
}## 	
}$$ 
}%% ¿
LD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\MenuController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{		 
public

 

class

 
MenuController

 
:

  !

Controller

" ,
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
MenuController 
( 

DbEntities (

dbEntities) 3
)3 4
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
string# )
buscar* 0
)0 1
{ 	
var 
ListaProductos 
=  
_dbEntities! ,
., -
	Productos- 6
.6 7
ToList7 =
(= >
)> ?
;? @
if 
( 
buscar 
!= 
null 
&& !
buscar" (
!=) +
$str, .
). /
{ 
ListaProductos 
=  
ListaProductos! /
./ 0
Where0 5
(5 6
o6 7
=>8 :
o; <
.< =
Nombre= C
.C D
ContainsD L
(L M
buscarM S
,S T
StringComparisonU e
.e f
OrdinalIgnoreCasef w
)w x
||y {
o| }
.} ~
Descripcion	~ â
.
â ä
Contains
ä í
(
í ì
buscar
ì ô
,
ô ö
StringComparison
õ ´
.
´ ¨
OrdinalIgnoreCase
¨ Ω
)
Ω æ
)
æ ø
.
ø ¿
OrderBy
¿ «
(
« »
o
» …
=>
  Ã
o
Õ Œ
.
Œ œ
Nombre
œ ’
)
’ ÷
.
÷ ◊
ToList
◊ ›
(
› ﬁ
)
ﬁ ﬂ
;
ﬂ ‡
} 
ViewBag 
. 
Buscar 
= 
buscar #
;# $
return 
View 
( 
ListaProductos &
)& '
;' (
} 	
} 
} æ
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\PedidosController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
PedidosController "
:# $

Controller% /
{ 
private		 
readonly		 

DbEntities		 #
_dbEntities		$ /
;		/ 0
public 
PedidosController  
(  !

DbEntities! +

dbEntities, 6
)6 7
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
ViewBag 
. 
DatosPedidos  
=! "
_dbEntities# .
.. /
detallePedidos/ =
. 
Include $
($ %
o% &
=>' )
o* +
.+ ,
Producto, 4
)4 5
. 
Include $
($ %
o% &
=>' )
o* +
.+ ,
Pedido, 2
)2 3
. 
Include $
($ %
o% &
=>' )
o* +
.+ ,
Pedido, 2
.2 3
boleta3 9
)9 :
. 
Include $
($ %
o% &
=>' )
o* +
.+ ,
Pedido, 2
.2 3
EstadoFK3 ;
); <
. 
Where "
(" #
o# $
=>% '
o( )
.) *
Pedido* 0
.0 1
Estado1 7
==8 :
$num; <
)< =
.= >
ToList> D
(D E
)E F
;F G
return 
View 
( 
) 
; 
} 	
} 
} äO
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\PersonaController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
[		 
	Authorize		 
]		 
public

 

class

 
PersonaController

 "
:

# $

Controller

% /
{ 

DbEntities 
_dbEntities 
; 
public 
PersonaController  
(  !

DbEntities! +

dbEntities, 6
)6 7
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
int 
Id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
var 
persona 
= 
_dbEntities %
.% &
usuarios& .
.. /
First/ 4
(4 5
o5 6
=>7 9
o: ;
.; <
Id< >
==? A
IdB D
)D E
;E F
ViewBag 
. 
Direcciones 
=  !
_dbEntities" -
.- .
direcciones. 9
.9 :
Where: ?
(? @
o@ A
=>B D
oE F
.F G
	IdUsuarioG P
==Q S
IdT V
)V W
.W X
ToListX ^
(^ _
)_ `
;` a
return 
View 
( 
persona 
)  
;  !
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
EditarPersona *
(* +
)+ ,
{ 	
int 
id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
var 
persona 
= 
_dbEntities %
.% &
usuarios& .
.. /
First/ 4
(4 5
o5 6
=>7 9
o: ;
.; <
Id< >
==? A
idB D
)D E
;E F
return 
View 
( 
persona 
)  
;  !
} 	
[   	
HttpPost  	 
]   
public!! 
IActionResult!! 
EditarPersona!! *
(!!* +
int!!+ .
id!!/ 1
,!!1 2
Usuario!!3 :
user!!; ?
)!!? @
{"" 	
var## 
Persona## 
=## 
_dbEntities## %
.##% &
usuarios##& .
.##. /
First##/ 4
(##4 5
o##5 6
=>##7 9
o##: ;
.##; <
Id##< >
==##? A
id##B D
)##D E
;##E F
Persona$$ 
.$$ 
Nombre$$ 
=$$ 
user$$ !
.$$! "
Nombre$$" (
;$$( )
Persona%% 
.%% 
Apellido%% 
=%% 
user%% #
.%%# $
Apellido%%$ ,
;%%, -
Persona&& 
.&& 

NroCelular&& 
=&&  
user&&! %
.&&% &

NroCelular&&& 0
;&&0 1
Persona'' 
.'' 
Correo'' 
='' 
user'' !
.''! "
Correo''" (
;''( )
_dbEntities(( 
.(( 
SaveChanges(( #
(((# $
)(($ %
;((% &
return)) 
RedirectToAction)) #
())# $
$str))$ +
,))+ ,
$str))- 6
)))6 7
;))7 8
}** 	
public++ 
IActionResult++ 
AgregaDireccion++ ,
(++, -
)++- .
{,, 	
return-- 
View-- 
(-- 
)-- 
;-- 
}.. 	
public// 
IActionResult// 
NuevaDireccion// +
(//+ ,
int//, /
retorno//0 7
,//7 8
string//9 ?
	Direccion//@ I
,//I J
string//K Q

Referencia//R \
)//\ ]
{00 	
int11 
Id11 
=11 
GetLoggedUser11 "
(11" #
)11# $
.11$ %
Id11% '
;11' (
Direcciones22 
	direccion22 !
=22" #
new22$ '
Direcciones22( 3
(223 4
)224 5
;225 6
	direccion33 
.33 
	IdUsuario33 
=33  !
Id33" $
;33$ %
	direccion44 
.44 
	Direccion44 
=44  !
	Direccion44" +
;44+ ,
	direccion55 
.55 

Referencia55  
=55! "

Referencia55# -
;55- .
_dbEntities66 
.66 
direcciones66 #
.66# $
Add66$ '
(66' (
	direccion66( 1
)661 2
;662 3
_dbEntities77 
.77 
SaveChanges77 #
(77# $
)77$ %
;77% &
if88 
(88 
retorno88 
==88 
$num88 
)88 
return88 #
RedirectToAction88$ 4
(884 5
$str885 <
,88< =
$str88> G
)88G H
;88H I
else99 
return99 
RedirectToAction99 (
(99( )
$str99) 0
,990 1
$str992 B
)99B C
;99C D
}:: 	
public;; 
IActionResult;; 
EliminarDireccion;; .
(;;. /
int;;/ 2
id;;3 5
);;5 6
{<< 	
var== 
	direccion== 
=== 
_dbEntities== '
.==' (
direcciones==( 3
.==3 4
First==4 9
(==9 :
o==: ;
=>==< >
o==? @
.==@ A
Id==A C
====D F
id==G I
)==I J
;==J K
_dbEntities>> 
.>> 
direcciones>> #
.>># $
Remove>>$ *
(>>* +
	direccion>>+ 4
)>>4 5
;>>5 6
_dbEntities?? 
.?? 
SaveChanges?? #
(??# $
)??$ %
;??% &
return@@ 
RedirectToAction@@ #
(@@# $
$str@@$ +
,@@+ ,
$str@@- 6
)@@6 7
;@@7 8
}AA 	
[BB 	
HttpGetBB	 
]BB 
publicCC 
IActionResultCC !
ActualizarContrase√±aCC 1
(CC1 2
)CC2 3
{DD 	
returnEE 
ViewEE 
(EE 
)EE 
;EE 
}FF 	
[GG 	
HttpPostGG	 
]GG 
publicHH 
IActionResultHH !
ActualizarContrase√±aHH 1
(HH1 2
stringHH2 8
contrase√±aActualHH9 I
,HHI J
stringHHK Q
contrase√±aNuevaHHR a
,HHa b
stringHHc i 
contrase√±aVerificarHHj }
)HH} ~
{II 	
intJJ 
IdJJ 
=JJ 
GetLoggedUserJJ "
(JJ" #
)JJ# $
.JJ$ %
IdJJ% '
;JJ' (
ifKK 
(KK 
_dbEntitiesKK 
.KK 
usuariosKK $
.KK$ %
AnyKK% (
(KK( )
xKK) *
=>KK+ -
xKK. /
.KK/ 0
IdKK0 2
==KK3 5
IdKK6 8
&&KK9 ;
xKK< =
.KK= >
Contrase√±aKK> H
==KKI K
contrase√±aActualKKL \
)KK\ ]
)KK] ^
{LL 
ifMM 
(MM 
contrase√±aNuevaMM #
==MM$ & 
contrase√±aVerificarMM' :
)MM: ;
{NN 
UsuarioOO 
userOO  
=OO! "
_dbEntitiesOO# .
.OO. /
usuariosOO/ 7
.OO7 8
FirstOO8 =
(OO= >
oOO> ?
=>OO@ B
oOOC D
.OOD E
IdOOE G
==OOH J
IdOOK M
)OOM N
;OON O
userPP 
.PP 
Contrase√±aPP #
=PP$ %
contrase√±aNuevaPP& 5
;PP5 6
_dbEntitiesQQ 
.QQ  
SaveChangesQQ  +
(QQ+ ,
)QQ, -
;QQ- .

ModelStateRR 
.RR 
AddModelErrorRR ,
(RR, -
$strRR- 9
,RR9 :
$strRR; S
)RRS T
;RRT U
returnSS 
RedirectToActionSS +
(SS+ ,
$strSS, 3
,SS3 4
$strSS5 >
)SS> ?
;SS? @
}TT 

ModelStateUU 
.UU 
AddModelErrorUU (
(UU( )
$strUU) :
,UU: ;
$strUU< Z
)UUZ [
;UU[ \
returnVV 
ViewVV 
(VV 
)VV 
;VV 
}WW 

ModelStateXX 
.XX 
AddModelErrorXX $
(XX$ %
$strXX% 7
,XX7 8
$strXX9 M
)XXM N
;XXN O
returnYY 
ViewYY 
(YY 
)YY 
;YY 
}ZZ 	
private[[ 
Usuario[[ 
GetLoggedUser[[ %
([[% &
)[[& '
{\\ 	
var]] 
claim]] 
=]] 
HttpContext]] #
.]]# $
User]]$ (
.]]( )
Claims]]) /
.]]/ 0
First]]0 5
(]]5 6
)]]6 7
;]]7 8
string^^ 
username^^ 
=^^ 
claim^^ #
.^^# $
Value^^$ )
;^^) *
return__ 
_dbEntities__ 
.__ 
usuarios__ '
.__' (
First__( -
(__- .
o__. /
=>__0 2
o__3 4
.__4 5
Correo__5 ;
==__< >
username__? G
)__G H
;__H I
}`` 	
}aa 
}bb »∏
VD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\ProcesarCompraController.cs
	namespace		 	
Maxdel		
 
.		 
Controllers		 
{

 
public 

class $
ProcesarCompraController )
:* +

Controller, 6
{ 

DbEntities 
_dbEntities 
; 
public $
ProcesarCompraController '
(' (

DbEntities( 2

dbEntities3 =
)= >
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Detalle $
($ %
int% (

IdProducto) 3
)3 4
{ 	
var 
Producto 
= 
_dbEntities &
.& '
	Productos' 0
.0 1
First1 6
(6 7
o7 8
=>9 ;
o< =
.= >
Id> @
==A C

IdProductoD N
)N O
;O P
ViewBag 
. 
Tama√±oPrecio  
=! "
_dbEntities# .
.. /
tama√±oPrecios/ <
.< =
Where= B
(B C
oC D
=>E G
oH I
.I J

IdProductoJ T
==U W

IdProductoX b
)b c
.c d
ToListd j
(j k
)k l
;l m
return 
View 
( 
Producto  
)  !
;! "
} 	
[ 	
HttpPost	 
] 
[ 	
	Authorize	 
] 
public 
IActionResult 
Detalle $
($ %
int% (

IdProducto) 3
,3 4"
ComprarClaseIntermedia5 K
claseL Q
)Q R
{ 	
int 
Id 
= 
GetLoggedUser "
(" #
)# $
.$ %
Id% '
;' (
Pedido 
pedido 
= 
new 
Pedido  &
(& '
)' (
;( )
DetallePedido 
detallePedido '
=( )
new* -
DetallePedido. ;
(; <
)< =
;= >
pedido   
.   
	IdUsuario   
=   
Id   !
;  ! "
pedido!! 
.!! 
Estado!! 
=!! 
$num!! 
;!! 
pedido"" 
."" 
Destino"" 
="" 
$str"" '
;""' (
_dbEntities## 
.## 
pedidos## 
.##  
Add##  #
(### $
pedido##$ *
)##* +
;##+ ,
_dbEntities$$ 
.$$ 
SaveChanges$$ #
($$# $
)$$$ %
;$$% &
var%% 
pedidos%% 
=%% 
_dbEntities%% %
.%%% &
pedidos%%& -
.%%- .
ToList%%. 4
(%%4 5
)%%5 6
;%%6 7
Pedido&& 
	pedidoAux&& 
=&& 
new&& "
Pedido&&# )
(&&) *
)&&* +
;&&+ ,
foreach'' 
('' 
var'' 
item'' 
in''  
pedidos''! (
)''( )
{(( 
	pedidoAux)) 
.)) 
Id)) 
=)) 
item)) #
.))# $
Id))$ &
;))& '
}** 
detallePedido++ 
.++ 

IdProducto++ $
=++% &

IdProducto++' 1
;++1 2
detallePedido,, 
.,, 
IdPedido,, "
=,,# $
	pedidoAux,,% .
.,,. /
Id,,/ 1
;,,1 2
detallePedido-- 
.-- 
IdTama√±oPrecio-- (
=--) *
clase--+ 0
.--0 1
IdTama√±oPrecio--1 ?
;--? @
detallePedido.. 
... 
Cantidad.. "
=..# $
clase..% *
...* +
Cantidad..+ 3
;..3 4
Tama√±oPrecio// 
tama√±oPrecio// %
=//& '
_dbEntities//( 3
.//3 4
tama√±oPrecios//4 A
.//A B
First//B G
(//G H
o//H I
=>//J L
o//M N
.//N O
Id//O Q
==//R T
detallePedido//U b
.//b c
IdTama√±oPrecio//c q
)//q r
;//r s
detallePedido00 
.00 
Tama√±oProducto00 (
=00) *
tama√±oPrecio00+ 7
.007 8
Tama√±oProducto008 F
;00F G
detallePedido11 
.11 
precio11  
=11! "
tama√±oPrecio11# /
.11/ 0
Precio110 6
;116 7
Pedido22 

pedidoAux222 
=22 
new22  #
Pedido22$ *
(22* +
)22+ ,
;22, -

pedidoAux233 
=33 
_dbEntities33 $
.33$ %
pedidos33% ,
.33, -
First33- 2
(332 3
o333 4
=>335 7
o338 9
.339 :
Id33: <
==33= ?
	pedidoAux33@ I
.33I J
Id33J L
)33L M
;33M N

pedidoAux244 
.44 
Monto44 
=44 
clase44 $
.44$ %
Cantidad44% -
*44. /
tama√±oPrecio440 <
.44< =
Precio44= C
;44C D
_dbEntities55 
.55 
SaveChanges55 #
(55# $
)55$ %
;55% &
_dbEntities66 
.66 
detallePedidos66 &
.66& '
Add66' *
(66* +
detallePedido66+ 8
)668 9
;669 :
_dbEntities77 
.77 
SaveChanges77 #
(77# $
)77$ %
;77% &
return99 
RedirectToAction99 #
(99# $
$str99$ +
,99+ ,
$str99- =
)99= >
;99> ?
}:: 	
[;; 	
	Authorize;;	 
];; 
public<< 
IActionResult<< 
Cesta<< "
(<<" #
)<<# $
{== 	
int>> 
Id>> 
=>> 
GetLoggedUser>> "
(>>" #
)>># $
.>>$ %
Id>>% '
;>>' (
ViewBag@@ 
.@@ 

DatosCesta@@ 
=@@  
_dbEntities@@! ,
.@@, -
detallePedidos@@- ;
.AA 
IncludeAA 
(AA 
oAA 
=>AA !
oAA" #
.AA# $
ProductoAA$ ,
)AA, -
.BB 
IncludeBB 
(BB 
oBB 
=>BB !
oBB" #
.BB# $
PedidoBB$ *
)BB* +
.CC 
IncludeCC 
(CC 
oCC 
=>CC !
oCC" #
.CC# $
PedidoCC$ *
.CC* +
EstadoFKCC+ 3
)CC3 4
.DD 
WhereDD 
(DD 
oDD 
=>DD 
oDD  !
.DD! "
PedidoDD" (
.DD( )
	IdUsuarioDD) 2
==DD3 5
IdDD6 8
&&DD9 ;
oDD< =
.DD= >
PedidoDD> D
.DDD E
EstadoDDE K
==DDL N
$numDDO P
)DDP Q
.DDQ R
ToListDDR X
(DDX Y
)DDY Z
;DDZ [
decimalFF 
montoFF 
=FF 
$numFF 
;FF 
varHH 
auxHH 
=HH 
_dbEntitiesHH !
.HH! "
detallePedidosHH" 0
.II 
IncludeII 
(II 
oII 
=>II !
oII" #
.II# $
PedidoII$ *
)II* +
.JJ 
WhereJJ 
(JJ 
oJJ 
=>JJ 
oJJ  !
.JJ! "
PedidoJJ" (
.JJ( )
	IdUsuarioJJ) 2
==JJ3 5
IdJJ6 8
&&JJ9 ;
oJJ< =
.JJ= >
PedidoJJ> D
.JJD E
EstadoJJE K
==JJL N
$numJJO P
)JJP Q
.JJQ R
ToListJJR X
(JJX Y
)JJY Z
;JJZ [
foreachLL 
(LL 
varLL 
itemLL 
inLL  
auxLL! $
)LL$ %
{MM 
montoNN 
+=NN 
itemNN 
.NN 
precioNN $
*NN% &
itemNN' +
.NN+ ,
CantidadNN, 4
;NN4 5
}OO 
ViewBagQQ 
.QQ 
MontoQQ 
=QQ 
montoQQ !
;QQ! "
ViewBagSS 
.SS 
DireccionesSS 
=SS  !
_dbEntitiesSS" -
.SS- .
direccionesSS. 9
.TT 
WhereTT 
(TT 
oTT 
=>TT 
oTT  !
.TT! "
	IdUsuarioTT" +
==TT, .
IdTT/ 1
)TT1 2
;TT2 3
returnUU 
ViewUU 
(UU 
)UU 
;UU 
}VV 	
[WW 	
	AuthorizeWW	 
]WW 
publicXX 
IActionResultXX 
ActualizarCantidadXX /
(XX/ 0
intXX0 3
IdXX4 6
,XX6 7
intXX8 ;
CantidadXX< D
)XXD E
{YY 	
DetallePedidoZZ 
pedidoZZ  
=ZZ! "
_dbEntitiesZZ# .
.ZZ. /
detallePedidosZZ/ =
.ZZ= >
FirstZZ> C
(ZZC D
oZZD E
=>ZZF H
oZZI J
.ZZJ K
IdZZK M
==ZZN P
IdZZQ S
)ZZS T
;ZZT U
pedido[[ 
.[[ 
Cantidad[[ 
=[[ 
Cantidad[[ &
;[[& '
_dbEntities\\ 
.\\ 
SaveChanges\\ #
(\\# $
)\\$ %
;\\% &
return]] 
RedirectToAction]] #
(]]# $
$str]]$ +
,]]+ ,
$str]]- =
)]]= >
;]]> ?
}^^ 	
private__ 
Usuario__ 
GetLoggedUser__ %
(__% &
)__& '
{`` 	
varaa 
claimaa 
=aa 
HttpContextaa #
.aa# $
Useraa$ (
.aa( )
Claimsaa) /
.aa/ 0
Firstaa0 5
(aa5 6
)aa6 7
;aa7 8
stringbb 
usernamebb 
=bb 
claimbb #
.bb# $
Valuebb$ )
;bb) *
returncc 
_dbEntitiescc 
.cc 
usuarioscc '
.cc' (
Firstcc( -
(cc- .
occ. /
=>cc0 2
occ3 4
.cc4 5
Correocc5 ;
==cc< >
usernamecc? G
)ccG H
;ccH I
}dd 	
privateff 
stringff 
generarCodTrackingff )
(ff) *
intff* -
Idff. 0
)ff0 1
{gg 	
stringhh 
codTrackinghh 
=hh  
$strhh! &
;hh& '
Usuarioii 
tempii 
=ii 
_dbEntitiesii &
.ii& '
usuariosii' /
.ii/ 0
Firstii0 5
(ii5 6
oii6 7
=>ii8 :
oii; <
.ii< =
Idii= ?
==ii@ B
IdiiC E
)iiE F
;iiF G
stringjj 
temp1jj 
=jj 
tempjj 
.jj  
Nombrejj  &
;jj& '
codTrackingkk 
+=kk 
temp1kk  
[kk  !
$numkk! "
]kk" #
;kk# $
temp1ll 
=ll 
templl 
.ll 
Apellidoll !
;ll! "
codTrackingmm 
+=mm 
temp1mm  
[mm  !
$nummm! "
]mm" #
;mm# $
intnn 
nronn 
=nn 
_dbEntitiesnn !
.nn! "
nroTrackingsnn" .
.nn. /
Firstnn/ 4
(nn4 5
onn5 6
=>nn7 9
onn: ;
.nn; <
Idnn< >
==nn? A
$numnnB C
)nnC D
.nnD E
NumeronnE K
;nnK L
temp1oo 
=oo 
nrooo 
.oo 
ToStringoo  
(oo  !
)oo! "
;oo" #
intpp 
cantpp 
=pp 
temp1pp 
.pp 
Lengthpp #
;pp# $
intqq 
maxqq 
=qq 
$numqq 
-qq 
cantqq 
;qq 
forrr 
(rr 
intrr 
irr 
=rr 
$numrr 
;rr 
irr 
<rr 
maxrr "
;rr" #
irr$ %
++rr% '
)rr' (
{ss 
codTrackingtt 
+=tt 
$strtt "
;tt" #
}uu 
codTrackingvv 
+=vv 
temp1vv  
;vv  !
NroTrackingww 
nroTrackingww #
=ww$ %
newww& )
NroTrackingww* 5
(ww5 6
)ww6 7
;ww7 8
nroTrackingxx 
=xx 
_dbEntitiesxx %
.xx% &
nroTrackingsxx& 2
.xx2 3
Firstxx3 8
(xx8 9
oxx9 :
=>xx; =
oxx> ?
.xx? @
Idxx@ B
==xxC E
$numxxF G
)xxG H
;xxH I
nroTrackingyy 
.yy 
Numeroyy 
++yy  
;yy  !
_dbEntitieszz 
.zz 
SaveChangeszz #
(zz# $
)zz$ %
;zz% &
return{{ 
codTracking{{ 
;{{ 
}|| 	
[~~ 	
HttpGet~~	 
]~~ 
[ 	
	Authorize	 
] 
public
ÄÄ 
IActionResult
ÄÄ 
Delete
ÄÄ #
(
ÄÄ# $
int
ÄÄ$ '
id
ÄÄ( *
)
ÄÄ* +
{
ÅÅ 	
var
ÇÇ 
pedidoDb
ÇÇ 
=
ÇÇ 
_dbEntities
ÇÇ &
.
ÇÇ& '
pedidos
ÇÇ' .
.
ÇÇ. /
First
ÇÇ/ 4
(
ÇÇ4 5
o
ÇÇ5 6
=>
ÇÇ7 9
o
ÇÇ: ;
.
ÇÇ; <
Id
ÇÇ< >
==
ÇÇ? A
id
ÇÇB D
)
ÇÇD E
;
ÇÇE F
_dbEntities
ÉÉ 
.
ÉÉ 
pedidos
ÉÉ 
.
ÉÉ  
Remove
ÉÉ  &
(
ÉÉ& '
pedidoDb
ÉÉ' /
)
ÉÉ/ 0
;
ÉÉ0 1
_dbEntities
ÑÑ 
.
ÑÑ 
SaveChanges
ÑÑ #
(
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
var
ÖÖ 
	detalleDb
ÖÖ 
=
ÖÖ 
_dbEntities
ÖÖ '
.
ÖÖ' (
detallePedidos
ÖÖ( 6
.
ÖÖ6 7
First
ÖÖ7 <
(
ÖÖ< =
o
ÖÖ= >
=>
ÖÖ? A
o
ÖÖB C
.
ÖÖC D
IdPedido
ÖÖD L
==
ÖÖM O
id
ÖÖP R
)
ÖÖR S
;
ÖÖS T
_dbEntities
ÜÜ 
.
ÜÜ 
detallePedidos
ÜÜ &
.
ÜÜ& '
Remove
ÜÜ' -
(
ÜÜ- .
	detalleDb
ÜÜ. 7
)
ÜÜ7 8
;
ÜÜ8 9
_dbEntities
áá 
.
áá 
SaveChanges
áá #
(
áá# $
)
áá$ %
;
áá% &
return
ââ 
RedirectToAction
ââ #
(
ââ# $
$str
ââ$ +
,
ââ+ ,
$str
ââ- =
)
ââ= >
;
ââ> ?
}
ää 	
[
ãã 	
	Authorize
ãã	 
]
ãã 
public
åå 
IActionResult
åå 
PedidoExito
åå (
(
åå( )
int
åå) ,
IdDireccion
åå- 8
)
åå8 9
{
çç 	
ViewBag
éé 
.
éé 
nroTracking
éé 
=
éé  !
Comprar
éé" )
(
éé) *
IdDireccion
éé* 5
)
éé5 6
;
éé6 7
return
èè 
View
èè 
(
èè 
)
èè 
;
èè 
}
êê 	
private
íí 
string
íí 
Comprar
íí 
(
íí 
int
íí "
IdDireccion
íí# .
)
íí. /
{
ìì 	
int
îî 
Id
îî 
=
îî 
GetLoggedUser
îî "
(
îî" #
)
îî# $
.
îî$ %
Id
îî% '
;
îî' (
List
ïï 
<
ïï 
Pedido
ïï 
>
ïï 
pedidos
ïï  
=
ïï! "
new
ïï# &
List
ïï' +
<
ïï+ ,
Pedido
ïï, 2
>
ïï2 3
(
ïï3 4
)
ïï4 5
;
ïï5 6
pedidos
ññ 
=
ññ 
_dbEntities
ññ !
.
ññ! "
pedidos
ññ" )
.
ññ) *
Where
ññ* /
(
ññ/ 0
o
ññ0 1
=>
ññ2 4
o
ññ5 6
.
ññ6 7
	IdUsuario
ññ7 @
==
ññA C
Id
ññD F
&&
ññG I
o
ññJ K
.
ññK L
Estado
ññL R
==
ññS U
$num
ññV W
)
ññW X
.
ññX Y
ToList
ññY _
(
ññ_ `
)
ññ` a
;
ñña b
int
óó 
IdBoleta
óó 
=
óó 
generarNroBoleta
óó +
(
óó+ ,
IdDireccion
óó, 7
)
óó7 8
;
óó8 9
string
òò 
codTracking
òò 
=
òò   
generarCodTracking
òò! 3
(
òò3 4
Id
òò4 6
)
òò6 7
;
òò7 8
for
ôô 
(
ôô 
int
ôô 
i
ôô 
=
ôô 
$num
ôô 
;
ôô 
i
ôô 
<
ôô 
pedidos
ôô  '
.
ôô' (
Count
ôô( -
;
ôô- .
i
ôô/ 0
++
ôô0 2
)
ôô2 3
{
öö 
pedidos
õõ 
[
õõ 
i
õõ 
]
õõ 
.
õõ 
Estado
õõ !
=
õõ" #
$num
õõ$ %
;
õõ% &
pedidos
úú 
[
úú 
i
úú 
]
úú 
.
úú 
CodTracking
úú &
=
úú' (
codTracking
úú) 4
;
úú4 5
pedidos
ùù 
[
ùù 
i
ùù 
]
ùù 
.
ùù 
IdBoleta
ùù #
=
ùù$ %
IdBoleta
ùù& .
;
ùù. /
}
ûû 
_dbEntities
üü 
.
üü 
SaveChanges
üü #
(
üü# $
)
üü$ %
;
üü% &
return
†† 
codTracking
†† 
;
†† 
}
°° 	
private
¢¢ 
int
¢¢ 
generarNroBoleta
¢¢ $
(
¢¢$ %
int
¢¢% (
IdDireccion
¢¢) 4
)
¢¢4 5
{
££ 	
string
§§ 
	nroBoleta
§§ 
=
§§ 
$str
§§ %
;
§§% &
int
•• 
aux2
•• 
;
•• 
int
¶¶ 
nroTemp
¶¶ 
=
¶¶ 
_dbEntities
¶¶ %
.
¶¶% &
boletas
¶¶& -
.
¶¶- .
Count
¶¶. 3
(
¶¶3 4
)
¶¶4 5
;
¶¶5 6
aux2
ßß 
=
ßß 
nroTemp
ßß 
;
ßß 
nroTemp
®® 
++
®® 
;
®® 
string
©© 
aux
©© 
=
©© 
nroTemp
©©  
.
©©  !
ToString
©©! )
(
©©) *
)
©©* +
;
©©+ ,
nroTemp
™™ 
=
™™ 
aux
™™ 
.
™™ 
Length
™™  
;
™™  !
nroTemp
´´ 
=
´´ 
$num
´´ 
-
´´ 
nroTemp
´´ !
;
´´! "
for
¨¨ 
(
¨¨ 
int
¨¨ 
i
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
i
¨¨ 
<
¨¨ 
nroTemp
¨¨  '
;
¨¨' (
i
¨¨) *
++
¨¨* ,
)
¨¨, -
{
≠≠ 
	nroBoleta
ÆÆ 
+=
ÆÆ 
$str
ÆÆ  
;
ÆÆ  !
}
ØØ 
	nroBoleta
∞∞ 
+=
∞∞ 
aux
∞∞ 
;
∞∞ 
DateTime
≤≤ 
fecha
≤≤ 
=
≤≤ 
new
≤≤  
DateTime
≤≤! )
(
≤≤) *
DateTime
≤≤* 2
.
≤≤2 3
Now
≤≤3 6
.
≤≤6 7
Year
≤≤7 ;
,
≤≤; <
DateTime
≥≥( 0
.
≥≥0 1
Now
≥≥1 4
.
≥≥4 5
Month
≥≥5 :
,
≥≥: ;
DateTime
¥¥( 0
.
¥¥0 1
Now
¥¥1 4
.
¥¥4 5
Day
¥¥5 8
,
¥¥8 9
DateTime
µµ( 0
.
µµ0 1
Now
µµ1 4
.
µµ4 5
Hour
µµ5 9
,
µµ9 :
DateTime
∂∂( 0
.
∂∂0 1
Now
∂∂1 4
.
∂∂4 5
Minute
∂∂5 ;
,
∂∂; <
DateTime
∑∑( 0
.
∑∑0 1
Now
∑∑1 4
.
∑∑4 5
Second
∑∑5 ;
)
∑∑; <
;
∑∑< =
int
ππ 
Id
ππ 
=
ππ 
GetLoggedUser
ππ "
(
ππ" #
)
ππ# $
.
ππ$ %
Id
ππ% '
;
ππ' (
var
∫∫ 
montos
∫∫ 
=
∫∫ 
_dbEntities
∫∫ $
.
∫∫$ %
pedidos
∫∫% ,
.
∫∫, -
Where
∫∫- 2
(
∫∫2 3
o
∫∫3 4
=>
∫∫5 7
o
∫∫8 9
.
∫∫9 :
	IdUsuario
∫∫: C
==
∫∫D F
Id
∫∫G I
&&
∫∫J L
o
∫∫M N
.
∫∫N O
Estado
∫∫O U
==
∫∫V X
$num
∫∫Y Z
)
∫∫Z [
.
∫∫[ \
ToList
∫∫\ b
(
∫∫b c
)
∫∫c d
;
∫∫d e
decimal
ªª 
monto
ªª 
=
ªª 
$num
ªª 
;
ªª 
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ 
item
ΩΩ 
in
ΩΩ  
montos
ΩΩ! '
)
ΩΩ' (
{
ææ 
monto
øø 
+=
øø 
(
øø 
decimal
øø !
)
øø! "
item
øø" &
.
øø& '
Monto
øø' ,
;
øø, -
}
¿¿ 
Boleta
¬¬ 
boleta
¬¬ 
=
¬¬ 
new
¬¬ 
Boleta
¬¬  &
(
¬¬& '
)
¬¬' (
;
¬¬( )
boleta
√√ 
.
√√ 
Fecha
√√ 
=
√√ 
fecha
√√  
;
√√  !
boleta
ƒƒ 
.
ƒƒ 
	NroBoleta
ƒƒ 
=
ƒƒ 
	nroBoleta
ƒƒ (
;
ƒƒ( )
boleta
≈≈ 
.
≈≈ 

MontoTotal
≈≈ 
=
≈≈ 
monto
≈≈  %
;
≈≈% &
var
∆∆ 
	direccion
∆∆ 
=
∆∆ 
_dbEntities
∆∆ '
.
∆∆' (
direcciones
∆∆( 3
.
∆∆3 4
First
∆∆4 9
(
∆∆9 :
o
∆∆: ;
=>
∆∆< >
o
∆∆? @
.
∆∆@ A
Id
∆∆A C
==
∆∆D F
IdDireccion
∆∆G R
)
∆∆R S
;
∆∆S T
boleta
«« 
.
«« 
	Direccion
«« 
=
«« 
	direccion
«« (
.
««( )
	Direccion
««) 2
;
««2 3
boleta
»» 
.
»» 

Referencia
»» 
=
»» 
	direccion
»»  )
.
»») *

Referencia
»»* 4
;
»»4 5
_dbEntities
   
.
   
boletas
   
.
    
Add
    #
(
  # $
boleta
  $ *
)
  * +
;
  + ,
_dbEntities
ÀÀ 
.
ÀÀ 
SaveChanges
ÀÀ #
(
ÀÀ# $
)
ÀÀ$ %
;
ÀÀ% &
return
ÕÕ 
aux2
ÕÕ 
;
ÕÕ 
}
ŒŒ 	
}
œœ 
}–– ›G
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\ProductosController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
[		 
	Authorize		 
]		 
public

 

class

 
ProductosController

 $
:

% &

Controller

' 1
{ 
private 
readonly 

DbEntities #
_dbEntities$ /
;/ 0
public 
ProductosController "
(" #

DbEntities# -

dbEntities. 8
)8 9
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
var 
ListaProductos 
=  
_dbEntities! ,
., -
	Productos- 6
.6 7
ToList7 =
(= >
)> ?
;? @
ViewBag 
. 
Tama√±os 
= 
_dbEntities )
.) *
tama√±oPrecios* 7
.7 8
ToList8 >
(> ?
)? @
;@ A
return 
View 
( 
ListaProductos &
)& '
;' (
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
AgregarProducto ,
(, -
)- .
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public   
IActionResult   
AgregarProducto   ,
(  , -
	Productos  - 6
	productos  7 @
)  @ A
{!! 	
_dbEntities"" 
."" 
	Productos"" !
.""! "
Add""" %
(""% &
	productos""& /
)""/ 0
;""0 1
_dbEntities## 
.## 
SaveChanges## #
(### $
)##$ %
;##% &
return$$ 
RedirectToAction$$ #
($$# $
$str$$$ +
)$$+ ,
;$$, -
}%% 	
['' 	
HttpGet''	 
]'' 
public(( 
IActionResult(( 
EditarProducto(( +
(((+ ,
int((, /
Id((0 2
)((2 3
{)) 	
var** 
Producto** 
=** 
_dbEntities** &
.**& '
	Productos**' 0
.**0 1
First**1 6
(**6 7
o**7 8
=>**9 ;
o**< =
.**= >
Id**> @
==**A C
Id**D F
)**F G
;**G H
return++ 
View++ 
(++ 
Producto++  
)++  !
;++! "
},, 	
[-- 	
HttpPost--	 
]-- 
public.. 
IActionResult.. 
EditarProducto.. +
(..+ ,
int.., /
Id..0 2
,..2 3
	Productos..4 =
	productos..> G
)..G H
{// 	
var00 
producto00 
=00 
_dbEntities00 &
.00& '
	Productos00' 0
.000 1
First001 6
(006 7
o007 8
=>009 ;
o00< =
.00= >
Id00> @
==00A C
Id00D F
)00F G
;00G H
producto11 
.11 
Nombre11 
=11 
	productos11 '
.11' (
Nombre11( .
;11. /
producto22 
.22 
Descripcion22  
=22! "
	productos22# ,
.22, -
Descripcion22- 8
;228 9
producto33 
.33 
	UrlImagen33 
=33  
	productos33! *
.33* +
	UrlImagen33+ 4
;334 5
_dbEntities44 
.44 
SaveChanges44 #
(44# $
)44$ %
;44% &
return55 
RedirectToAction55 #
(55# $
$str55$ +
)55+ ,
;55, -
}66 	
[88 	
HttpGet88	 
]88 
public99 
IActionResult99  
AgregarTama√±oPrecio99 0
(990 1
int991 4
Id995 7
)997 8
{:: 	
var;; 
Producto;; 
=;; 
_dbEntities;; &
.;;& '
	Productos;;' 0
.;;0 1
First;;1 6
(;;6 7
o;;7 8
=>;;9 ;
o;;< =
.;;= >
Id;;> @
==;;A C
Id;;D F
);;F G
;;;G H
return<< 
View<< 
(<< 
Producto<<  
)<<  !
;<<! "
}== 	
[>> 	
HttpPost>>	 
]>> 
public?? 
IActionResult??  
AgregarTama√±oPrecio?? 0
(??0 1
int??1 4
Id??5 7
,??7 8
Tama√±oPrecio??9 E
tama√±oPrecio??F R
)??R S
{@@ 	
Tama√±oPrecioAA 
tama√±oPrecio1AA &
=AA' (
newAA) ,
Tama√±oPrecioAA- 9
(AA9 :
)AA: ;
;AA; <
tama√±oPrecio1BB 
.BB 

IdProductoBB $
=BB% &
IdBB' )
;BB) *
tama√±oPrecio1CC 
.CC 
Tama√±oProductoCC (
=CC) *
tama√±oPrecioCC+ 7
.CC7 8
Tama√±oProductoCC8 F
;CCF G
tama√±oPrecio1DD 
.DD 
PrecioDD  
=DD! "
tama√±oPrecioDD# /
.DD/ 0
PrecioDD0 6
;DD6 7
_dbEntitiesEE 
.EE 
tama√±oPreciosEE %
.EE% &
AddEE& )
(EE) *
tama√±oPrecio1EE* 7
)EE7 8
;EE8 9
_dbEntitiesFF 
.FF 
SaveChangesFF #
(FF# $
)FF$ %
;FF% &
returnGG 
RedirectToActionGG #
(GG# $
$strGG$ +
)GG+ ,
;GG, -
}HH 	
[JJ 	
HttpGetJJ	 
]JJ 
publicKK 
IActionResultKK 
EditarTama√±oPrecioKK /
(KK/ 0
intKK0 3
IdKK4 6
)KK6 7
{LL 	
Tama√±oPrecioMM 
tama√±oPrecioMM %
=MM& '
_dbEntitiesMM( 3
.MM3 4
tama√±oPreciosMM4 A
.MMA B
FirstMMB G
(MMG H
oMMH I
=>MMJ L
oMMM N
.MMN O
IdMMO Q
==MMR T
IdMMU W
)MMW X
;MMX Y
ViewBagNN 
.NN 
ProductoNN 
=NN 
_dbEntitiesNN *
.NN* +
	ProductosNN+ 4
.NN4 5
FirstNN5 :
(NN: ;
oNN; <
=>NN= ?
oNN@ A
.NNA B
IdNNB D
==NNE G
tama√±oPrecioNNH T
.NNT U

IdProductoNNU _
)NN_ `
;NN` a
returnOO 
ViewOO 
(OO 
tama√±oPrecioOO $
)OO$ %
;OO% &
}PP 	
[QQ 	
HttpPostQQ	 
]QQ 
publicRR 
IActionResultRR 
EditarTama√±oPrecioRR /
(RR/ 0
intRR0 3
IdRR4 6
,RR6 7
Tama√±oPrecioRR8 D
tama√±oPrecioRRE Q
)RRQ R
{SS 	
Tama√±oPrecioTT 
tama√±oPrecio1TT &
=TT' (
_dbEntitiesTT) 4
.TT4 5
tama√±oPreciosTT5 B
.TTB C
FirstTTC H
(TTH I
oTTI J
=>TTK M
oTTN O
.TTO P
IdTTP R
==TTS U
IdTTV X
)TTX Y
;TTY Z
tama√±oPrecio1UU 
.UU 
Tama√±oProductoUU (
=UU) *
tama√±oPrecioUU+ 7
.UU7 8
Tama√±oProductoUU8 F
;UUF G
tama√±oPrecio1VV 
.VV 
PrecioVV  
=VV! "
tama√±oPrecioVV# /
.VV/ 0
PrecioVV0 6
;VV6 7
_dbEntitiesWW 
.WW 
SaveChangesWW #
(WW# $
)WW$ %
;WW% &
returnXX 
RedirectToActionXX #
(XX# $
$strXX$ +
)XX+ ,
;XX, -
}YY 	
publicZZ 
IActionResultZZ !
EliminarTama√±oPrecioZZ 1
(ZZ1 2
intZZ2 5
IdZZ6 8
)ZZ8 9
{[[ 	
var\\ 
	precioTam\\ 
=\\ 
_dbEntities\\ '
.\\' (
tama√±oPrecios\\( 5
.\\5 6
First\\6 ;
(\\; <
o\\< =
=>\\> @
o\\A B
.\\B C
Id\\C E
==\\F H
Id\\I K
)\\K L
;\\L M
_dbEntities]] 
.]] 
tama√±oPrecios]] %
.]]% &
Remove]]& ,
(]], -
	precioTam]]- 6
)]]6 7
;]]7 8
_dbEntities^^ 
.^^ 
SaveChanges^^ #
(^^# $
)^^$ %
;^^% &
return__ 
RedirectToAction__ #
(__# $
$str__$ +
)__+ ,
;__, -
}`` 	
}aa 
}bb ‡
PD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Controllers\TrackingController.cs
	namespace 	
Maxdel
 
. 
Controllers 
{ 
public 

class 
TrackingController #
:$ %

Controller& 0
{		 

DbEntities

 
_dbEntities

 
;

 
public 
TrackingController !
(! "

DbEntities" ,

dbEntities- 7
)7 8
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Estado #
(# $
string$ *
CodTracking+ 6
)6 7
{ 	
var 
detallePedido 
= 
_dbEntities  +
.+ ,
detallePedidos, :
.+ ,
Include, 3
(3 4
o4 5
=>6 8
o9 :
.: ;
Pedido; A
)A B
.+ ,
Include, 3
(3 4
o4 5
=>6 8
o9 :
.: ;
Producto; C
)C D
.+ ,
FirstOrDefault, :
(: ;
o; <
=>= ?
o@ A
.A B
PedidoB H
.H I
CodTrackingI T
==U W
CodTrackingX c
)c d
;d e
ViewBag 
. 
CodTracking 
=  !
CodTracking" -
;- .
if 
( 
detallePedido 
!= 
null  $
)$ %
{ 
switch 
( 
detallePedido %
.% &
Pedido& ,
., -
Estado- 3
)3 4
{ 
case   
$num   
:   
ViewBag   #
.  # $
Estado  $ *
=  + ,
$str  - n
;  n o
break  p u
;  u v
case!! 
$num!! 
:!! 
ViewBag!! #
.!!# $
Estado!!$ *
=!!+ ,
$str!!- q
;!!q r
break!!s x
;!!x y
case"" 
$num"" 
:"" 
ViewBag"" #
.""# $
Estado""$ *
=""+ ,
$str""- q
;""q r
break""s x
;""x y
case## 
$num## 
:## 
ViewBag## #
.### $
Estado##$ *
=##+ ,
$str##- S
;##S T
break##U Z
;##Z [
case$$ 
$num$$ 
:$$ 
ViewBag$$ #
.$$# $
Estado$$$ *
=$$+ ,
$str$$- I
;$$I J
break$$K P
;$$P Q
}%% 
}&& 
else'' 
{(( 
ViewBag)) 
.)) 
Estado)) 
=))  
$str))! ?
;))? @
}** 
return++ 
View++ 
(++ 
)++ 
;++ 
},, 	
}-- 
}.. Ù*
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\DbEntities.cs
	namespace 	
Maxdel
 
. 
DB 
{ 
public 

class 

DbEntities 
: 
	DbContext '
{		 
public

 
DbSet

 
<

 
	Productos

 
>

 
	Productos

  )
{

* +
get

, /
;

/ 0
set

1 4
;

4 5
}

6 7
public 
DbSet 
< 
DetallePedido "
>" #
detallePedidos$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
public 
DbSet 
< 
Pedido 
> 
pedidos $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Usuario 
> 
usuarios &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Tama√±oPrecio !
>! "
tama√±oPrecios# 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 
DbSet 
< 
Tipo 
> 
tipos  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Direcciones  
>  !
direcciones" -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
DbSet 
< 
Estado 
> 
estado #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
DbSet 
< 
NroTracking  
>  !
nroTrackings" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Boleta 
> 
boletas $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
PreguntaSeguridad &
>& '
preguntaSeguridads( :
{; <
get= @
;@ A
setB E
;E F
}G H
public 

DbEntities 
( 
) 
{ 
} 
public 

DbEntities 
( 
DbContextOptions *
<* +

DbEntities+ 5
>5 6
options7 >
)> ?
:? @
baseA E
(E F
optionsF M
)M N
{O P
}Q R
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
ProductosMapping0 @
(@ A
)A B
)B C
;C D
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, / 
DetallePedidoMapping0 D
(D E
)E F
)F G
;G H
modelBuilder 
. 
ApplyConfiguration +
(+ ,
new, /
PedidoMapping0 =
(= >
)> ?
)? @
;@ A
modelBuilder   
.   
ApplyConfiguration   +
(  + ,
new  , /
UsuarioMapping  0 >
(  > ?
)  ? @
)  @ A
;  A B
modelBuilder!! 
.!! 
ApplyConfiguration!! +
(!!+ ,
new!!, /
EstadoMapping!!0 =
(!!= >
)!!> ?
)!!? @
;!!@ A
modelBuilder"" 
."" 
ApplyConfiguration"" +
(""+ ,
new"", / 
Tama√±oPrecioMapping""0 C
(""C D
)""D E
)""E F
;""F G
modelBuilder## 
.## 
ApplyConfiguration## +
(##+ ,
new##, /
TipoMapping##0 ;
(##; <
)##< =
)##= >
;##> ?
modelBuilder$$ 
.$$ 
ApplyConfiguration$$ +
($$+ ,
new$$, /
DireccionesMapping$$0 B
($$B C
)$$C D
)$$D E
;$$E F
modelBuilder%% 
.%% 
ApplyConfiguration%% +
(%%+ ,
new%%, /
NroTrackingMapping%%0 B
(%%B C
)%%C D
)%%D E
;%%E F
modelBuilder&& 
.&& 
ApplyConfiguration&& +
(&&+ ,
new&&, /
BoletaMapping&&0 =
(&&= >
)&&> ?
)&&? @
;&&@ A
modelBuilder'' 
.'' 
ApplyConfiguration'' +
(''+ ,
new'', /$
PreguntaSeguridadMapping''0 H
(''H I
)''I J
)''J K
;''K L
}(( 	
})) 
}** √
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\BoletaMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
BoletaMapping 
:  $
IEntityTypeConfiguration! 9
<9 :
Boleta: @
>@ A
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Boleta		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ≠
QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\DetallePedidoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class  
DetallePedidoMapping %
:% &$
IEntityTypeConfiguration' ?
<? @
DetallePedido@ M
>M N
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
DetallePedido		0 =
>		= >
builder		? F
)		F G
{

 	
builder 
. 
ToTable 
( 
$str +
,+ ,
$str- 2
)2 3
;3 4
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Producto" *
)* +
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &

IdProducto& 0
)0 1
;1 2
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Pedido" (
)( )
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdPedido& .
). /
;/ 0
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
tama√±oPrecio" .
). /
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdTama√±oPrecio& 4
)4 5
;5 6
} 	
} 
} Ì

OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\DireccionesMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
DireccionesMapping #
:$ %$
IEntityTypeConfiguration& >
<> ?
Direcciones? J
>J K
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Direcciones		0 ;
>		; <
builder		= D
)		D E
{

 	
builder 
. 
ToTable 
( 
$str )
,) *
$str+ 0
)0 1
;1 2
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
} 	
} 
} √
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\EstadoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
EstadoMapping 
: $
IEntityTypeConfiguration  8
<8 9
Estado9 ?
>? @
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Estado		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ◊
OD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\NroTrackingMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
NroTrackingMapping #
:$ %$
IEntityTypeConfiguration& >
<> ?
NroTracking? J
>J K
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
NroTracking		0 ;
>		; <
builder		= D
)		D E
{

 	
builder 
. 
ToTable 
( 
$str )
,) *
$str+ 0
)0 1
;1 2
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} Å
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\PedidoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
PedidoMapping 
: $
IEntityTypeConfiguration  8
<8 9
Pedido9 ?
>? @
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Pedido		0 6
>		6 7
builder		8 ?
)		? @
{

 	
builder 
. 
ToTable 
( 
$str $
,$ %
$str& +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Usuario" )
)) *
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
	IdUsuario& /
)/ 0
;0 1
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
EstadoFK" *
)* +
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
Estado& ,
), -
;- .
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
boleta" (
)( )
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdBoleta& .
). /
;/ 0
} 	
} 
} Ô
UD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\PreguntaSeguridadMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class $
PreguntaSeguridadMapping )
:* +$
IEntityTypeConfiguration, D
<D E
PreguntaSeguridadE V
>V W
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
PreguntaSeguridad		0 A
>		A B
builder		C J
)		J K
{

 	
builder 
. 
ToTable 
( 
$str /
,/ 0
$str1 6
)6 7
;7 8
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} œ
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\ProductosMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
ProductosMapping !
:! "$
IEntityTypeConfiguration# ;
<; <
	Productos< E
>E F
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
	Productos		0 9
>		9 :
builder		; B
)		B C
{

 	
builder 
. 
ToTable 
( 
$str '
,' (
$str) .
). /
;/ 0
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ¯

QD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\Tama√±oPrecioMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class  
Tama√±oPrecioMapping $
:% &$
IEntityTypeConfiguration' ?
<? @
Tama√±oPrecio@ L
>L M
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Tama√±oPrecio		0 <
>		< =
builder		> E
)		E F
{

 	
builder 
. 
ToTable 
( 
$str *
,* +
$str, 1
)1 2
;2 3
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
	Productos" +
)+ ,
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &

IdProducto& 0
)0 1
;1 2
} 	
} 
} ª
HD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\TipoMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
TipoMapping 
: $
IEntityTypeConfiguration 7
<7 8
Tipo8 <
>< =
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Tipo		0 4
>		4 5
builder		6 =
)		= >
{

 	
builder 
. 
ToTable 
( 
$str "
," #
$str$ )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} Å
KD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\DB\Mapping\UsuarioMapping.cs
	namespace 	
Maxdel
 
. 
DB 
. 
Mapping 
{ 
public 

class 
UsuarioMapping 
:  $
IEntityTypeConfiguration! 9
<9 :
Usuario: A
>A B
{ 
public		 
void		 
	Configure		 
(		 
EntityTypeBuilder		 /
<		/ 0
Usuario		0 7
>		7 8
builder		9 @
)		@ A
{

 	
builder 
. 
ToTable 
( 
$str %
,% &
$str' ,
), -
;- .
builder 
. 
HasKey 
( 
x 
=> 
x  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Tipo" &
)& '
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdTipo& ,
), -
;- .
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
PreguntaSeguridad" 3
)3 4
. 
WithMany 
( 
) 
. 
HasForeignKey 
( 
o  
=>! #
o$ %
.% &
IdPreguntaSeguridad& 9
)9 :
;: ;
} 	
} 
} •	
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Boleta.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Boleta 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
	NroBoleta 
{  !
get" %
;% &
set' *
;* +
}, -
public 
decimal 

MontoTotal !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
Fecha 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
	Direccion		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
string

 

Referencia

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
} 
} ≠
FD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\DetallePedido.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
DetallePedido 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
	Productos 
Producto !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
IdPedido 
{ 
get !
;! "
set# &
;& '
}( )
public		 
Pedido		 
Pedido		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
int

 
IdTama√±oPrecio

 !
{

" #
get

$ '
;

' (
set

) ,
;

, -
}

. /
public 
Tama√±oPrecio 
tama√±oPrecio (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
precio 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} é
DD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Direcciones.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Direcciones 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Usuario 
Usuario 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 

Referencia		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
}

 
} û
GD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\ErrorViewModel.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ≠
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Estado.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Estado 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ¥
DD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\NroTracking.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
NroTracking 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
Numero 
{ 
get 
;  
set! $
;$ %
}& '
} 
} Œ
?D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Pedido.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Pedido 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
Usuario		 
Usuario		 
{		  
get		! $
;		$ %
set		& )
;		) *
}		+ ,
public

 
int

 
Estado

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
public 
Estado 
EstadoFK 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
decimal 
? 
Monto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
CodTracking "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
? 
IdBoleta 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Boleta 
? 
boleta 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Destino 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ≈
JD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\PreguntaSeguridad.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
PreguntaSeguridad "
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Pregunta 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} Ô
BD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Productos.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
	Productos 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Descripcion !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
	UrlImagen 
{  !
get" %
;% &
set' *
;* +
}, -
}		 
}

 ö
FD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Tama√±oPrecio.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Tama√±oPrecio 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
	Productos 
	Productos "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public		 
decimal		 
Precio		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
}

 
} ©
=D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Tipo.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Tipo 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ¬
@D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Models\Usuario.cs
	namespace 	
Maxdel
 
. 
Models 
{ 
public 

class 
Usuario 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
IdTipo 
{ 
get 
;  
set! $
;$ %
}& '
public		 
Tipo		 
Tipo		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
string

 
Nombre

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 

NroCelular !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Correo 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Contrase√±a !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
DNI 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 
? 
IdPreguntaSeguridad '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
PreguntaSeguridad  
?  !
PreguntaSeguridad" 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
public 
string 
? 
RespuestaPS "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ◊
9D:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 #
AddControllersWithViews		 (
(		( )
)		) *
;		* +
builder 
. 
Services 
. 
AddAuthentication "
(" #(
CookieAuthenticationDefaults# ?
.? @ 
AuthenticationScheme@ T
)T U
. 
	AddCookie 
( 
options 
=> 
{ 
options 
. 
	LoginPath 
= 
$str )
;) *
} 
) 
; 
builder 
. 
Services 
. 
AddDbContext 
< 

DbEntities (
>( )
() *
options 
=> 
options 
. 
UseSqlServer #
(# $
builder$ +
.+ ,
Configuration, 9
.9 :
GetConnectionString: M
(M N
$strN X
)X Y
)Y Z
) 
; 
builder 
. 
Services 
. 
AddTransient 
< 
IHomeRepositorio .
,. /
HomeRepositorio0 ?
>? @
(@ A
)A B
;B C
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app!! 
.!! 
UseHttpsRedirection!! 
(!! 
)!! 
;!! 
app"" 
."" 
UseStaticFiles"" 
("" 
)"" 
;"" 
app$$ 
.$$ 

UseRouting$$ 
($$ 
)$$ 
;$$ 
app&& 
.&& 
UseAuthentication&& 
(&& 
)&& 
;&& 
app'' 
.'' 
UseAuthorization'' 
('' 
)'' 
;'' 
app)) 
.)) 
MapControllerRoute)) 
()) 
name** 
:** 	
$str**
 
,** 
pattern++ 
:++ 
$str++ 5
)++5 6
;++6 7
app-- 
.-- 
Run-- 
(-- 
)-- 	
;--	 
‚
MD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\Repositorio\HomeRepositorio.cs
	namespace 	
Maxdel
 
. 
Repositorio 
{ 
public 

	interface 
IHomeRepositorio %
{ 
List		 
<		 
DetallePedido		 
>		 
ObtenerDetalleCesta		 /
(		/ 0
int		0 3
id		4 6
)		6 7
;		7 8
List

 
<

 
	Productos

 
>

 
ObtenerProductos

 (
(

( )
)

) *
;

* +
} 
public 

class 
HomeRepositorio  
:! "
IHomeRepositorio# 3
{ 
private 

DbEntities 
_dbEntities &
;& '
public 
HomeRepositorio 
( 

DbEntities )

dbEntities* 4
)4 5
{ 	
_dbEntities 
= 

dbEntities $
;$ %
} 	
public 
List 
< 
DetallePedido !
>! "
ObtenerDetalleCesta# 6
(6 7
int7 :
id; =
)= >
{ 	
return 
_dbEntities 
. 
detallePedidos -
. 
Include 
( 
o 
=> !
o" #
.# $
Producto$ ,
), -
. 
Where 
( 
o 
=> 
o  !
.! "
IdPedido" *
==+ -
id. 0
)0 1
.1 2
ToList2 8
(8 9
)9 :
;: ;
} 	
public 
List 
< 
	Productos 
> 
ObtenerProductos /
(/ 0
)0 1
{ 	
return 
_dbEntities 
. 
	Productos (
.( )
ToList) /
(/ 0
)0 1
;1 2
} 	
}   
}!! ⁄
SD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\ComprarClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class "
ComprarClaseIntermedia '
{ 
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Estado 
{ 
get 
;  
set! $
;$ %
}& '
public 
decimal 
Monto 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
CodTracking !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
string		 
	NroBoleta		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
int

 

IdProducto

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
int 
IdPedido 
{ 
get !
;! "
set# &
;& '
}( )
public 
int 
IdTama√±oPrecio !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Tama√±oProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
decimal 
Precio 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ∂
TD:\ALGORITMOS\source\repos\Web Pizzeria\Maxdel\ViewModels\RegistroClaseIntermedia.cs
	namespace 	
Maxdel
 
. 

ViewModels 
{ 
public 

class #
RegistroClaseIntermedia (
{ 
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
	Apellidos 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 

NroCelular  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
correo 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
contrase√±a		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
string

 
	Direccion

 
{

  !
get

" %
;

% &
set

' *
;

* +
}

, -
public 
string 

Referencia  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
IdPreguntaSeguridad &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
RespuestaPS !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} 